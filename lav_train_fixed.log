[2026-02-01 13:21:02,396 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-02-01 13:21:02,396 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,576 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-02-01 13:21:02,576 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,677 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-02-01 13:21:02,678 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,701 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-02-01 13:21:02,701 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,720 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-02-01 13:21:02,721 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,739 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-02-01 13:21:02,740 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,753 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-02-01 13:21:02,753 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,790 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-02-01 13:21:02,790 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,802 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-02-01 13:21:02,802 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,838 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-02-01 13:21:02,838 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,852 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-02-01 13:21:02,852 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,866 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-02-01 13:21:02,866 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,882 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-02-01 13:21:02,883 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,923 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-02-01 13:21:02,923 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,932 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-02-01 13:21:02,932 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:02,965 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-02-01 13:21:02,965 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 13:21:04,313 - INFO - alignment_training_loop.py:210] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-02-01 13:21:06,183 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Salad.cmu
[2026-02-01 13:21:06,351 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [346, 306]
[2026-02-01 13:21:13,350 - INFO - alignment_training_loop.py:353] - [BATCH 0] Loss value: 1308.5544
[2026-02-01 13:21:18,820 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 13:21:19,585 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [2489, 906]
[2026-02-01 13:21:35,493 - INFO - alignment_training_loop.py:353] - [BATCH 1] Loss value: 46274.4961
[2026-02-01 13:21:58,751 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Sandwich.cmu
[2026-02-01 13:21:58,832 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [93, 141]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 2.20GB | Reserved: 2.48GB | Peak: 2.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([306, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.20GB, Reserved: 2.48GB

[LAV DEBUG] Processing pair (0,1): N=346, M=306
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.770332
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39898.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=306) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31206.697266
[LAV DEBUG]   Pair loss = -56.7703 + 0.01 * (39898.0625 + 31206.6973) = 654.2772
[LAV DEBUG]   Pair (0,1) completed in 2.95s
[LAV DEBUG]   GPU Memory after pair: 2.25GB

[LAV DEBUG] Processing pair (1,0): N=306, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.770332
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=306) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31206.697266
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39898.062500
[LAV DEBUG]   Pair loss = -56.7703 + 0.01 * (31206.6973 + 39898.0625) = 654.2772
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.30GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1308.5544
[LAV DEBUG] Total time: 3.20s
[LAV DEBUG] Avg time per pair: 1.60s
============================================================

[MEM After loss computation] Allocated: 2.30GB | Reserved: 2.48GB | Peak: 2.35GB
[MEM Before backward] Allocated: 2.30GB | Reserved: 2.48GB | Peak: 2.35GB
[MEM After backward] Allocated: 0.38GB | Reserved: 2.95GB | Peak: 2.46GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.95GB | Peak: 2.46GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 2.46GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 2.46GB
[MEM After forward pass] Allocated: 11.03GB | Reserved: 11.84GB | Peak: 11.09GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2489, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([906, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.03GB, Reserved: 11.84GB

[LAV DEBUG] Processing pair (0,1): N=2489, M=906
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -245.305954
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2064688.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=906) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 273566.937500
[LAV DEBUG]   Pair loss = -245.3060 + 0.01 * (2064688.6250 + 273566.9375) = 23137.2480
[LAV DEBUG]   Pair (0,1) completed in 0.21s
[LAV DEBUG]   GPU Memory after pair: 12.13GB

[LAV DEBUG] Processing pair (1,0): N=906, M=2489
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -245.305954
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=906) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 273566.937500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2064688.625000
[LAV DEBUG]   Pair loss = -245.3060 + 0.01 * (273566.9375 + 2064688.6250) = 23137.2480
[LAV DEBUG]   Pair (1,0) completed in 0.19s
[LAV DEBUG]   GPU Memory after pair: 13.22GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 46274.4961
[LAV DEBUG] Total time: 0.71s
[LAV DEBUG] Avg time per pair: 0.36s
============================================================

[MEM After loss computation] Allocated: 13.22GB | Reserved: 15.05GB | Peak: 14.29GB
[MEM Before backward] Allocated: 13.22GB | Reserved: 15.05GB | Peak: 14.29GB
[MEM After backward] Allocated: 0.74GB | Reserved: 18.28GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 18.28GB | Peak: 16.44GB
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 1.29GB | Reserved: 1.46GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([141, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.29GB, Reserved: 1.46GB

[LAV DEBUG] Processing pair (0,1): N=93, M=141
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -19.451532
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.258789
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=141) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6627.736816
[LAV DEBUG]   Pair loss = -19.4515 + 0.01 * (2884.2588 + 6627.7368) = 75.6684
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.29GB

[LAV DEBUG] Processing pair (1,0): N=141, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -19.451532
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=141) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6627.736816
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.258789
[LAV DEBUG]   Pair loss = -19.4515 + 0.01 * (6627.7368 + 2884.2588) = 75.6684
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.30GB

[LAV DEBUG] === LAV_loss complete ===
[2026-02-01 13:22:00,296 - INFO - alignment_training_loop.py:353] - [BATCH 2] Loss value: 151.3369
[2026-02-01 13:22:01,905 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Sandwich.cmu
[2026-02-01 13:22:02,015 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [214, 213]
[2026-02-01 13:22:04,285 - INFO - alignment_training_loop.py:353] - [BATCH 3] Loss value: 533.4882
[2026-02-01 13:22:07,163 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Sandwich.cmu
[2026-02-01 13:22:07,273 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [256, 179]
[2026-02-01 13:22:09,518 - INFO - alignment_training_loop.py:353] - [BATCH 4] Loss value: 576.7648
[2026-02-01 13:22:12,443 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Pizza.cmu
[2026-02-01 13:22:12,649 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [126, 780]
[2026-02-01 13:22:17,230 - INFO - alignment_training_loop.py:353] - [BATCH 5] Loss value: 4073.9622
[2026-02-01 13:22:23,317 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: PastaSalad.egtea
[2026-02-01 13:22:24,036 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [2192, 989]
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 151.3369
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 1.30GB | Reserved: 1.36GB | Peak: 16.44GB
[MEM Before backward] Allocated: 1.30GB | Reserved: 1.36GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.70GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.70GB | Peak: 16.44GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 1.88GB | Reserved: 2.15GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([213, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.88GB, Reserved: 2.15GB

[LAV DEBUG] Processing pair (0,1): N=214, M=213
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.134460
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15265.091797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=213) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15122.764648
[LAV DEBUG]   Pair loss = -37.1345 + 0.01 * (15265.0918 + 15122.7646) = 266.7441
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.90GB

[LAV DEBUG] Processing pair (1,0): N=213, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.134460
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=213) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15122.764648
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15265.091797
[LAV DEBUG]   Pair loss = -37.1345 + 0.01 * (15122.7646 + 15265.0918) = 266.7441
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.92GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 533.4882
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 16.44GB
[MEM Before backward] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.36GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.36GB | Peak: 16.44GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 1.90GB | Reserved: 2.18GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.90GB, Reserved: 2.18GB

[LAV DEBUG] Processing pair (0,1): N=256, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.869431
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21844.449219
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10680.731445
[LAV DEBUG]   Pair loss = -36.8694 + 0.01 * (21844.4492 + 10680.7314) = 288.3824
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.93GB

[LAV DEBUG] Processing pair (1,0): N=179, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.869431
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10680.731445
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21844.449219
[LAV DEBUG]   Pair loss = -36.8694 + 0.01 * (10680.7314 + 21844.4492) = 288.3824
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 576.7648
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 1.95GB | Reserved: 2.07GB | Peak: 16.44GB
[MEM Before backward] Allocated: 1.95GB | Reserved: 2.07GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.39GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.39GB | Peak: 16.44GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.35GB | Reserved: 3.68GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([126, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([780, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.35GB, Reserved: 3.68GB

[LAV DEBUG] Processing pair (0,1): N=126, M=780
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -43.736507
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=126) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5293.051270
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=780) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 202778.718750
[LAV DEBUG]   Pair loss = -43.7365 + 0.01 * (5293.0513 + 202778.7188) = 2036.9811
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.40GB

[LAV DEBUG] Processing pair (1,0): N=780, M=126
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -43.736507
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=780) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 202778.718750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=126) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5293.051270
[LAV DEBUG]   Pair loss = -43.7365 + 0.01 * (202778.7188 + 5293.0513) = 2036.9811
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.45GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4073.9622
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 3.45GB | Reserved: 3.66GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.45GB | Reserved: 3.66GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.13GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.13GB | Peak: 16.44GB
[MEM Batch 6 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 10.37GB | Reserved: 11.15GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2192, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([989, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.37GB, Reserved: 11.15GB
[2026-02-01 13:22:39,036 - INFO - alignment_training_loop.py:353] - [BATCH 6] Loss value: 38054.7930
[2026-02-01 13:23:00,888 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Brownie.cmu
[2026-02-01 13:23:01,086 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [418, 397]
[2026-02-01 13:23:05,175 - INFO - alignment_training_loop.py:353] - [BATCH 7] Loss value: 2072.8716
[2026-02-01 13:23:10,669 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-02-01 13:23:11,379 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [839, 2332]
[2026-02-01 13:23:26,615 - INFO - alignment_training_loop.py:353] - [BATCH 8] Loss value: 40487.5273
[2026-02-01 13:23:48,249 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Salad.cmu
[2026-02-01 13:23:48,450 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [430, 396]

[LAV DEBUG] Processing pair (0,1): N=2192, M=989
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -247.156372
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2192) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1601448.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=989) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 326006.968750
[LAV DEBUG]   Pair loss = -247.1564 + 0.01 * (1601448.2500 + 326006.9688) = 19027.3965
[LAV DEBUG]   Pair (0,1) completed in 0.21s
[LAV DEBUG]   GPU Memory after pair: 11.42GB

[LAV DEBUG] Processing pair (1,0): N=989, M=2192
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -247.156372
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=989) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 326006.968750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2192) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1601448.250000
[LAV DEBUG]   Pair loss = -247.1564 + 0.01 * (326006.9688 + 1601448.2500) = 19027.3965
[LAV DEBUG]   Pair (1,0) completed in 0.19s
[LAV DEBUG]   GPU Memory after pair: 12.47GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 38054.7930
[LAV DEBUG] Total time: 0.67s
[LAV DEBUG] Avg time per pair: 0.33s
============================================================

[MEM After loss computation] Allocated: 12.47GB | Reserved: 13.22GB | Peak: 16.44GB
[MEM Before backward] Allocated: 12.47GB | Reserved: 13.22GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 16.35GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 16.35GB | Peak: 16.44GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.08GB | Reserved: 3.36GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([418, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([397, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.08GB, Reserved: 3.36GB

[LAV DEBUG] Processing pair (0,1): N=418, M=397
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.261192
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=418) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 58237.082031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=397) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52532.625000
[LAV DEBUG]   Pair loss = -71.2612 + 0.01 * (58237.0820 + 52532.6250) = 1036.4358
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.16GB

[LAV DEBUG] Processing pair (1,0): N=397, M=418
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.261192
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=397) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52532.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=418) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 58237.082031
[LAV DEBUG]   Pair loss = -71.2612 + 0.01 * (52532.6250 + 58237.0820) = 1036.4358
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.24GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2072.8716
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.24GB | Reserved: 3.44GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.24GB | Reserved: 3.44GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.79GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.79GB | Peak: 16.44GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 10.34GB | Reserved: 11.11GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2332, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.34GB, Reserved: 11.11GB

[LAV DEBUG] Processing pair (0,1): N=839, M=2332
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -228.081223
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234619.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2332) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1812565.375000
[LAV DEBUG]   Pair loss = -228.0812 + 0.01 * (234619.2031 + 1812565.3750) = 20243.7637
[LAV DEBUG]   Pair (0,1) completed in 0.18s
[LAV DEBUG]   GPU Memory after pair: 11.29GB

[LAV DEBUG] Processing pair (1,0): N=2332, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -228.081223
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2332) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1812565.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234619.203125
[LAV DEBUG]   Pair loss = -228.0812 + 0.01 * (1812565.3750 + 234619.2031) = 20243.7637
[LAV DEBUG]   Pair (1,0) completed in 0.18s
[LAV DEBUG]   GPU Memory after pair: 12.24GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 40487.5273
[LAV DEBUG] Total time: 0.63s
[LAV DEBUG] Avg time per pair: 0.32s
============================================================

[MEM After loss computation] Allocated: 12.24GB | Reserved: 13.00GB | Peak: 16.44GB
[MEM Before backward] Allocated: 12.24GB | Reserved: 13.00GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 15.82GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 15.82GB | Peak: 16.44GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.11GB | Reserved: 3.39GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([430, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([396, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.11GB, Reserved: 3.39GB

[LAV DEBUG] Processing pair (0,1): N=430, M=396
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.169220
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=430) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61629.343750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=396) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52268.820312
[LAV DEBUG]   Pair loss = -72.1692 + 0.01 * (61629.3438 + 52268.8203) = 1066.8124
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.19GB

[LAV DEBUG] Processing pair (1,0): N=396, M=430
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.169220
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=396) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52268.820312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=430) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61629.343750
[LAV DEBUG]   Pair loss = -72.1692 + 0.01 * (52268.8203 + 61629.3438) = 1066.8124
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.27GB
[2026-02-01 13:23:52,665 - INFO - alignment_training_loop.py:353] - [BATCH 9] Loss value: 2133.6248
[2026-02-01 13:23:58,234 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Cheeseburger.egtea
[2026-02-01 13:23:58,610 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [447, 1138]
[2026-02-01 13:24:06,418 - INFO - alignment_training_loop.py:353] - [BATCH 10] Loss value: 9730.0195
[2026-02-01 13:24:17,214 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: Pizza.cmu
[2026-02-01 13:24:17,441 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [421, 585]
[2026-02-01 13:24:22,510 - INFO - alignment_training_loop.py:353] - [BATCH 11] Loss value: 3290.4336
[2026-02-01 13:24:29,355 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Salad.cmu
[2026-02-01 13:24:29,496 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [223, 329]
[2026-02-01 13:24:32,394 - INFO - alignment_training_loop.py:353] - [BATCH 12] Loss value: 959.7343
[2026-02-01 13:24:36,196 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Pizza.cmu
[2026-02-01 13:24:36,520 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [575, 839]

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2133.6248
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 3.27GB | Reserved: 3.47GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.27GB | Reserved: 3.47GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.83GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.83GB | Peak: 16.44GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 5.45GB | Reserved: 5.91GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([447, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1138, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.45GB, Reserved: 5.91GB

[LAV DEBUG] Processing pair (0,1): N=447, M=1138
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -117.426010
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=447) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 66598.734375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1138) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 431644.812500
[LAV DEBUG]   Pair loss = -117.4260 + 0.01 * (66598.7344 + 431644.8125) = 4865.0098
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.70GB

[LAV DEBUG] Processing pair (1,0): N=1138, M=447
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -117.426010
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1138) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 431644.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=447) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 66598.734375
[LAV DEBUG]   Pair loss = -117.4260 + 0.01 * (431644.8125 + 66598.7344) = 4865.0098
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 9730.0195
[LAV DEBUG] Total time: 0.38s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 5.94GB | Reserved: 6.40GB | Peak: 16.44GB
[MEM Before backward] Allocated: 5.94GB | Reserved: 6.40GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.13GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 7.13GB | Peak: 16.44GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.67GB | Reserved: 4.05GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([421, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([585, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.67GB, Reserved: 4.05GB

[LAV DEBUG] Processing pair (0,1): N=421, M=585
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -86.225899
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=421) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59077.070312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=585) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 114067.203125
[LAV DEBUG]   Pair loss = -86.2259 + 0.01 * (59077.0703 + 114067.2031) = 1645.2168
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.79GB

[LAV DEBUG] Processing pair (1,0): N=585, M=421
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -86.225899
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=585) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 114067.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=421) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59077.070312
[LAV DEBUG]   Pair loss = -86.2259 + 0.01 * (114067.2031 + 59077.0703) = 1645.2168
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.90GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3290.4336
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.90GB | Reserved: 4.18GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.90GB | Reserved: 4.18GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.54GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.54GB | Peak: 16.44GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 2.27GB | Reserved: 2.58GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.27GB, Reserved: 2.58GB

[LAV DEBUG] Processing pair (0,1): N=223, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.691513
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16576.671875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36079.195312
[LAV DEBUG]   Pair loss = -46.6915 + 0.01 * (16576.6719 + 36079.1953) = 479.8671
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.30GB

[LAV DEBUG] Processing pair (1,0): N=329, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.691513
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36079.195312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16576.671875
[LAV DEBUG]   Pair loss = -46.6915 + 0.01 * (36079.1953 + 16576.6719) = 479.8671
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.34GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 959.7343
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.34GB | Reserved: 2.47GB | Peak: 16.44GB
[MEM Before backward] Allocated: 2.34GB | Reserved: 2.47GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.85GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.85GB | Peak: 16.44GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 4.93GB | Reserved: 5.37GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([575, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[2026-02-01 13:24:43,670 - INFO - alignment_training_loop.py:353] - [BATCH 13] Loss value: 6655.4087
[2026-02-01 13:24:53,651 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: pc_assembly
[2026-02-01 13:24:53,907 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [555, 555]
[2026-02-01 13:24:59,718 - INFO - alignment_training_loop.py:353] - [BATCH 14] Loss value: 3912.2205
[2026-02-01 13:25:07,597 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Pizza.cmu
[2026-02-01 13:25:07,804 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [596, 298]
[2026-02-01 13:25:12,570 - INFO - alignment_training_loop.py:353] - [BATCH 15] Loss value: 2817.7139
[2026-02-01 13:25:18,972 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Eggs.cmu
[2026-02-01 13:25:19,114 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [378, 196]
[LAV DEBUG] Initial GPU Memory - Allocated: 4.93GB, Reserved: 5.37GB

[LAV DEBUG] Processing pair (0,1): N=575, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -120.567162
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=575) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 110201.914062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234625.250000
[LAV DEBUG]   Pair loss = -120.5672 + 0.01 * (110201.9141 + 234625.2500) = 3327.7043
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.16GB

[LAV DEBUG] Processing pair (1,0): N=839, M=575
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -120.567162
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234625.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=575) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 110201.914062
[LAV DEBUG]   Pair loss = -120.5672 + 0.01 * (234625.2500 + 110201.9141) = 3327.7043
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.40GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6655.4087
[LAV DEBUG] Total time: 0.34s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 5.40GB | Reserved: 5.72GB | Peak: 16.44GB
[MEM Before backward] Allocated: 5.39GB | Reserved: 5.72GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.42GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.42GB | Peak: 16.44GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.99GB | Reserved: 4.29GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([555, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([555, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.99GB, Reserved: 4.29GB

[LAV DEBUG] Processing pair (0,1): N=555, M=555
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.284569
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=555) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 102669.742188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=555) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 102669.742188
[LAV DEBUG]   Pair loss = -97.2846 + 0.01 * (102669.7422 + 102669.7422) = 1956.1102
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.14GB

[LAV DEBUG] Processing pair (1,0): N=555, M=555
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.284569
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=555) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 102669.742188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=555) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 102669.742188
[LAV DEBUG]   Pair loss = -97.2846 + 0.01 * (102669.7422 + 102669.7422) = 1956.1102
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.29GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3912.2205
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.29GB | Reserved: 4.74GB | Peak: 16.44GB
[MEM Before backward] Allocated: 4.28GB | Reserved: 4.74GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.04GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.04GB | Peak: 16.44GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.32GB | Reserved: 3.65GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([596, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([298, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.32GB, Reserved: 3.65GB

[LAV DEBUG] Processing pair (0,1): N=596, M=298
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.152748
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=596) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 118399.789062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=298) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29601.173828
[LAV DEBUG]   Pair loss = -71.1527 + 0.01 * (118399.7891 + 29601.1738) = 1408.8569
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.40GB

[LAV DEBUG] Processing pair (1,0): N=298, M=596
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.152748
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=298) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29601.173828
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=596) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 118399.789062
[LAV DEBUG]   Pair loss = -71.1527 + 0.01 * (29601.1738 + 118399.7891) = 1408.8569
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.49GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2817.7139
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.49GB | Reserved: 3.72GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.49GB | Reserved: 3.72GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.19GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.19GB | Peak: 16.44GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 2.33GB | Reserved: 2.64GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([378, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.33GB, Reserved: 2.64GB

[LAV DEBUG] Processing pair (0,1): N=378, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.949047
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=378) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47626.902344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.224609
[LAV DEBUG]   Pair loss = -45.9490 + 0.01 * (47626.9023 + 12806.2246) = 558.3822
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 2.37GB

[LAV DEBUG] Processing pair (1,0): N=196, M=378
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.949047
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.224609
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=378) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47626.902344
[LAV DEBUG]   Pair loss = -45.9490 + 0.01 * (12806.2246 + 47626.9023) = 558.3822
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.40GB
[2026-02-01 13:25:22,255 - INFO - alignment_training_loop.py:353] - [BATCH 16] Loss value: 1116.7644
[2026-02-01 13:25:26,349 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-02-01 13:25:26,584 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [383, 582]
[2026-02-01 13:25:31,777 - INFO - alignment_training_loop.py:353] - [BATCH 17] Loss value: 3072.7397
[2026-02-01 13:25:38,757 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Brownie.cmu
[2026-02-01 13:25:38,940 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [369, 403]
[2026-02-01 13:25:43,195 - INFO - alignment_training_loop.py:353] - [BATCH 18] Loss value: 1855.6067
[2026-02-01 13:25:48,753 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: tent
[2026-02-01 13:25:49,137 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: Sandwich.cmu
[2026-02-01 13:25:49,217 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [156, 160]
[2026-02-01 13:25:50,996 - INFO - alignment_training_loop.py:353] - [BATCH 20] Loss value: 278.2283
[2026-02-01 13:25:53,262 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Pizza.cmu
[2026-02-01 13:25:53,450 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [346, 458]

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1116.7644
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.40GB | Reserved: 2.54GB | Peak: 16.44GB
[MEM Before backward] Allocated: 2.40GB | Reserved: 2.54GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.91GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.91GB | Peak: 16.44GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.54GB | Reserved: 3.83GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([383, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([582, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.54GB, Reserved: 3.83GB

[LAV DEBUG] Processing pair (0,1): N=383, M=582
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.595200
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=383) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 48895.128906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=582) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 112901.390625
[LAV DEBUG]   Pair loss = -81.5952 + 0.01 * (48895.1289 + 112901.3906) = 1536.3699
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.65GB

[LAV DEBUG] Processing pair (1,0): N=582, M=383
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.595200
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=582) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 112901.390625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=383) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48895.128906
[LAV DEBUG]   Pair loss = -81.5952 + 0.01 * (112901.3906 + 48895.1289) = 1536.3699
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.75GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3072.7397
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.75GB | Reserved: 4.05GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.75GB | Reserved: 4.05GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.38GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.38GB | Peak: 16.44GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 2.94GB | Reserved: 3.26GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([369, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([403, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.94GB, Reserved: 3.26GB

[LAV DEBUG] Processing pair (0,1): N=369, M=403
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.406242
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=369) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 45386.101562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=403) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54134.859375
[LAV DEBUG]   Pair loss = -67.4062 + 0.01 * (45386.1016 + 54134.8594) = 927.8033
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.02GB

[LAV DEBUG] Processing pair (1,0): N=403, M=369
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.406242
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=403) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54134.859375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=369) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 45386.101562
[LAV DEBUG]   Pair loss = -67.4062 + 0.01 * (54134.8594 + 45386.1016) = 927.8033
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.09GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1855.6067
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 3.09GB | Reserved: 3.30GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.09GB | Reserved: 3.30GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.73GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.73GB | Peak: 16.44GB
[MEM Batch 19 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 1.54GB | Reserved: 1.77GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([156, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([160, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.54GB, Reserved: 1.77GB

[LAV DEBUG] Processing pair (0,1): N=156, M=160
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.362904
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=156) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8113.188477
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=160) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8534.517578
[LAV DEBUG]   Pair loss = -27.3629 + 0.01 * (8113.1885 + 8534.5176) = 139.1142
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.55GB

[LAV DEBUG] Processing pair (1,0): N=160, M=156
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.362904
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=160) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8534.517578
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=156) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8113.188477
[LAV DEBUG]   Pair loss = -27.3629 + 0.01 * (8534.5176 + 8113.1885) = 139.1142
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.56GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 278.2283
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.56GB | Reserved: 1.66GB | Peak: 16.44GB
[MEM Before backward] Allocated: 1.56GB | Reserved: 1.66GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.99GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.99GB | Peak: 16.44GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 3.04GB | Reserved: 3.34GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[2026-02-01 13:25:57,853 - INFO - alignment_training_loop.py:353] - [BATCH 21] Loss value: 2058.0366
[2026-02-01 13:26:03,667 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Salad.cmu
[2026-02-01 13:26:03,849 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [253, 529]
[2026-02-01 13:26:08,155 - INFO - alignment_training_loop.py:353] - [BATCH 22] Loss value: 2169.4563
[2026-02-01 13:26:13,803 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-02-01 13:26:14,110 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [875, 506]
[2026-02-01 13:26:21,545 - INFO - alignment_training_loop.py:353] - [BATCH 23] Loss value: 6582.5176
[2026-02-01 13:26:31,557 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: PastaSalad.egtea
[2026-02-01 13:26:32,287 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [1497, 1728]
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([458, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.04GB, Reserved: 3.34GB

[LAV DEBUG] Processing pair (0,1): N=346, M=458
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.223793
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39904.890625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=458) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 69919.312500
[LAV DEBUG]   Pair loss = -69.2238 + 0.01 * (39904.8906 + 69919.3125) = 1029.0183
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.12GB

[LAV DEBUG] Processing pair (1,0): N=458, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.223793
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=458) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 69919.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39904.890625
[LAV DEBUG]   Pair loss = -69.2238 + 0.01 * (69919.3125 + 39904.8906) = 1029.0183
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.19GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2058.0366
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.19GB | Reserved: 3.38GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.19GB | Reserved: 3.38GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.82GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.82GB | Peak: 16.44GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 2.98GB | Reserved: 3.26GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([253, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.98GB, Reserved: 3.26GB

[LAV DEBUG] Processing pair (0,1): N=253, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -61.414886
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=253) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21336.894531
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93277.421875
[LAV DEBUG]   Pair loss = -61.4149 + 0.01 * (21336.8945 + 93277.4219) = 1084.7281
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.04GB

[LAV DEBUG] Processing pair (1,0): N=529, M=253
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -61.414886
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93277.421875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=253) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21336.894531
[LAV DEBUG]   Pair loss = -61.4149 + 0.01 * (93277.4219 + 21336.8945) = 1084.7281
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.11GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2169.4563
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.11GB | Reserved: 3.29GB | Peak: 16.44GB
[MEM Before backward] Allocated: 3.11GB | Reserved: 3.29GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.69GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.69GB | Peak: 16.44GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 4.82GB | Reserved: 5.20GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([506, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.82GB, Reserved: 5.20GB

[LAV DEBUG] Processing pair (0,1): N=875, M=506
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -114.136589
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255196.359375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=506) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85343.171875
[LAV DEBUG]   Pair loss = -114.1366 + 0.01 * (255196.3594 + 85343.1719) = 3291.2588
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.03GB

[LAV DEBUG] Processing pair (1,0): N=506, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -114.136589
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=506) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85343.171875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255196.359375
[LAV DEBUG]   Pair loss = -114.1366 + 0.01 * (85343.1719 + 255196.3594) = 3291.2588
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.25GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6582.5176
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.25GB | Reserved: 5.83GB | Peak: 16.44GB
[MEM Before backward] Allocated: 5.25GB | Reserved: 5.83GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.26GB | Peak: 16.44GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.26GB | Peak: 16.44GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.44GB
[MEM After forward pass] Allocated: 10.50GB | Reserved: 11.34GB | Peak: 16.44GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1728, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.50GB, Reserved: 11.34GB

[LAV DEBUG] Processing pair (0,1): N=1497, M=1728
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -282.470734
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 746972.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1728) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 995285.500000
[LAV DEBUG]   Pair loss = -282.4707 + 0.01 * (746972.5000 + 995285.5000) = 17140.1094
[LAV DEBUG]   Pair (0,1) completed in 0.23s
[LAV DEBUG]   GPU Memory after pair: 11.76GB

[LAV DEBUG] Processing pair (1,0): N=1728, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -282.470734
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1728) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 995285.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497) [no_grad]...
[2026-02-01 13:26:49,705 - INFO - alignment_training_loop.py:353] - [BATCH 24] Loss value: 34280.2188
[2026-02-01 13:27:13,741 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: PastaSalad.egtea
[2026-02-01 13:27:14,551 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [1438, 2196]
[2026-02-01 13:27:34,288 - INFO - alignment_training_loop.py:353] - [BATCH 25] Loss value: 45316.3047
[2026-02-01 13:28:01,578 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: tent
[2026-02-01 13:28:01,803 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: Pizza.cmu
[2026-02-01 13:28:02,072 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [529, 593]
[2026-02-01 13:28:08,219 - INFO - alignment_training_loop.py:353] - [BATCH 27] Loss value: 4013.6707
[2026-02-01 13:28:16,376 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: Sandwich.cmu
[2026-02-01 13:28:16,482 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [224, 188]
[2026-02-01 13:28:18,899 - INFO - alignment_training_loop.py:353] - [BATCH 28] Loss value: 498.9941
[2026-02-01 13:28:21,890 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: Pizza.egtea
[2026-02-01 13:28:22,317 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [632, 1236]
[LAV DEBUG]   IntraContrast v2 result: 746972.500000
[LAV DEBUG]   Pair loss = -282.4707 + 0.01 * (995285.5000 + 746972.5000) = 17140.1094
[LAV DEBUG]   Pair (1,0) completed in 0.21s
[LAV DEBUG]   GPU Memory after pair: 13.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 34280.2188
[LAV DEBUG] Total time: 0.71s
[LAV DEBUG] Avg time per pair: 0.36s
============================================================

[MEM After loss computation] Allocated: 13.01GB | Reserved: 13.82GB | Peak: 16.44GB
[MEM Before backward] Allocated: 13.01GB | Reserved: 13.82GB | Peak: 16.44GB
[MEM After backward] Allocated: 0.74GB | Reserved: 17.54GB | Peak: 16.70GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 17.54GB | Peak: 16.70GB
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.70GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 16.70GB
[MEM After forward pass] Allocated: 11.77GB | Reserved: 12.67GB | Peak: 16.70GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.77GB, Reserved: 12.67GB

[LAV DEBUG] Processing pair (0,1): N=1438, M=2196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -308.458038
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 689254.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1607407.250000
[LAV DEBUG]   Pair loss = -308.4580 + 0.01 * (689254.0625 + 1607407.2500) = 22658.1523
[LAV DEBUG]   Pair (0,1) completed in 0.27s
[LAV DEBUG]   GPU Memory after pair: 13.30GB

[LAV DEBUG] Processing pair (1,0): N=2196, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -308.458038
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1607407.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 689254.062500
[LAV DEBUG]   Pair loss = -308.4580 + 0.01 * (1607407.2500 + 689254.0625) = 22658.1523
[LAV DEBUG]   Pair (1,0) completed in 0.28s
[LAV DEBUG]   GPU Memory after pair: 14.83GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 45316.3047
[LAV DEBUG] Total time: 0.82s
[LAV DEBUG] Avg time per pair: 0.41s
============================================================

[MEM After loss computation] Allocated: 14.83GB | Reserved: 17.17GB | Peak: 16.70GB
[MEM Before backward] Allocated: 14.83GB | Reserved: 17.17GB | Peak: 16.70GB
[MEM After backward] Allocated: 0.74GB | Reserved: 21.69GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 21.69GB | Peak: 19.34GB
[MEM Batch 26 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM Batch 27 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.02GB | Reserved: 4.43GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([593, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.02GB, Reserved: 4.43GB

[LAV DEBUG] Processing pair (0,1): N=529, M=593
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.083160
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93278.445312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=593) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 117213.398438
[LAV DEBUG]   Pair loss = -98.0832 + 0.01 * (93278.4453 + 117213.3984) = 2006.8353
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.18GB

[LAV DEBUG] Processing pair (1,0): N=593, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.083160
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=593) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 117213.398438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93278.445312
[LAV DEBUG]   Pair loss = -98.0832 + 0.01 * (117213.3984 + 93278.4453) = 2006.8353
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.33GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4013.6707
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 4.33GB | Reserved: 4.62GB | Peak: 19.34GB
[MEM Before backward] Allocated: 4.33GB | Reserved: 4.62GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.08GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.08GB | Peak: 19.34GB
[MEM Batch 28 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.83GB | Reserved: 2.12GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.83GB, Reserved: 2.12GB

[LAV DEBUG] Processing pair (0,1): N=224, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.591061
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.332031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.482422
[LAV DEBUG]   Pair loss = -35.5911 + 0.01 * (16726.3320 + 11782.4824) = 249.4971
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.85GB

[LAV DEBUG] Processing pair (1,0): N=188, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.591061
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.482422
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.332031
[LAV DEBUG]   Pair loss = -35.5911 + 0.01 * (11782.4824 + 16726.3320) = 249.4971
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.88GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 498.9941
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.88GB | Reserved: 2.01GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.87GB | Reserved: 2.01GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.30GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.30GB | Peak: 19.34GB
[MEM Batch 29 START - Task Pizza.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[2026-02-01 13:28:32,492 - INFO - alignment_training_loop.py:353] - [BATCH 29] Loss value: 12546.8301
[2026-02-01 13:28:46,243 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Brownie.cmu
[2026-02-01 13:28:46,463 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [416, 523]
[2026-02-01 13:28:51,668 - INFO - alignment_training_loop.py:353] - [BATCH 30] Loss value: 2814.4834
[2026-02-01 13:28:58,506 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Pizza.cmu
[2026-02-01 13:28:58,715 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [351, 531]
[2026-02-01 13:29:03,593 - INFO - alignment_training_loop.py:353] - [BATCH 31] Loss value: 2551.8774
[2026-02-01 13:29:10,043 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: tent
[2026-02-01 13:29:10,392 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: meccano
[2026-02-01 13:29:10,718 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [759, 694]
[MEM After forward pass] Allocated: 6.32GB | Reserved: 6.82GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([632, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 6.32GB, Reserved: 6.82GB

[LAV DEBUG] Processing pair (0,1): N=632, M=1236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -150.117432
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=632) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 133138.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 509215.156250
[LAV DEBUG]   Pair loss = -150.1174 + 0.01 * (133138.1250 + 509215.1562) = 6273.4150
[LAV DEBUG]   Pair (0,1) completed in 0.07s
[LAV DEBUG]   GPU Memory after pair: 6.70GB

[LAV DEBUG] Processing pair (1,0): N=1236, M=632
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -150.117432
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 509215.156250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=632) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 133138.125000
[LAV DEBUG]   Pair loss = -150.1174 + 0.01 * (509215.1562 + 133138.1250) = 6273.4150
[LAV DEBUG]   Pair (1,0) completed in 0.07s
[LAV DEBUG]   GPU Memory after pair: 7.08GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 12546.8301
[LAV DEBUG] Total time: 0.37s
[LAV DEBUG] Avg time per pair: 0.18s
============================================================

[MEM After loss computation] Allocated: 7.08GB | Reserved: 7.57GB | Peak: 19.34GB
[MEM Before backward] Allocated: 7.08GB | Reserved: 7.57GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.69GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 8.69GB | Peak: 19.34GB
[MEM Batch 30 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.46GB | Reserved: 3.77GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([416, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.46GB, Reserved: 3.77GB

[LAV DEBUG] Processing pair (0,1): N=416, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.357117
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=416) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 57685.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91174.757812
[LAV DEBUG]   Pair loss = -81.3571 + 0.01 * (57685.1250 + 91174.7578) = 1407.2417
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.57GB

[LAV DEBUG] Processing pair (1,0): N=523, M=416
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.357117
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91174.757812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=416) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 57685.125000
[LAV DEBUG]   Pair loss = -81.3571 + 0.01 * (91174.7578 + 57685.1250) = 1407.2417
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2814.4834
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.67GB | Reserved: 3.98GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.67GB | Reserved: 3.98GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.30GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.30GB | Peak: 19.34GB
[MEM Batch 31 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.28GB | Reserved: 3.63GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([351, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([531, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.28GB, Reserved: 3.63GB

[LAV DEBUG] Processing pair (0,1): N=351, M=531
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -74.589943
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=351) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 41067.277344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=531) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93985.601562
[LAV DEBUG]   Pair loss = -74.5899 + 0.01 * (41067.2773 + 93985.6016) = 1275.9387
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.38GB

[LAV DEBUG] Processing pair (1,0): N=531, M=351
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -74.589943
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=531) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93985.601562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=351) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 41067.277344
[LAV DEBUG]   Pair loss = -74.5899 + 0.01 * (93985.6016 + 41067.2773) = 1275.9387
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.47GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2551.8774
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.47GB | Reserved: 3.70GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.47GB | Reserved: 3.70GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.18GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.18GB | Peak: 19.34GB
[MEM Batch 32 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM Batch 33 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.04GB | Reserved: 5.47GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([759, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([694, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.04GB, Reserved: 5.47GB

[LAV DEBUG] Processing pair (0,1): N=759, M=694
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -127.296371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=759) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 192022.406250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=694) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 160541.687500
[LAV DEBUG]   Pair loss = -127.2964 + 0.01 * (192022.4062 + 160541.6875) = 3398.3445
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[2026-02-01 13:29:18,658 - INFO - alignment_training_loop.py:353] - [BATCH 33] Loss value: 6796.6890
[2026-02-01 13:29:29,308 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Brownie.cmu
[2026-02-01 13:29:29,464 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [313, 330]
[2026-02-01 13:29:33,039 - INFO - alignment_training_loop.py:353] - [BATCH 34] Loss value: 1266.9104
[2026-02-01 13:29:37,700 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: pc_disassembly
[2026-02-01 13:29:37,853 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [317, 295]
[2026-02-01 13:29:41,298 - INFO - alignment_training_loop.py:353] - [BATCH 35] Loss value: 1143.3907
[2026-02-01 13:29:45,750 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: Salad.cmu
[2026-02-01 13:29:45,873 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [305, 173]
[2026-02-01 13:29:48,582 - INFO - alignment_training_loop.py:353] - [BATCH 36] Loss value: 741.6942
[2026-02-01 13:29:52,055 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: meccano
[LAV DEBUG]   GPU Memory after pair: 5.30GB

[LAV DEBUG] Processing pair (1,0): N=694, M=759
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -127.296371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=694) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160541.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=759) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 192022.406250
[LAV DEBUG]   Pair loss = -127.2964 + 0.01 * (160541.6875 + 192022.4062) = 3398.3445
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6796.6890
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 5.55GB | Reserved: 5.97GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.55GB | Reserved: 5.97GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.73GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.73GB | Peak: 19.34GB
[MEM Batch 34 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.54GB | Reserved: 2.82GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([313, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([330, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.54GB, Reserved: 2.82GB

[LAV DEBUG] Processing pair (0,1): N=313, M=330
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.119923
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=313) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32656.960938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=330) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36300.558594
[LAV DEBUG]   Pair loss = -56.1199 + 0.01 * (32656.9609 + 36300.5586) = 633.4552
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.60GB

[LAV DEBUG] Processing pair (1,0): N=330, M=313
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.119923
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=330) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36300.558594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=313) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32656.960938
[LAV DEBUG]   Pair loss = -56.1199 + 0.01 * (36300.5586 + 32656.9609) = 633.4552
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.65GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1266.9104
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.65GB | Reserved: 2.81GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.64GB | Reserved: 2.81GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.29GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.29GB | Peak: 19.34GB
[MEM Batch 35 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.45GB | Reserved: 2.74GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([317, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([295, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.45GB, Reserved: 2.74GB

[LAV DEBUG] Processing pair (0,1): N=317, M=295
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.365940
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=317) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 33497.011719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=295) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29009.123047
[LAV DEBUG]   Pair loss = -53.3659 + 0.01 * (33497.0117 + 29009.1230) = 571.6954
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.50GB

[LAV DEBUG] Processing pair (1,0): N=295, M=317
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.365940
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=295) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29009.123047
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=317) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 33497.011719
[LAV DEBUG]   Pair loss = -53.3659 + 0.01 * (29009.1230 + 33497.0117) = 571.6954
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.54GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1143.3907
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.54GB | Reserved: 2.68GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.54GB | Reserved: 2.68GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.08GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.08GB | Peak: 19.34GB
[MEM Batch 36 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.04GB | Reserved: 2.29GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([305, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([173, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.04GB, Reserved: 2.29GB

[LAV DEBUG] Processing pair (0,1): N=305, M=173
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.021797
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=305) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31009.156250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=173) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9977.730469
[LAV DEBUG]   Pair loss = -39.0218 + 0.01 * (31009.1562 + 9977.7305) = 370.8471
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.06GB

[LAV DEBUG] Processing pair (1,0): N=173, M=305
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.021797
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=173) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9977.730469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=305) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31009.156250
[LAV DEBUG]   Pair loss = -39.0218 + 0.01 * (9977.7305 + 31009.1562) = 370.8471
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.09GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 741.6942
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.09GB | Reserved: 2.21GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.09GB | Reserved: 2.21GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.61GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.61GB | Peak: 19.34GB
[2026-02-01 13:29:52,713 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [1474, 1410]
[2026-02-01 13:30:08,273 - INFO - alignment_training_loop.py:353] - [BATCH 37] Loss value: 27230.8906
[2026-02-01 13:30:29,859 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: Salad.cmu
[2026-02-01 13:30:30,041 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [224, 523]
[2026-02-01 13:30:34,263 - INFO - alignment_training_loop.py:353] - [BATCH 38] Loss value: 2044.6360
[2026-02-01 13:30:39,738 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: Eggs.cmu
[2026-02-01 13:30:39,887 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [368, 246]
[2026-02-01 13:30:43,357 - INFO - alignment_training_loop.py:353] - [BATCH 39] Loss value: 1202.5537
[2026-02-01 13:30:47,824 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: PastaSalad.egtea
[2026-02-01 13:30:48,577 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [1796, 1401]
[MEM Batch 37 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 9.45GB | Reserved: 10.20GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1474, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1410, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.45GB, Reserved: 10.20GB

[LAV DEBUG] Processing pair (0,1): N=1474, M=1410
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -253.491989
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1474) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 724208.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1410) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 662685.125000
[LAV DEBUG]   Pair loss = -253.4920 + 0.01 * (724208.5625 + 662685.1250) = 13615.4453
[LAV DEBUG]   Pair (0,1) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 10.46GB

[LAV DEBUG] Processing pair (1,0): N=1410, M=1474
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -253.491989
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1410) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 662685.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1474) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 724208.562500
[LAV DEBUG]   Pair loss = -253.4920 + 0.01 * (662685.1250 + 724208.5625) = 13615.4453
[LAV DEBUG]   Pair (1,0) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 11.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 27230.8906
[LAV DEBUG] Total time: 0.56s
[LAV DEBUG] Avg time per pair: 0.28s
============================================================

[MEM After loss computation] Allocated: 11.46GB | Reserved: 13.16GB | Peak: 19.34GB
[MEM Before backward] Allocated: 11.46GB | Reserved: 13.16GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 16.14GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 16.14GB | Peak: 19.34GB
[MEM Batch 38 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.87GB | Reserved: 3.17GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.87GB, Reserved: 3.17GB

[LAV DEBUG] Processing pair (0,1): N=224, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.705799
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.607422
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91175.773438
[LAV DEBUG]   Pair loss = -56.7058 + 0.01 * (16726.6074 + 91175.7734) = 1022.3180
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.93GB

[LAV DEBUG] Processing pair (1,0): N=523, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.705799
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91175.773438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.607422
[LAV DEBUG]   Pair loss = -56.7058 + 0.01 * (91175.7734 + 16726.6074) = 1022.3180
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.98GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2044.6360
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.98GB | Reserved: 3.17GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.98GB | Reserved: 3.17GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.56GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.56GB | Peak: 19.34GB
[MEM Batch 39 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.46GB | Reserved: 2.74GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([368, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([246, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.46GB, Reserved: 2.74GB

[LAV DEBUG] Processing pair (0,1): N=368, M=246
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.874409
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=368) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 45141.949219
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=246) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 20173.177734
[LAV DEBUG]   Pair loss = -51.8744 + 0.01 * (45141.9492 + 20173.1777) = 601.2769
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.50GB

[LAV DEBUG] Processing pair (1,0): N=246, M=368
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.874409
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=246) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 20173.177734
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=368) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 45141.949219
[LAV DEBUG]   Pair loss = -51.8744 + 0.01 * (20173.1777 + 45141.9492) = 601.2769
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.54GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1202.5537
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.54GB | Reserved: 2.72GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.54GB | Reserved: 2.72GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.18GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.18GB | Peak: 19.34GB
[MEM Batch 40 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 10.42GB | Reserved: 11.25GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1796, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1401, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.42GB, Reserved: 11.25GB

[LAV DEBUG] Processing pair (0,1): N=1796, M=1401
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -277.717468
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1075172.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 654242.562500
[LAV DEBUG]   Pair loss = -277.7175 + 0.01 * (1075172.3750 + 654242.5625) = 17016.4336
[2026-02-01 13:31:05,939 - INFO - alignment_training_loop.py:353] - [BATCH 40] Loss value: 34032.8672
[2026-02-01 13:31:30,137 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: Pizza.cmu
[2026-02-01 13:31:30,348 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [471, 439]
[2026-02-01 13:31:35,381 - INFO - alignment_training_loop.py:353] - [BATCH 41] Loss value: 2604.5767
[2026-02-01 13:31:42,001 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: TurkeySandwich.egtea
[2026-02-01 13:31:42,182 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [429, 327]
[2026-02-01 13:31:46,390 - INFO - alignment_training_loop.py:353] - [BATCH 42] Loss value: 1809.5691
[2026-02-01 13:31:51,933 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: Brownie.cmu
[2026-02-01 13:31:52,065 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [329, 224]
[2026-02-01 13:31:55,223 - INFO - alignment_training_loop.py:353] - [BATCH 43] Loss value: 962.5396
[LAV DEBUG]   Pair (0,1) completed in 0.24s
[LAV DEBUG]   GPU Memory after pair: 11.64GB

[LAV DEBUG] Processing pair (1,0): N=1401, M=1796
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -277.717468
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 654242.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1075172.375000
[LAV DEBUG]   Pair loss = -277.7175 + 0.01 * (654242.5625 + 1075172.3750) = 17016.4336
[LAV DEBUG]   Pair (1,0) completed in 0.22s
[LAV DEBUG]   GPU Memory after pair: 12.86GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 34032.8672
[LAV DEBUG] Total time: 0.69s
[LAV DEBUG] Avg time per pair: 0.34s
============================================================

[MEM After loss computation] Allocated: 12.86GB | Reserved: 13.67GB | Peak: 19.34GB
[MEM Before backward] Allocated: 12.86GB | Reserved: 13.67GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 17.29GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 17.29GB | Peak: 19.34GB
[MEM Batch 41 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.37GB | Reserved: 3.71GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([471, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([439, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.37GB, Reserved: 3.71GB

[LAV DEBUG] Processing pair (0,1): N=471, M=439
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.587349
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=471) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73947.031250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=439) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 64240.546875
[LAV DEBUG]   Pair loss = -79.5873 + 0.01 * (73947.0312 + 64240.5469) = 1302.2883
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.47GB

[LAV DEBUG] Processing pair (1,0): N=439, M=471
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.587349
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=439) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 64240.546875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=471) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73947.031250
[LAV DEBUG]   Pair loss = -79.5873 + 0.01 * (64240.5469 + 73947.0312) = 1302.2883
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.57GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2604.5767
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 3.57GB | Reserved: 3.80GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.57GB | Reserved: 3.80GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.31GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.31GB | Peak: 19.34GB
[MEM Batch 42 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.89GB | Reserved: 3.22GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([429, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([327, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.89GB, Reserved: 3.22GB

[LAV DEBUG] Processing pair (0,1): N=429, M=327
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -65.126823
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=429) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61347.316406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=327) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35643.824219
[LAV DEBUG]   Pair loss = -65.1268 + 0.01 * (61347.3164 + 35643.8242) = 904.7845
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.96GB

[LAV DEBUG] Processing pair (1,0): N=327, M=429
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -65.126823
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=327) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35643.824219
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=429) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61347.316406
[LAV DEBUG]   Pair loss = -65.1268 + 0.01 * (35643.8242 + 61347.3164) = 904.7845
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.03GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1809.5691
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.03GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.03GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.66GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.66GB | Peak: 19.34GB
[MEM Batch 43 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.27GB | Reserved: 2.58GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.27GB, Reserved: 2.58GB

[LAV DEBUG] Processing pair (0,1): N=329, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.809422
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36081.199219
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.726562
[LAV DEBUG]   Pair loss = -46.8094 + 0.01 * (36081.1992 + 16726.7266) = 481.2698
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.31GB

[LAV DEBUG] Processing pair (1,0): N=224, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.809422
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.726562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36081.199219
[LAV DEBUG]   Pair loss = -46.8094 + 0.01 * (16726.7266 + 36081.1992) = 481.2698
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.34GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 962.5396
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.85GB | Peak: 19.34GB
[2026-02-01 13:31:59,241 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: meccano
[2026-02-01 13:31:59,894 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [1341, 1598]
[2026-02-01 13:32:15,870 - INFO - alignment_training_loop.py:353] - [BATCH 44] Loss value: 28498.3574
[2026-02-01 13:32:37,874 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: Salad.cmu
[2026-02-01 13:32:38,043 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [300, 390]
[2026-02-01 13:32:41,906 - INFO - alignment_training_loop.py:353] - [BATCH 45] Loss value: 1495.1174
[2026-02-01 13:32:46,892 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Eggs.cmu
[2026-02-01 13:32:47,066 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [428, 271]
[2026-02-01 13:32:50,995 - INFO - alignment_training_loop.py:353] - [BATCH 46] Loss value: 1593.7197
[2026-02-01 13:32:56,051 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: PastaSalad.egtea
[2026-02-01 13:32:56,742 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [2492, 543]
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.85GB | Peak: 19.34GB
[MEM Batch 44 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 9.62GB | Reserved: 10.38GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1598, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.62GB, Reserved: 10.38GB

[LAV DEBUG] Processing pair (0,1): N=1341, M=1598
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -256.848236
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 599416.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1598) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 851186.062500
[LAV DEBUG]   Pair loss = -256.8482 + 0.01 * (599416.6875 + 851186.0625) = 14249.1787
[LAV DEBUG]   Pair (0,1) completed in 0.19s
[LAV DEBUG]   GPU Memory after pair: 10.66GB

[LAV DEBUG] Processing pair (1,0): N=1598, M=1341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -256.848236
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1598) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 851186.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 599416.687500
[LAV DEBUG]   Pair loss = -256.8482 + 0.01 * (851186.0625 + 599416.6875) = 14249.1787
[LAV DEBUG]   Pair (1,0) completed in 0.19s
[LAV DEBUG]   GPU Memory after pair: 11.70GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 28498.3574
[LAV DEBUG] Total time: 0.61s
[LAV DEBUG] Avg time per pair: 0.31s
============================================================

[MEM After loss computation] Allocated: 11.70GB | Reserved: 12.44GB | Peak: 19.34GB
[MEM Before backward] Allocated: 11.70GB | Reserved: 12.44GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 15.53GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 15.53GB | Peak: 19.34GB
[MEM Batch 45 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.69GB | Reserved: 3.05GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([300, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([390, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.69GB, Reserved: 3.05GB

[LAV DEBUG] Processing pair (0,1): N=300, M=390
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.457787
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=300) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 30001.029297
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=390) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 50700.617188
[LAV DEBUG]   Pair loss = -59.4578 + 0.01 * (30001.0293 + 50700.6172) = 747.5587
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.75GB

[LAV DEBUG] Processing pair (1,0): N=390, M=300
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.457787
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=390) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 50700.617188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=300) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 30001.029297
[LAV DEBUG]   Pair loss = -59.4578 + 0.01 * (50700.6172 + 30001.0293) = 747.5587
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.80GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1495.1174
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.80GB | Reserved: 3.00GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.80GB | Reserved: 3.00GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.38GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.38GB | Peak: 19.34GB
[MEM Batch 46 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.72GB | Reserved: 3.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([428, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([271, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.72GB, Reserved: 3.08GB

[LAV DEBUG] Processing pair (0,1): N=428, M=271
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -58.574078
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=428) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61061.816406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=271) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24481.583984
[LAV DEBUG]   Pair loss = -58.5741 + 0.01 * (61061.8164 + 24481.5840) = 796.8599
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.77GB

[LAV DEBUG] Processing pair (1,0): N=271, M=428
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -58.574078
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=271) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24481.583984
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=428) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61061.816406
[LAV DEBUG]   Pair loss = -58.5741 + 0.01 * (24481.5840 + 61061.8164) = 796.8599
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.83GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1593.7197
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.83GB | Reserved: 3.02GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.83GB | Reserved: 3.02GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.41GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.41GB | Peak: 19.34GB
[MEM Batch 47 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 9.92GB | Reserved: 10.64GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2492, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.92GB, Reserved: 10.64GB

[LAV DEBUG] Processing pair (0,1): N=2492, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -174.248123
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2492) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2069980.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 98282.742188
[2026-02-01 13:33:13,137 - INFO - alignment_training_loop.py:353] - [BATCH 47] Loss value: 43016.7695
[2026-02-01 13:33:35,507 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: GreekSalad.egtea
[2026-02-01 13:33:35,779 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [467, 658]
[2026-02-01 13:33:41,946 - INFO - alignment_training_loop.py:353] - [BATCH 48] Loss value: 4147.7236
[2026-02-01 13:33:50,142 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: Sandwich.cmu
[2026-02-01 13:33:50,239 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [168, 199]
[2026-02-01 13:33:52,432 - INFO - alignment_training_loop.py:353] - [BATCH 49] Loss value: 388.8898
[2026-02-01 13:33:55,144 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: ContinentalBreakfast.egtea
[2026-02-01 13:33:55,394 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [474, 543]
[2026-02-01 13:34:00,979 - INFO - alignment_training_loop.py:353] - [BATCH 50] Loss value: 3285.9810
[LAV DEBUG]   Pair loss = -174.2481 + 0.01 * (2069980.6250 + 98282.7422) = 21508.3848
[LAV DEBUG]   Pair (0,1) completed in 0.12s
[LAV DEBUG]   GPU Memory after pair: 10.57GB

[LAV DEBUG] Processing pair (1,0): N=543, M=2492
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -174.248123
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 98282.742188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2492) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2069980.625000
[LAV DEBUG]   Pair loss = -174.2481 + 0.01 * (98282.7422 + 2069980.6250) = 21508.3848
[LAV DEBUG]   Pair (1,0) completed in 0.12s
[LAV DEBUG]   GPU Memory after pair: 11.23GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 43016.7695
[LAV DEBUG] Total time: 0.49s
[LAV DEBUG] Avg time per pair: 0.24s
============================================================

[MEM After loss computation] Allocated: 11.23GB | Reserved: 12.56GB | Peak: 19.34GB
[MEM Before backward] Allocated: 11.23GB | Reserved: 12.56GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.50GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.50GB | Peak: 19.34GB
[MEM Batch 48 START - Task GreekSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.03GB | Reserved: 4.45GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([467, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([658, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.03GB, Reserved: 4.45GB

[LAV DEBUG] Processing pair (0,1): N=467, M=658
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.304596
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=467) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 72696.578125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=658) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 144320.078125
[LAV DEBUG]   Pair loss = -96.3046 + 0.01 * (72696.5781 + 144320.0781) = 2073.8618
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.18GB

[LAV DEBUG] Processing pair (1,0): N=658, M=467
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.304596
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=658) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 144320.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=467) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 72696.578125
[LAV DEBUG]   Pair loss = -96.3046 + 0.01 * (144320.0781 + 72696.5781) = 2073.8618
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.33GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4147.7236
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.33GB | Reserved: 4.64GB | Peak: 19.34GB
[MEM Before backward] Allocated: 4.33GB | Reserved: 4.64GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.08GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.08GB | Peak: 19.34GB
[MEM Batch 49 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.69GB | Reserved: 1.90GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.69GB, Reserved: 1.90GB

[LAV DEBUG] Processing pair (0,1): N=168, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.668037
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.510742
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13201.784180
[LAV DEBUG]   Pair loss = -31.6680 + 0.01 * (9409.5107 + 13201.7842) = 194.4449
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.71GB

[LAV DEBUG] Processing pair (1,0): N=199, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.668037
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13201.784180
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.510742
[LAV DEBUG]   Pair loss = -31.6680 + 0.01 * (13201.7842 + 9409.5107) = 194.4449
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.73GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 388.8898
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.73GB | Reserved: 1.81GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.73GB | Reserved: 1.81GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.19GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.19GB | Peak: 19.34GB
[MEM Batch 50 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.70GB | Reserved: 4.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([474, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.70GB, Reserved: 4.08GB

[LAV DEBUG] Processing pair (0,1): N=474, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -88.760582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=474) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 74892.265625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 98282.843750
[LAV DEBUG]   Pair loss = -88.7606 + 0.01 * (74892.2656 + 98282.8438) = 1642.9905
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.82GB

[LAV DEBUG] Processing pair (1,0): N=543, M=474
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -88.760582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 98282.843750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=474) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 74892.265625
[LAV DEBUG]   Pair loss = -88.7606 + 0.01 * (98282.8438 + 74892.2656) = 1642.9905
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3285.9810
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.95GB | Reserved: 4.22GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.95GB | Reserved: 4.22GB | Peak: 19.34GB
[2026-02-01 13:34:08,375 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Salad.cmu
[2026-02-01 13:34:08,527 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [379, 272]
[2026-02-01 13:34:12,243 - INFO - alignment_training_loop.py:353] - [BATCH 51] Loss value: 1339.6608
[2026-02-01 13:34:16,976 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: Brownie.cmu
[2026-02-01 13:34:17,197 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [621, 297]
[2026-02-01 13:34:22,308 - INFO - alignment_training_loop.py:353] - [BATCH 52] Loss value: 3014.6428
[2026-02-01 13:34:28,987 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Sandwich.cmu
[2026-02-01 13:34:29,072 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [142, 175]
[2026-02-01 13:34:30,955 - INFO - alignment_training_loop.py:353] - [BATCH 53] Loss value: 284.2343
[2026-02-01 13:34:33,277 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: Sandwich.cmu
[2026-02-01 13:34:33,359 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [127, 184]
[MEM After backward] Allocated: 0.74GB | Reserved: 4.59GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.59GB | Peak: 19.34GB
[MEM Batch 51 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.57GB | Reserved: 2.84GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([379, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.57GB, Reserved: 2.84GB

[LAV DEBUG] Processing pair (0,1): N=379, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.607231
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=379) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47881.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24662.703125
[LAV DEBUG]   Pair loss = -55.6072 + 0.01 * (47881.0625 + 24662.7031) = 669.8304
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.62GB

[LAV DEBUG] Processing pair (1,0): N=272, M=379
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.607231
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24662.703125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=379) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47881.062500
[LAV DEBUG]   Pair loss = -55.6072 + 0.01 * (24662.7031 + 47881.0625) = 669.8304
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1339.6608
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 2.67GB | Reserved: 2.84GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.67GB | Reserved: 2.84GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.31GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.31GB | Peak: 19.34GB
[MEM Batch 52 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.39GB | Reserved: 3.71GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([621, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([297, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.39GB, Reserved: 3.71GB

[LAV DEBUG] Processing pair (0,1): N=621, M=297
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.182045
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=621) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 128546.234375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=297) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29404.107422
[LAV DEBUG]   Pair loss = -72.1820 + 0.01 * (128546.2344 + 29404.1074) = 1507.3214
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.48GB

[LAV DEBUG] Processing pair (1,0): N=297, M=621
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.182045
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=297) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29404.107422
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=621) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 128546.234375
[LAV DEBUG]   Pair loss = -72.1820 + 0.01 * (29404.1074 + 128546.2344) = 1507.3214
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.57GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3014.6428
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.57GB | Reserved: 3.79GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.57GB | Reserved: 3.79GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.27GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.27GB | Peak: 19.34GB
[MEM Batch 53 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.54GB | Reserved: 1.78GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([142, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.54GB, Reserved: 1.78GB

[LAV DEBUG] Processing pair (0,1): N=142, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.210300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=142) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6722.886719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10209.854492
[LAV DEBUG]   Pair loss = -27.2103 + 0.01 * (6722.8867 + 10209.8545) = 142.1171
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.55GB

[LAV DEBUG] Processing pair (1,0): N=175, M=142
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.210300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10209.854492
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=142) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6722.886719
[LAV DEBUG]   Pair loss = -27.2103 + 0.01 * (10209.8545 + 6722.8867) = 142.1171
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.56GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 284.2343
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.56GB | Reserved: 1.67GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.56GB | Reserved: 1.67GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.99GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.99GB | Peak: 19.34GB
[MEM Batch 54 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.52GB | Reserved: 1.76GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([127, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.52GB, Reserved: 1.76GB

[LAV DEBUG] Processing pair (0,1): N=127, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.182550
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=127) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5377.920410
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11286.840820
[2026-02-01 13:34:35,225 - INFO - alignment_training_loop.py:353] - [BATCH 54] Loss value: 280.9301
[2026-02-01 13:34:37,482 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Salad.cmu
[2026-02-01 13:34:37,653 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [408, 272]
[2026-02-01 13:34:41,433 - INFO - alignment_training_loop.py:353] - [BATCH 55] Loss value: 1488.0753
[2026-02-01 13:34:46,390 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: Cheeseburger.egtea
[2026-02-01 13:34:46,694 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [844, 470]
[2026-02-01 13:34:53,911 - INFO - alignment_training_loop.py:353] - [BATCH 56] Loss value: 6006.2012
[2026-02-01 13:35:03,463 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 13:35:03,613 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [237, 341]
[2026-02-01 13:35:06,891 - INFO - alignment_training_loop.py:353] - [BATCH 57] Loss value: 1051.5178
[LAV DEBUG]   Pair loss = -26.1826 + 0.01 * (5377.9204 + 11286.8408) = 140.4651
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.53GB

[LAV DEBUG] Processing pair (1,0): N=184, M=127
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.182550
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11286.840820
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=127) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5377.920410
[LAV DEBUG]   Pair loss = -26.1826 + 0.01 * (11286.8408 + 5377.9204) = 140.4651
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.54GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 280.9301
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.54GB | Reserved: 1.65GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.54GB | Reserved: 1.65GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.98GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.98GB | Peak: 19.34GB
[MEM Batch 55 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.66GB | Reserved: 2.92GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([408, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.66GB, Reserved: 2.92GB

[LAV DEBUG] Processing pair (0,1): N=408, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -57.476280
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=408) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 55488.656250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24662.730469
[LAV DEBUG]   Pair loss = -57.4763 + 0.01 * (55488.6562 + 24662.7305) = 744.0377
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.71GB

[LAV DEBUG] Processing pair (1,0): N=272, M=408
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -57.476280
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24662.730469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=408) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 55488.656250
[LAV DEBUG]   Pair loss = -57.4763 + 0.01 * (24662.7305 + 55488.6562) = 744.0377
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.77GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1488.0753
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.77GB | Reserved: 2.97GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.77GB | Reserved: 2.97GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM Batch 56 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.61GB | Reserved: 5.02GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([844, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([470, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.61GB, Reserved: 5.02GB

[LAV DEBUG] Processing pair (0,1): N=844, M=470
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -107.667358
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=844) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 237443.015625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=470) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73633.789062
[LAV DEBUG]   Pair loss = -107.6674 + 0.01 * (237443.0156 + 73633.7891) = 3003.1006
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.80GB

[LAV DEBUG] Processing pair (1,0): N=470, M=844
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -107.667358
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=470) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73633.789062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=844) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 237443.015625
[LAV DEBUG]   Pair loss = -107.6674 + 0.01 * (73633.7891 + 237443.0156) = 3003.1006
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.00GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6006.2012
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.00GB | Reserved: 5.40GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.00GB | Reserved: 5.40GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.97GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.97GB | Peak: 19.34GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.34GB | Reserved: 2.65GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([237, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.34GB, Reserved: 2.65GB

[LAV DEBUG] Processing pair (0,1): N=237, M=341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.098228
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=237) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18724.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38761.273438
[LAV DEBUG]   Pair loss = -49.0982 + 0.01 * (18724.4375 + 38761.2734) = 525.7589
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.38GB

[LAV DEBUG] Processing pair (1,0): N=341, M=237
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.098228
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38761.273438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=237) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18724.437500
[LAV DEBUG]   Pair loss = -49.0982 + 0.01 * (38761.2734 + 18724.4375) = 525.7589
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.42GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1051.5178
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.42GB | Reserved: 2.58GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.42GB | Reserved: 2.58GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.96GB | Peak: 19.34GB
[2026-02-01 13:35:11,087 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: Pizza.cmu
[2026-02-01 13:35:11,360 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [756, 381]
[2026-02-01 13:35:17,568 - INFO - alignment_training_loop.py:353] - [BATCH 58] Loss value: 4596.3208
[2026-02-01 13:35:25,849 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Brownie.cmu
[2026-02-01 13:35:26,092 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [528, 494]
[2026-02-01 13:35:31,780 - INFO - alignment_training_loop.py:353] - [BATCH 59] Loss value: 3306.5276
[2026-02-01 13:35:39,213 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: Eggs.cmu
[2026-02-01 13:35:39,364 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [282, 325]
[2026-02-01 13:35:42,798 - INFO - alignment_training_loop.py:353] - [BATCH 60] Loss value: 1128.8429
[2026-02-01 13:35:47,209 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: tent
[2026-02-01 13:35:47,424 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: ContinentalBreakfast.egtea
[2026-02-01 13:35:47,989 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [1343, 1167]
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.96GB | Peak: 19.34GB
[MEM Batch 58 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.07GB | Reserved: 4.48GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([756, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([381, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.07GB, Reserved: 4.48GB

[LAV DEBUG] Processing pair (0,1): N=756, M=381
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.821442
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=756) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 190510.390625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=381) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48387.800781
[LAV DEBUG]   Pair loss = -90.8214 + 0.01 * (190510.3906 + 48387.8008) = 2298.1604
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.21GB

[LAV DEBUG] Processing pair (1,0): N=381, M=756
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.821442
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=381) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 48387.800781
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=756) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 190510.390625
[LAV DEBUG]   Pair loss = -90.8214 + 0.01 * (48387.8008 + 190510.3906) = 2298.1604
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.35GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4596.3208
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 4.35GB | Reserved: 4.65GB | Peak: 19.34GB
[MEM Before backward] Allocated: 4.35GB | Reserved: 4.65GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.07GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.07GB | Peak: 19.34GB
[MEM Batch 59 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.71GB | Reserved: 4.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([528, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([494, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.71GB, Reserved: 4.08GB

[LAV DEBUG] Processing pair (0,1): N=528, M=494
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -89.452515
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=528) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 92928.101562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=494) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 81343.539062
[LAV DEBUG]   Pair loss = -89.4525 + 0.01 * (92928.1016 + 81343.5391) = 1653.2638
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.84GB

[LAV DEBUG] Processing pair (1,0): N=494, M=528
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -89.452515
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=494) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 81343.539062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=528) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 92928.101562
[LAV DEBUG]   Pair loss = -89.4525 + 0.01 * (81343.5391 + 92928.1016) = 1653.2638
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.97GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3306.5276
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 3.97GB | Reserved: 4.23GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.97GB | Reserved: 4.23GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.61GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.61GB | Peak: 19.34GB
[MEM Batch 60 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.43GB | Reserved: 2.73GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([282, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([325, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.43GB, Reserved: 2.73GB

[LAV DEBUG] Processing pair (0,1): N=282, M=325
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.765751
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=282) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 26509.347656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=325) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35209.375000
[LAV DEBUG]   Pair loss = -52.7658 + 0.01 * (26509.3477 + 35209.3750) = 564.4214
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.48GB

[LAV DEBUG] Processing pair (1,0): N=325, M=282
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.765751
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=325) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35209.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=282) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 26509.347656
[LAV DEBUG]   Pair loss = -52.7658 + 0.01 * (35209.3750 + 26509.3477) = 564.4214
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.52GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1128.8429
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.52GB | Reserved: 2.67GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.52GB | Reserved: 2.67GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.07GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.07GB | Peak: 19.34GB
[MEM Batch 61 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM Batch 62 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 8.31GB | Reserved: 8.93GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1343, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1167, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 8.31GB, Reserved: 8.93GB

[LAV DEBUG] Processing pair (0,1): N=1343, M=1167
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -219.762573
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1343) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 601205.812500
[2026-02-01 13:36:01,603 - INFO - alignment_training_loop.py:353] - [BATCH 62] Loss value: 20663.6895
[2026-02-01 13:36:20,187 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: Eggs.cmu
[2026-02-01 13:36:20,387 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [466, 349]
[2026-02-01 13:36:24,997 - INFO - alignment_training_loop.py:353] - [BATCH 63] Loss value: 2119.5244
[2026-02-01 13:36:30,933 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: pc_assembly
[2026-02-01 13:36:31,196 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [513, 574]
[2026-02-01 13:36:37,240 - INFO - alignment_training_loop.py:353] - [BATCH 64] Loss value: 3760.9297
[2026-02-01 13:36:45,133 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: pc_assembly
[2026-02-01 13:36:45,403 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [656, 536]
[2026-02-01 13:36:51,925 - INFO - alignment_training_loop.py:353] - [BATCH 65] Loss value: 4576.8989
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1167) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 453954.875000
[LAV DEBUG]   Pair loss = -219.7626 + 0.01 * (601205.8125 + 453954.8750) = 10331.8447
[LAV DEBUG]   Pair (0,1) completed in 0.14s
[LAV DEBUG]   GPU Memory after pair: 9.06GB

[LAV DEBUG] Processing pair (1,0): N=1167, M=1343
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -219.762573
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1167) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 453954.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1343) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 601205.812500
[LAV DEBUG]   Pair loss = -219.7626 + 0.01 * (453954.8750 + 601205.8125) = 10331.8447
[LAV DEBUG]   Pair (1,0) completed in 0.13s
[LAV DEBUG]   GPU Memory after pair: 9.82GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 20663.6895
[LAV DEBUG] Total time: 0.51s
[LAV DEBUG] Avg time per pair: 0.25s
============================================================

[MEM After loss computation] Allocated: 9.82GB | Reserved: 10.44GB | Peak: 19.34GB
[MEM Before backward] Allocated: 9.82GB | Reserved: 10.44GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 12.71GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 12.71GB | Peak: 19.34GB
[MEM Batch 63 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.07GB | Reserved: 3.37GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([466, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([349, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.07GB, Reserved: 3.37GB

[LAV DEBUG] Processing pair (0,1): N=466, M=349
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -70.107796
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=466) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 72385.710938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=349) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 40601.285156
[LAV DEBUG]   Pair loss = -70.1078 + 0.01 * (72385.7109 + 40601.2852) = 1059.7622
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.15GB

[LAV DEBUG] Processing pair (1,0): N=349, M=466
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -70.107796
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=349) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 40601.285156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=466) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 72385.710938
[LAV DEBUG]   Pair loss = -70.1078 + 0.01 * (40601.2852 + 72385.7109) = 1059.7622
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.23GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2119.5244
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.23GB | Reserved: 3.44GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.23GB | Reserved: 3.44GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.79GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.79GB | Peak: 19.34GB
[MEM Batch 64 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.92GB | Reserved: 4.24GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([513, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([574, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.92GB, Reserved: 4.24GB

[LAV DEBUG] Processing pair (0,1): N=513, M=574
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -95.016037
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=513) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 87723.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=574) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 109825.015625
[LAV DEBUG]   Pair loss = -95.0160 + 0.01 * (87723.0781 + 109825.0156) = 1880.4648
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.06GB

[LAV DEBUG] Processing pair (1,0): N=574, M=513
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -95.016037
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=574) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 109825.015625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=513) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 87723.078125
[LAV DEBUG]   Pair loss = -95.0160 + 0.01 * (109825.0156 + 87723.0781) = 1880.4648
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.20GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3760.9297
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.20GB | Reserved: 4.52GB | Peak: 19.34GB
[MEM Before backward] Allocated: 4.20GB | Reserved: 4.52GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.94GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.94GB | Peak: 19.34GB
[MEM Batch 65 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.24GB | Reserved: 4.60GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([656, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([536, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.24GB, Reserved: 4.60GB

[LAV DEBUG] Processing pair (0,1): N=656, M=536
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -103.652344
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=656) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 143444.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=536) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 95765.507812
[LAV DEBUG]   Pair loss = -103.6523 + 0.01 * (143444.6875 + 95765.5078) = 2288.4495
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.41GB

[LAV DEBUG] Processing pair (1,0): N=536, M=656
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -103.652344
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=536) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 95765.507812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=656) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 143444.687500
[LAV DEBUG]   Pair loss = -103.6523 + 0.01 * (95765.5078 + 143444.6875) = 2288.4495
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4576.8989
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 4.58GB | Reserved: 4.94GB | Peak: 19.34GB
[2026-02-01 13:37:00,661 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Salad.cmu
[2026-02-01 13:37:00,802 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [273, 279]
[2026-02-01 13:37:03,996 - INFO - alignment_training_loop.py:353] - [BATCH 66] Loss value: 919.5853
[2026-02-01 13:37:08,007 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Pizza.egtea
[2026-02-01 13:37:08,344 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [747, 693]
[2026-02-01 13:37:16,212 - INFO - alignment_training_loop.py:353] - [BATCH 67] Loss value: 6669.2427
[2026-02-01 13:37:26,691 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: ContinentalBreakfast.egtea
[2026-02-01 13:37:26,903 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [436, 469]
[2026-02-01 13:37:31,881 - INFO - alignment_training_loop.py:353] - [BATCH 68] Loss value: 2575.4509
[2026-02-01 13:37:38,471 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: Eggs.cmu
[2026-02-01 13:37:38,599 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [181, 347]
[MEM Before backward] Allocated: 4.58GB | Reserved: 4.94GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.44GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.44GB | Peak: 19.34GB
[MEM Batch 66 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.26GB | Reserved: 2.59GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([279, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.26GB, Reserved: 2.59GB

[LAV DEBUG] Processing pair (0,1): N=273, M=279
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.134300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24844.341797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=279) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 25948.353516
[LAV DEBUG]   Pair loss = -48.1343 + 0.01 * (24844.3418 + 25948.3535) = 459.7926
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.30GB

[LAV DEBUG] Processing pair (1,0): N=279, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.134300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=279) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 25948.353516
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24844.341797
[LAV DEBUG]   Pair loss = -48.1343 + 0.01 * (25948.3535 + 24844.3418) = 459.7926
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.34GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 919.5853
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.86GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.86GB | Peak: 19.34GB
[MEM Batch 67 START - Task Pizza.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.00GB | Reserved: 5.44GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([747, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([693, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.00GB, Reserved: 5.44GB

[LAV DEBUG] Processing pair (0,1): N=747, M=693
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -126.213531
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=747) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 186001.609375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=693) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 160081.875000
[LAV DEBUG]   Pair loss = -126.2135 + 0.01 * (186001.6094 + 160081.8750) = 3334.6213
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.25GB

[LAV DEBUG] Processing pair (1,0): N=693, M=747
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -126.213531
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=693) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160081.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=747) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 186001.609375
[LAV DEBUG]   Pair loss = -126.2135 + 0.01 * (160081.8750 + 186001.6094) = 3334.6213
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.51GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6669.2427
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.51GB | Reserved: 5.94GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.50GB | Reserved: 5.94GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.68GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.68GB | Peak: 19.34GB
[MEM Batch 68 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.35GB | Reserved: 3.70GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([436, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([469, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.35GB, Reserved: 3.70GB

[LAV DEBUG] Processing pair (0,1): N=436, M=469
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.141411
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=436) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 63365.937500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=469) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73320.750000
[LAV DEBUG]   Pair loss = -79.1414 + 0.01 * (63365.9375 + 73320.7500) = 1287.7255
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.45GB

[LAV DEBUG] Processing pair (1,0): N=469, M=436
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.141411
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=469) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73320.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=436) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 63365.937500
[LAV DEBUG]   Pair loss = -79.1414 + 0.01 * (73320.7500 + 63365.9375) = 1287.7255
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2575.4509
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.55GB | Reserved: 3.78GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.55GB | Reserved: 3.78GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.29GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.29GB | Peak: 19.34GB
[MEM Batch 69 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.19GB | Reserved: 2.42GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([181, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([347, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.19GB, Reserved: 2.42GB

[LAV DEBUG] Processing pair (0,1): N=181, M=347
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.293365
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=181) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10921.856445
[2026-02-01 13:37:41,601 - INFO - alignment_training_loop.py:353] - [BATCH 69] Loss value: 936.5966
[2026-02-01 13:37:45,448 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: meccano
[2026-02-01 13:37:45,835 - INFO - alignment_training_loop.py:286] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [845, 875]
[2026-02-01 13:37:55,154 - INFO - alignment_training_loop.py:353] - [BATCH 70] Loss value: 9562.2510
[2026-02-01 13:38:07,772 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: TurkeySandwich.egtea
[2026-02-01 13:38:08,132 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [1109, 502]
[2026-02-01 13:38:16,915 - INFO - alignment_training_loop.py:353] - [BATCH 71] Loss value: 9629.0293
[2026-02-01 13:38:28,659 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Brownie.cmu
[2026-02-01 13:38:28,887 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [491, 431]
[2026-02-01 13:38:34,005 - INFO - alignment_training_loop.py:353] - [BATCH 72] Loss value: 2684.7390
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=347) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 40137.308594
[LAV DEBUG]   Pair loss = -42.2934 + 0.01 * (10921.8564 + 40137.3086) = 468.2983
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.22GB

[LAV DEBUG] Processing pair (1,0): N=347, M=181
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.293365
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=347) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 40137.308594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=181) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10921.856445
[LAV DEBUG]   Pair loss = -42.2934 + 0.01 * (40137.3086 + 10921.8564) = 468.2983
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.25GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 936.5966
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.25GB | Reserved: 2.38GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.25GB | Reserved: 2.38GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.79GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.79GB | Peak: 19.34GB
[MEM Batch 70 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.86GB | Reserved: 6.35GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([845, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.86GB, Reserved: 6.35GB

[LAV DEBUG] Processing pair (0,1): N=845, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -150.989410
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=845) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 238005.921875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255205.562500
[LAV DEBUG]   Pair loss = -150.9894 + 0.01 * (238005.9219 + 255205.5625) = 4781.1255
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 6.22GB

[LAV DEBUG] Processing pair (1,0): N=875, M=845
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -150.989410
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255205.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=845) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 238005.921875
[LAV DEBUG]   Pair loss = -150.9894 + 0.01 * (255205.5625 + 238005.9219) = 4781.1255
[LAV DEBUG]   Pair (1,0) completed in 0.07s
[LAV DEBUG]   GPU Memory after pair: 6.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 9562.2510
[LAV DEBUG] Total time: 0.37s
[LAV DEBUG] Avg time per pair: 0.18s
============================================================

[MEM After loss computation] Allocated: 6.58GB | Reserved: 7.05GB | Peak: 19.34GB
[MEM Before backward] Allocated: 6.58GB | Reserved: 7.05GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.12GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 8.12GB | Peak: 19.34GB
[MEM Batch 71 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.53GB | Reserved: 5.99GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1109, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([502, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.53GB, Reserved: 5.99GB

[LAV DEBUG] Processing pair (0,1): N=1109, M=502
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -125.025436
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 409952.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=502) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 84001.578125
[LAV DEBUG]   Pair loss = -125.0254 + 0.01 * (409952.4375 + 84001.5781) = 4814.5146
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 5.80GB

[LAV DEBUG] Processing pair (1,0): N=502, M=1109
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -125.025436
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=502) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 84001.578125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 409952.437500
[LAV DEBUG]   Pair loss = -125.0254 + 0.01 * (84001.5781 + 409952.4375) = 4814.5146
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 6.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 9629.0293
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 6.07GB | Reserved: 6.52GB | Peak: 19.34GB
[MEM Before backward] Allocated: 6.07GB | Reserved: 6.52GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.32GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 7.32GB | Peak: 19.34GB
[MEM Batch 72 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.41GB | Reserved: 3.74GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([491, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([431, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.41GB, Reserved: 3.74GB

[LAV DEBUG] Processing pair (0,1): N=491, M=431
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.447441
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=491) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 80360.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=431) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61921.007812
[LAV DEBUG]   Pair loss = -80.4474 + 0.01 * (80360.6875 + 61921.0078) = 1342.3695
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.51GB

[LAV DEBUG] Processing pair (1,0): N=431, M=491
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.447441
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=431) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61921.007812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=491) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 80360.687500
[LAV DEBUG]   Pair loss = -80.4474 + 0.01 * (61921.0078 + 80360.6875) = 1342.3695
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.61GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2684.7390
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.61GB | Reserved: 3.84GB | Peak: 19.34GB
[2026-02-01 13:38:40,760 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Eggs.cmu
[2026-02-01 13:38:40,915 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [292, 339]
[2026-02-01 13:38:44,487 - INFO - alignment_training_loop.py:353] - [BATCH 73] Loss value: 1224.9175
[2026-02-01 13:38:49,065 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: pc_disassembly
[2026-02-01 13:38:49,222 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [324, 314]
[2026-02-01 13:38:52,810 - INFO - alignment_training_loop.py:353] - [BATCH 74] Loss value: 1245.7908
[2026-02-01 13:38:57,457 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: GreekSalad.egtea
[2026-02-01 13:38:57,766 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [850, 484]
[2026-02-01 13:39:05,016 - INFO - alignment_training_loop.py:353] - [BATCH 75] Loss value: 6158.6060
[2026-02-01 13:39:14,822 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: BaconAndEggs.egtea
[2026-02-01 13:39:15,208 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [826, 856]
[MEM Before backward] Allocated: 3.61GB | Reserved: 3.84GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.35GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.35GB | Peak: 19.34GB
[MEM Batch 73 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.51GB | Reserved: 2.79GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([292, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([339, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.51GB, Reserved: 2.79GB

[LAV DEBUG] Processing pair (0,1): N=292, M=339
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -54.846878
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=292) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28422.527344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=339) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38308.035156
[LAV DEBUG]   Pair loss = -54.8469 + 0.01 * (28422.5273 + 38308.0352) = 612.4587
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.56GB

[LAV DEBUG] Processing pair (1,0): N=339, M=292
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -54.846878
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=339) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38308.035156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=292) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28422.527344
[LAV DEBUG]   Pair loss = -54.8469 + 0.01 * (38308.0352 + 28422.5273) = 612.4587
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.61GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1224.9175
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.61GB | Reserved: 2.78GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.60GB | Reserved: 2.78GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.25GB | Peak: 19.34GB
[MEM Batch 74 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.53GB | Reserved: 2.81GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([324, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([314, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.53GB, Reserved: 2.81GB

[LAV DEBUG] Processing pair (0,1): N=324, M=314
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.700371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=324) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 34993.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=314) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32866.457031
[LAV DEBUG]   Pair loss = -55.7004 + 0.01 * (34993.1250 + 32866.4570) = 622.8954
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.58GB

[LAV DEBUG] Processing pair (1,0): N=314, M=324
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.700371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=314) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32866.457031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=324) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 34993.125000
[LAV DEBUG]   Pair loss = -55.7004 + 0.01 * (32866.4570 + 34993.1250) = 622.8954
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.63GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1245.7908
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.63GB | Reserved: 2.80GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.63GB | Reserved: 2.80GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.27GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.27GB | Peak: 19.34GB
[MEM Batch 75 START - Task GreekSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.67GB | Reserved: 5.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([850, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([484, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.67GB, Reserved: 5.08GB

[LAV DEBUG] Processing pair (0,1): N=850, M=484
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -109.863388
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=850) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 240830.921875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=484) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 78085.718750
[LAV DEBUG]   Pair loss = -109.8634 + 0.01 * (240830.9219 + 78085.7188) = 3079.3030
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.87GB

[LAV DEBUG] Processing pair (1,0): N=484, M=850
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -109.863388
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=484) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 78085.718750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=850) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 240830.921875
[LAV DEBUG]   Pair loss = -109.8634 + 0.01 * (78085.7188 + 240830.9219) = 3079.3030
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6158.6060
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.07GB | Reserved: 5.48GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.07GB | Reserved: 5.48GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.07GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.07GB | Peak: 19.34GB
[MEM Batch 76 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.75GB | Reserved: 6.16GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([826, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([856, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.75GB, Reserved: 6.16GB

[LAV DEBUG] Processing pair (0,1): N=826, M=856
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -147.640472
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=826) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 227423.156250
[2026-02-01 13:39:24,333 - INFO - alignment_training_loop.py:353] - [BATCH 76] Loss value: 9138.0400
[2026-02-01 13:39:36,684 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: pc_assembly
[2026-02-01 13:39:37,002 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [656, 757]
[2026-02-01 13:39:44,706 - INFO - alignment_training_loop.py:353] - [BATCH 77] Loss value: 6442.2612
[2026-02-01 13:39:54,990 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: Brownie.cmu
[2026-02-01 13:39:55,169 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [359, 406]
[2026-02-01 13:39:59,418 - INFO - alignment_training_loop.py:353] - [BATCH 78] Loss value: 1824.7660
[2026-02-01 13:40:05,001 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: BaconAndEggs.egtea
[2026-02-01 13:40:05,665 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [1070, 1825]
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=856) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 244242.906250
[LAV DEBUG]   Pair loss = -147.6405 + 0.01 * (227423.1562 + 244242.9062) = 4569.0200
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 6.09GB

[LAV DEBUG] Processing pair (1,0): N=856, M=826
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -147.640472
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=856) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 244242.906250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=826) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 227423.156250
[LAV DEBUG]   Pair loss = -147.6405 + 0.01 * (244242.9062 + 227423.1562) = 4569.0200
[LAV DEBUG]   Pair (1,0) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 6.43GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 9138.0400
[LAV DEBUG] Total time: 0.39s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 6.43GB | Reserved: 7.16GB | Peak: 19.34GB
[MEM Before backward] Allocated: 6.43GB | Reserved: 7.16GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.17GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 8.17GB | Peak: 19.34GB
[MEM Batch 77 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.92GB | Reserved: 5.37GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([656, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([757, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.92GB, Reserved: 5.37GB

[LAV DEBUG] Processing pair (0,1): N=656, M=757
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -123.466911
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=656) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 143444.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=757) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 191015.015625
[LAV DEBUG]   Pair loss = -123.4669 + 0.01 * (143444.7500 + 191015.0156) = 3221.1306
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.16GB

[LAV DEBUG] Processing pair (1,0): N=757, M=656
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -123.466911
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=757) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 191015.015625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=656) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 143444.750000
[LAV DEBUG]   Pair loss = -123.4669 + 0.01 * (191015.0156 + 143444.7500) = 3221.1306
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.40GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6442.2612
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 5.40GB | Reserved: 5.74GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.40GB | Reserved: 5.74GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.46GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.46GB | Peak: 19.34GB
[MEM Batch 78 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.92GB | Reserved: 3.24GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([359, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([406, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.92GB, Reserved: 3.24GB

[LAV DEBUG] Processing pair (0,1): N=359, M=406
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.691216
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=359) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 42961.304688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=406) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54946.113281
[LAV DEBUG]   Pair loss = -66.6912 + 0.01 * (42961.3047 + 54946.1133) = 912.3830
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.99GB

[LAV DEBUG] Processing pair (1,0): N=406, M=359
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.691216
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=406) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54946.113281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=359) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 42961.304688
[LAV DEBUG]   Pair loss = -66.6912 + 0.01 * (54946.1133 + 42961.3047) = 912.3830
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.06GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1824.7660
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 3.06GB | Reserved: 3.28GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.06GB | Reserved: 3.28GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.70GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.70GB | Peak: 19.34GB
[MEM Batch 79 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 9.49GB | Reserved: 10.22GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1070, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1825, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.49GB, Reserved: 10.22GB

[LAV DEBUG] Processing pair (0,1): N=1070, M=1825
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -240.549561
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 381628.781250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1825) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1110192.250000
[LAV DEBUG]   Pair loss = -240.5496 + 0.01 * (381628.7812 + 1110192.2500) = 14677.6602
[LAV DEBUG]   Pair (0,1) completed in 0.16s
[LAV DEBUG]   GPU Memory after pair: 10.43GB

[LAV DEBUG] Processing pair (1,0): N=1825, M=1070
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -240.549561
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1825) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1110192.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 381628.781250
[LAV DEBUG]   Pair loss = -240.5496 + 0.01 * (1110192.2500 + 381628.7812) = 14677.6602
[LAV DEBUG]   Pair (1,0) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 11.38GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 29355.3203
[LAV DEBUG] Total time: 0.56s
[LAV DEBUG] Avg time per pair: 0.28s
============================================================

[2026-02-01 13:40:21,324 - INFO - alignment_training_loop.py:353] - [BATCH 79] Loss value: 29355.3203
[2026-02-01 13:40:42,784 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: Pizza.cmu
[2026-02-01 13:40:43,023 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [762, 236]
[2026-02-01 13:40:48,497 - INFO - alignment_training_loop.py:353] - [BATCH 80] Loss value: 4107.7983
[2026-02-01 13:40:55,783 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: Salad.cmu
[2026-02-01 13:40:55,923 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [130, 423]
[2026-02-01 13:40:59,107 - INFO - alignment_training_loop.py:353] - [BATCH 81] Loss value: 1231.7567
[2026-02-01 13:41:03,107 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Sandwich.cmu
[2026-02-01 13:41:03,215 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [238, 189]
[2026-02-01 13:41:05,702 - INFO - alignment_training_loop.py:353] - [BATCH 82] Loss value: 542.3564
[2026-02-01 13:41:08,803 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Brownie.cmu
[2026-02-01 13:41:08,965 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [294, 373]
[MEM After loss computation] Allocated: 11.38GB | Reserved: 13.00GB | Peak: 19.34GB
[MEM Before backward] Allocated: 11.38GB | Reserved: 13.00GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 15.79GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 15.79GB | Peak: 19.34GB
[MEM Batch 80 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.64GB | Reserved: 4.01GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([762, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.64GB, Reserved: 4.01GB

[LAV DEBUG] Processing pair (0,1): N=762, M=236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.234634
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=762) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 193546.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18566.791016
[LAV DEBUG]   Pair loss = -67.2346 + 0.01 * (193546.5938 + 18566.7910) = 2053.8992
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.73GB

[LAV DEBUG] Processing pair (1,0): N=236, M=762
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.234634
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18566.791016
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=762) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 193546.593750
[LAV DEBUG]   Pair loss = -67.2346 + 0.01 * (18566.7910 + 193546.5938) = 2053.8992
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.81GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4107.7983
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.81GB | Reserved: 4.08GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.81GB | Reserved: 4.08GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.55GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.55GB | Peak: 19.34GB
[MEM Batch 81 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.27GB | Reserved: 2.59GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([423, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.27GB, Reserved: 2.59GB

[LAV DEBUG] Processing pair (0,1): N=130, M=423
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.908001
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.930176
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=423) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59643.710938
[LAV DEBUG]   Pair loss = -36.9080 + 0.01 * (5634.9302 + 59643.7109) = 615.8784
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.30GB

[LAV DEBUG] Processing pair (1,0): N=423, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.908001
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=423) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59643.710938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.930176
[LAV DEBUG]   Pair loss = -36.9080 + 0.01 * (59643.7109 + 5634.9302) = 615.8784
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.32GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1231.7567
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.32GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.32GB | Reserved: 2.48GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.80GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.80GB | Peak: 19.34GB
[MEM Batch 82 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.88GB | Reserved: 2.16GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([238, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([189, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.88GB, Reserved: 2.16GB

[LAV DEBUG] Processing pair (0,1): N=238, M=189
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.735325
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=238) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18882.820312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=189) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11908.532227
[LAV DEBUG]   Pair loss = -36.7353 + 0.01 * (18882.8203 + 11908.5322) = 271.1782
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.90GB

[LAV DEBUG] Processing pair (1,0): N=189, M=238
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.735325
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=189) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11908.532227
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=238) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18882.820312
[LAV DEBUG]   Pair loss = -36.7353 + 0.01 * (11908.5322 + 18882.8203) = 271.1782
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.92GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 542.3564
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.92GB | Reserved: 2.05GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.92GB | Reserved: 2.05GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.36GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.36GB | Peak: 19.34GB
[MEM Batch 83 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.62GB | Reserved: 2.89GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([294, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([373, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.62GB, Reserved: 2.89GB

[LAV DEBUG] Processing pair (0,1): N=294, M=373
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -57.601479
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=294) [no_grad]...
[2026-02-01 13:41:12,694 - INFO - alignment_training_loop.py:353] - [BATCH 83] Loss value: 1388.6051
[2026-02-01 13:41:17,530 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: meccano
[2026-02-01 13:41:18,047 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [1438, 838]
[2026-02-01 13:41:30,404 - INFO - alignment_training_loop.py:353] - [BATCH 84] Loss value: 18089.5137
[2026-02-01 13:41:47,303 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Cheeseburger.egtea
[2026-02-01 13:41:47,633 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [680, 670]
[2026-02-01 13:41:54,885 - INFO - alignment_training_loop.py:353] - [BATCH 85] Loss value: 5838.4561
[2026-02-01 13:42:04,664 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: Eggs.cmu
[2026-02-01 13:42:04,789 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [264, 222]
[LAV DEBUG]   IntraContrast v1 result: 28813.207031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=373) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 46377.195312
[LAV DEBUG]   Pair loss = -57.6015 + 0.01 * (28813.2070 + 46377.1953) = 694.3026
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.67GB

[LAV DEBUG] Processing pair (1,0): N=373, M=294
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -57.601479
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=373) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 46377.195312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=294) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28813.207031
[LAV DEBUG]   Pair loss = -57.6015 + 0.01 * (46377.1953 + 28813.2070) = 694.3026
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.73GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1388.6051
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.73GB | Reserved: 2.89GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.73GB | Reserved: 2.89GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.31GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.31GB | Peak: 19.34GB
[MEM Batch 84 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 7.58GB | Reserved: 8.17GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([838, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.58GB, Reserved: 8.17GB

[LAV DEBUG] Processing pair (0,1): N=1438, M=838
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -188.757629
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 689272.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=838) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234079.234375
[LAV DEBUG]   Pair loss = -188.7576 + 0.01 * (689272.2500 + 234079.2344) = 9044.7568
[LAV DEBUG]   Pair (0,1) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 8.16GB

[LAV DEBUG] Processing pair (1,0): N=838, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -188.757629
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=838) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234079.234375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 689272.250000
[LAV DEBUG]   Pair loss = -188.7576 + 0.01 * (234079.2344 + 689272.2500) = 9044.7568
[LAV DEBUG]   Pair (1,0) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 8.74GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 18089.5137
[LAV DEBUG] Total time: 0.46s
[LAV DEBUG] Avg time per pair: 0.23s
============================================================

[MEM After loss computation] Allocated: 8.74GB | Reserved: 9.32GB | Peak: 19.34GB
[MEM Before backward] Allocated: 8.74GB | Reserved: 9.32GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 11.05GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 11.05GB | Peak: 19.34GB
[MEM Batch 85 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.72GB | Reserved: 5.10GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([680, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([670, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.72GB, Reserved: 5.10GB

[LAV DEBUG] Processing pair (0,1): N=680, M=670
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.422493
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=680) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 154132.515625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=670) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 149632.546875
[LAV DEBUG]   Pair loss = -118.4225 + 0.01 * (154132.5156 + 149632.5469) = 2919.2280
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.94GB

[LAV DEBUG] Processing pair (1,0): N=670, M=680
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.422493
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=670) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 149632.546875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=680) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 154132.515625
[LAV DEBUG]   Pair loss = -118.4225 + 0.01 * (149632.5469 + 154132.5156) = 2919.2280
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.16GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5838.4561
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.16GB | Reserved: 5.54GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.16GB | Reserved: 5.54GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.20GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.20GB | Peak: 19.34GB
[MEM Batch 86 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.06GB | Reserved: 2.31GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([222, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.06GB, Reserved: 2.31GB

[LAV DEBUG] Processing pair (0,1): N=264, M=222
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.070713
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 23233.429688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=222) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16429.496094
[LAV DEBUG]   Pair loss = -42.0707 + 0.01 * (23233.4297 + 16429.4961) = 354.5585
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.09GB

[LAV DEBUG] Processing pair (1,0): N=222, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.070713
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=222) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16429.496094
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 23233.429688
[LAV DEBUG]   Pair loss = -42.0707 + 0.01 * (16429.4961 + 23233.4297) = 354.5585
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.12GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 709.1171
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[2026-02-01 13:42:07,559 - INFO - alignment_training_loop.py:353] - [BATCH 86] Loss value: 709.1171
[2026-02-01 13:42:11,096 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: BaconAndEggs.egtea
[2026-02-01 13:42:11,910 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [1835, 1727]
[2026-02-01 13:42:31,337 - INFO - alignment_training_loop.py:353] - [BATCH 87] Loss value: 41704.8633
[2026-02-01 13:42:57,929 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: Brownie.cmu
[2026-02-01 13:42:58,169 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [335, 689]
[2026-02-01 13:43:03,777 - INFO - alignment_training_loop.py:353] - [BATCH 88] Loss value: 3751.0811
[2026-02-01 13:43:11,182 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: Eggs.cmu
[2026-02-01 13:43:11,293 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [202, 229]
[2026-02-01 13:43:13,802 - INFO - alignment_training_loop.py:353] - [BATCH 89] Loss value: 546.9600
[2026-02-01 13:43:16,921 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: GreekSalad.egtea
[2026-02-01 13:43:17,198 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [808, 364]
[MEM After loss computation] Allocated: 2.12GB | Reserved: 2.23GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.12GB | Reserved: 2.23GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.64GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.64GB | Peak: 19.34GB
[MEM Batch 87 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 11.54GB | Reserved: 12.46GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1835, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1727, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.54GB, Reserved: 12.46GB

[LAV DEBUG] Processing pair (0,1): N=1835, M=1727
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -313.107391
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1835) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1122392.000000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1727) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 994162.125000
[LAV DEBUG]   Pair loss = -313.1074 + 0.01 * (1122392.0000 + 994162.1250) = 20852.4316
[LAV DEBUG]   Pair (0,1) completed in 0.26s
[LAV DEBUG]   GPU Memory after pair: 13.07GB

[LAV DEBUG] Processing pair (1,0): N=1727, M=1835
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -313.107391
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1727) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 994162.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1835) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1122392.000000
[LAV DEBUG]   Pair loss = -313.1074 + 0.01 * (994162.1250 + 1122392.0000) = 20852.4316
[LAV DEBUG]   Pair (1,0) completed in 0.25s
[LAV DEBUG]   GPU Memory after pair: 14.61GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 41704.8633
[LAV DEBUG] Total time: 0.75s
[LAV DEBUG] Avg time per pair: 0.37s
============================================================

[MEM After loss computation] Allocated: 14.61GB | Reserved: 16.97GB | Peak: 19.34GB
[MEM Before backward] Allocated: 14.61GB | Reserved: 16.97GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 21.51GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 21.51GB | Peak: 19.34GB
[MEM Batch 88 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.72GB | Reserved: 4.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([335, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([689, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.72GB, Reserved: 4.08GB

[LAV DEBUG] Processing pair (0,1): N=335, M=689
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.949997
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=335) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 37409.433594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=689) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 158239.609375
[LAV DEBUG]   Pair loss = -80.9500 + 0.01 * (37409.4336 + 158239.6094) = 1875.5405
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.83GB

[LAV DEBUG] Processing pair (1,0): N=689, M=335
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.949997
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=689) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 158239.609375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=335) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 37409.433594
[LAV DEBUG]   Pair loss = -80.9500 + 0.01 * (158239.6094 + 37409.4336) = 1875.5405
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3751.0811
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.94GB | Reserved: 4.20GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.94GB | Reserved: 4.20GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.54GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.54GB | Peak: 19.34GB
[MEM Batch 89 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.89GB | Reserved: 2.17GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.89GB, Reserved: 2.17GB

[LAV DEBUG] Processing pair (0,1): N=202, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.366695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.851562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17481.818359
[LAV DEBUG]   Pair loss = -37.3667 + 0.01 * (13602.8516 + 17481.8184) = 273.4800
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.91GB

[LAV DEBUG] Processing pair (1,0): N=229, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.366695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17481.818359
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.851562
[LAV DEBUG]   Pair loss = -37.3667 + 0.01 * (17481.8184 + 13602.8516) = 273.4800
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 546.9600
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.94GB | Reserved: 2.06GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.94GB | Reserved: 2.06GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.37GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.37GB | Peak: 19.34GB
[MEM Batch 90 START - Task GreekSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 4.17GB | Reserved: 4.57GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([808, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([364, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.17GB, Reserved: 4.57GB

[LAV DEBUG] Processing pair (0,1): N=808, M=364
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.681198
[2026-02-01 13:43:23,602 - INFO - alignment_training_loop.py:353] - [BATCH 90] Loss value: 5054.3564
[2026-02-01 13:43:32,098 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: BaconAndEggs.egtea
[2026-02-01 13:43:32,448 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [718, 776]
[2026-02-01 13:43:40,627 - INFO - alignment_training_loop.py:353] - [BATCH 91] Loss value: 7189.3745
[2026-02-01 13:43:51,507 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: ContinentalBreakfast.egtea
[2026-02-01 13:43:51,725 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [445, 491]
[2026-02-01 13:43:56,914 - INFO - alignment_training_loop.py:353] - [BATCH 92] Loss value: 2763.7964
[2026-02-01 13:44:03,768 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: Sandwich.cmu
[2026-02-01 13:44:03,850 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [145, 133]
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=808) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 217619.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=364) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 44166.320312
[LAV DEBUG]   Pair loss = -90.6812 + 0.01 * (217619.6250 + 44166.3203) = 2527.1782
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.32GB

[LAV DEBUG] Processing pair (1,0): N=364, M=808
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.681198
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=364) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 44166.320312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=808) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 217619.625000
[LAV DEBUG]   Pair loss = -90.6812 + 0.01 * (44166.3203 + 217619.6250) = 2527.1782
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5054.3564
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.46GB | Reserved: 4.74GB | Peak: 19.34GB
[MEM Before backward] Allocated: 4.46GB | Reserved: 4.74GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.16GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.16GB | Peak: 19.34GB
[MEM Batch 91 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 5.17GB | Reserved: 5.57GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([718, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([776, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.17GB, Reserved: 5.57GB

[LAV DEBUG] Processing pair (0,1): N=718, M=776
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.955063
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=718) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 171840.328125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=776) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 200723.906250
[LAV DEBUG]   Pair loss = -130.9551 + 0.01 * (171840.3281 + 200723.9062) = 3594.6873
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.44GB

[LAV DEBUG] Processing pair (1,0): N=776, M=718
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.955063
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=776) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 200723.906250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=718) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 171840.328125
[LAV DEBUG]   Pair loss = -130.9551 + 0.01 * (200723.9062 + 171840.3281) = 3594.6873
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.71GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7189.3745
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 5.71GB | Reserved: 6.11GB | Peak: 19.34GB
[MEM Before backward] Allocated: 5.71GB | Reserved: 6.11GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.91GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.91GB | Peak: 19.34GB
[MEM Batch 92 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 3.45GB | Reserved: 3.78GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([445, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([491, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.45GB, Reserved: 3.78GB

[LAV DEBUG] Processing pair (0,1): N=445, M=491
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.797089
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=445) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 66008.851562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=491) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 80360.679688
[LAV DEBUG]   Pair loss = -81.7971 + 0.01 * (66008.8516 + 80360.6797) = 1381.8982
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.55GB

[LAV DEBUG] Processing pair (1,0): N=491, M=445
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.797089
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=491) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 80360.679688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=445) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 66008.851562
[LAV DEBUG]   Pair loss = -81.7971 + 0.01 * (80360.6797 + 66008.8516) = 1381.8982
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2763.7964
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.66GB | Reserved: 3.88GB | Peak: 19.34GB
[MEM Before backward] Allocated: 3.66GB | Reserved: 3.88GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.20GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.20GB | Peak: 19.34GB
[MEM Batch 93 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 1.42GB | Reserved: 1.69GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.42GB, Reserved: 1.69GB

[LAV DEBUG] Processing pair (0,1): N=145, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.986908
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.933105
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.938965
[LAV DEBUG]   Pair loss = -23.9869 + 0.01 * (7009.9331 + 5897.9390) = 105.0918
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.43GB

[LAV DEBUG] Processing pair (1,0): N=133, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.986908
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.938965
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.933105
[LAV DEBUG]   Pair loss = -23.9869 + 0.01 * (5897.9390 + 7009.9331) = 105.0918
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.44GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 210.1836
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
[2026-02-01 13:44:05,573 - INFO - alignment_training_loop.py:353] - [BATCH 93] Loss value: 210.1836
[2026-02-01 13:44:07,593 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: pc_disassembly
[2026-02-01 13:44:07,763 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [361, 340]
[2026-02-01 13:44:11,668 - INFO - alignment_training_loop.py:353] - [BATCH 94] Loss value: 1517.0835
[2026-02-01 13:44:16,742 - INFO - alignment_training_loop.py:417] - Epoch 1 stats - Total: 95, Successful: 91, Skipped (length): 4, Skipped (exception): 0
[2026-02-01 13:44:17,086 - INFO - alignment_training_loop.py:428] - Epoch [1/50], Loss: 7484.4115 (1390.91s)
[2026-02-01 13:44:22,302 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: PastaSalad.egtea
[2026-02-01 13:44:22,947 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [1497, 1401]
[2026-02-01 13:44:37,757 - INFO - alignment_training_loop.py:353] - [BATCH 0] Loss value: 27515.8164
[2026-02-01 13:44:59,071 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 13:45:00,157 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [2492, 2196]
[2026-02-01 13:45:25,232 - WARNING - alignment_training_loop.py:321] - Skipping batch in task PastaSalad.egtea due to: CUDA out of memory. Tried to allocate 2.61 GiB (GPU 0; 22.16 GiB total capacity; 17.67 GiB already allocated; 598.12 MiB free; 21.35 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2026-02-01 13:45:25,232 - ERROR - alignment_training_loop.py:324] - [OOM in LOSS] Task: PastaSalad.egtea, Sequences: 2, Lengths: [2492, 2196]
[2026-02-01 13:45:25,357 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: tent
[2026-02-01 13:45:25,366 - WARNING - alignment_training_loop.py:280] - Skipping task tent: Sequence length < 2 after preprocessing.
[2026-02-01 13:45:25,366 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Cheeseburger.egtea
[2026-02-01 13:45:25,637 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [470, 670]
[2026-02-01 13:45:28,580 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [470, 670]
[2026-02-01 13:45:28,959 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: meccano
[2026-02-01 13:45:29,671 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [1438, 1410]
[2026-02-01 13:45:32,636 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1438, 1410]
[2026-02-01 13:45:33,090 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: meccano
[2026-02-01 13:45:33,692 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [845, 1598]
[2026-02-01 13:45:36,563 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [845, 1598]
[2026-02-01 13:45:37,001 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: Eggs.cmu
[2026-02-01 13:45:37,183 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [202, 282]
============================================================

[MEM After loss computation] Allocated: 1.44GB | Reserved: 1.58GB | Peak: 19.34GB
[MEM Before backward] Allocated: 1.44GB | Reserved: 1.58GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.85GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.85GB | Peak: 19.34GB
[MEM Batch 94 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 2.72GB | Reserved: 3.08GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([361, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([340, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.72GB, Reserved: 3.08GB

[LAV DEBUG] Processing pair (0,1): N=361, M=340
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -61.214840
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=361) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 43441.289062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=340) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38534.375000
[LAV DEBUG]   Pair loss = -61.2148 + 0.01 * (43441.2891 + 38534.3750) = 758.5417
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.78GB

[LAV DEBUG] Processing pair (1,0): N=340, M=361
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -61.214840
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=340) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38534.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=361) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 43441.289062
[LAV DEBUG]   Pair loss = -61.2148 + 0.01 * (38534.3750 + 43441.2891) = 758.5417
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.84GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1517.0835
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.84GB | Reserved: 3.03GB | Peak: 19.34GB
[MEM Before backward] Allocated: 2.84GB | Reserved: 3.03GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.42GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.42GB | Peak: 19.34GB
[MEM Batch 0 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 9.49GB | Reserved: 10.24GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1401, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.49GB, Reserved: 10.24GB

[LAV DEBUG] Processing pair (0,1): N=1497, M=1401
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -254.601151
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 746992.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 654258.312500
[LAV DEBUG]   Pair loss = -254.6012 + 0.01 * (746992.7500 + 654258.3125) = 13757.9082
[LAV DEBUG]   Pair (0,1) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 10.51GB

[LAV DEBUG] Processing pair (1,0): N=1401, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -254.601151
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 654258.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 746992.750000
[LAV DEBUG]   Pair loss = -254.6012 + 0.01 * (654258.3125 + 746992.7500) = 13757.9082
[LAV DEBUG]   Pair (1,0) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 11.52GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 27515.8164
[LAV DEBUG] Total time: 0.57s
[LAV DEBUG] Avg time per pair: 0.29s
============================================================

[MEM After loss computation] Allocated: 11.52GB | Reserved: 13.24GB | Peak: 19.34GB
[MEM Before backward] Allocated: 11.52GB | Reserved: 13.24GB | Peak: 19.34GB
[MEM After backward] Allocated: 0.74GB | Reserved: 16.24GB | Peak: 19.34GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 16.24GB | Peak: 19.34GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 19.34GB
[MEM After forward pass] Allocated: 15.02GB | Reserved: 16.14GB | Peak: 19.34GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2492, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 15.02GB, Reserved: 16.14GB

[LAV DEBUG] Processing pair (0,1): N=2492, M=2196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -411.245605
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2492) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2069989.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1607448.000000
[LAV DEBUG]   Pair loss = -411.2456 + 0.01 * (2069989.1250 + 1607448.0000) = 36363.1250
[LAV DEBUG]   Pair (0,1) completed in 0.47s
[LAV DEBUG]   GPU Memory after pair: 17.67GB

[LAV DEBUG] Processing pair (1,0): N=2196, M=2492
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.61 GiB (GPU 0; 22.16 GiB total capacity; 17.67 GiB already allocated; 598.12 MiB free; 21.35 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managem
[MEM Batch 2 START - Task tent] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 17.67GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 17.67GB
[MEM Batch 3 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 17.67GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 17.67GB
[MEM Batch 4 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM Batch 5 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.09GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.09GB
[MEM Batch 6 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM After forward pass] Allocated: 19.16GB | Reserved: 21.83GB | Peak: 19.65GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([282, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.16GB, Reserved: 21.83GB

[LAV DEBUG] Processing pair (0,1): N=202, M=282
[2026-02-01 13:45:39,913 - INFO - alignment_training_loop.py:353] - [BATCH 6] Loss value: 719.8209
[2026-02-01 13:45:43,373 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Eggs.cmu
[2026-02-01 13:45:43,590 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [428, 466]
[2026-02-01 13:45:46,524 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [428, 466]
[2026-02-01 13:45:46,926 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: Sandwich.cmu
[2026-02-01 13:45:47,078 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [93, 256]
[2026-02-01 13:45:49,123 - INFO - alignment_training_loop.py:353] - [BATCH 8] Loss value: 445.1265
[2026-02-01 13:45:51,608 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Pizza.cmu
[2026-02-01 13:45:51,910 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [507, 780]
[2026-02-01 13:45:54,916 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [507, 780]
[2026-02-01 13:45:55,296 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Sandwich.cmu
[2026-02-01 13:45:55,441 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [145, 168]
[2026-02-01 13:45:57,265 - INFO - alignment_training_loop.py:353] - [BATCH 10] Loss value: 274.4254
[2026-02-01 13:45:59,502 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: PastaSalad.egtea
[2026-02-01 13:46:00,027 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [543, 1728]
[2026-02-01 13:46:03,101 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [543, 1728]
[2026-02-01 13:46:03,341 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Sandwich.cmu
[2026-02-01 13:46:03,491 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [188, 199]
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.212360
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.863281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=282) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 26509.417969
[LAV DEBUG]   Pair loss = -41.2124 + 0.01 * (13602.8633 + 26509.4180) = 359.9104
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.19GB

[LAV DEBUG] Processing pair (1,0): N=282, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.212360
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=282) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 26509.417969
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.863281
[LAV DEBUG]   Pair loss = -41.2124 + 0.01 * (26509.4180 + 13602.8633) = 359.9104
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.22GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 719.8209
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.22GB | Reserved: 21.83GB | Peak: 19.65GB
[MEM Before backward] Allocated: 19.22GB | Reserved: 21.83GB | Peak: 19.65GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.83GB | Peak: 19.65GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.83GB | Peak: 19.65GB
[MEM Batch 7 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 8 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After forward pass] Allocated: 18.75GB | Reserved: 21.70GB | Peak: 19.68GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.75GB, Reserved: 21.70GB

[LAV DEBUG] Processing pair (0,1): N=93, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.751219
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.637207
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21846.810547
[LAV DEBUG]   Pair loss = -24.7512 + 0.01 * (2884.6372 + 21846.8105) = 222.5632
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.76GB

[LAV DEBUG] Processing pair (1,0): N=256, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.751219
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21846.810547
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.637207
[LAV DEBUG]   Pair loss = -24.7512 + 0.01 * (21846.8105 + 2884.6372) = 222.5632
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.77GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 445.1265
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.77GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM Before backward] Allocated: 18.77GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM Batch 9 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM Batch 10 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.98GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.98GB
[MEM After forward pass] Allocated: 18.63GB | Reserved: 21.65GB | Peak: 19.98GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.63GB, Reserved: 21.65GB

[LAV DEBUG] Processing pair (0,1): N=145, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.982487
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.931641
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.583008
[LAV DEBUG]   Pair loss = -26.9825 + 0.01 * (7009.9316 + 9409.5830) = 137.2127
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.65GB

[LAV DEBUG] Processing pair (1,0): N=168, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.982487
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.583008
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.931641
[LAV DEBUG]   Pair loss = -26.9825 + 0.01 * (9409.5830 + 7009.9316) = 137.2127
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 274.4254
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.66GB | Reserved: 21.65GB | Peak: 19.98GB
[MEM Before backward] Allocated: 18.66GB | Reserved: 21.65GB | Peak: 19.98GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.66GB | Peak: 19.98GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.66GB | Peak: 19.98GB
[MEM Batch 11 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.98GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.98GB
[MEM Batch 12 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.88GB | Peak: 20.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM After forward pass] Allocated: 18.86GB | Reserved: 21.73GB | Peak: 20.59GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.86GB, Reserved: 21.73GB

[LAV DEBUG] Processing pair (0,1): N=188, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -33.591888
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.887695
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13201.877930
[LAV DEBUG]   Pair loss = -33.5919 + 0.01 * (11782.8877 + 13201.8779) = 216.2558
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.88GB

[LAV DEBUG] Processing pair (1,0): N=199, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -33.591888
[2026-02-01 13:46:05,710 - INFO - alignment_training_loop.py:353] - [BATCH 12] Loss value: 432.5115
[2026-02-01 13:46:08,459 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Salad.cmu
[2026-02-01 13:46:08,669 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [523, 300]
[2026-02-01 13:46:11,609 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [523, 300]
[2026-02-01 13:46:11,979 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: GreekSalad.egtea
[2026-02-01 13:46:12,348 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [850, 484]
[2026-02-01 13:46:15,237 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [850, 484]
[2026-02-01 13:46:15,620 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: BaconAndEggs.egtea
[2026-02-01 13:46:16,346 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [1070, 1825]
[2026-02-01 13:46:19,257 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1070, 1825]
[2026-02-01 13:46:19,711 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: ContinentalBreakfast.egtea
[2026-02-01 13:46:19,988 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [474, 436]
[2026-02-01 13:46:22,860 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [474, 436]
[2026-02-01 13:46:23,220 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: ContinentalBreakfast.egtea
[2026-02-01 13:46:23,676 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [543, 1167]
[2026-02-01 13:46:26,606 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [543, 1167]
[2026-02-01 13:46:26,828 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Sandwich.cmu
[2026-02-01 13:46:26,966 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [175, 133]
[2026-02-01 13:46:28,774 - INFO - alignment_training_loop.py:353] - [BATCH 18] Loss value: 269.6457
[2026-02-01 13:46:30,967 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: TurkeySandwich.egtea
[2026-02-01 13:46:31,270 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [875, 429]
[2026-02-01 13:46:34,182 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [875, 429]
[2026-02-01 13:46:34,577 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: meccano
[2026-02-01 13:46:35,162 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [875, 1474]
[2026-02-01 13:46:38,012 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [875, 1474]
[2026-02-01 13:46:38,444 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: PastaSalad.egtea
[2026-02-01 13:46:39,566 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [2489, 2192]
[2026-02-01 13:46:40,012 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2489, 2192]
[2026-02-01 13:46:40,346 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Brownie.cmu
[2026-02-01 13:46:40,488 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [224, 359]
[2026-02-01 13:46:43,504 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [224, 359]
[2026-02-01 13:46:43,683 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: Eggs.cmu
[2026-02-01 13:46:43,895 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [264, 355]
[2026-02-01 13:46:46,685 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [264, 355]
[2026-02-01 13:46:47,031 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: pc_disassembly
[2026-02-01 13:46:47,248 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [324, 314]
[2026-02-01 13:46:50,077 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [324, 314]
[2026-02-01 13:46:50,423 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: Salad.cmu
[2026-02-01 13:46:50,651 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [396, 305]
[2026-02-01 13:46:53,522 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [396, 305]
[2026-02-01 13:46:53,877 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: Sandwich.cmu
[2026-02-01 13:46:54,011 - INFO - alignment_training_loop.py:286] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [127, 141]
[2026-02-01 13:46:55,642 - INFO - alignment_training_loop.py:353] - [BATCH 26] Loss value: 193.9467
[2026-02-01 13:46:57,538 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: Brownie.cmu
[2026-02-01 13:46:57,766 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [431, 491]
[2026-02-01 13:47:00,715 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [431, 491]
[2026-02-01 13:47:01,081 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: Pizza.cmu
[2026-02-01 13:47:01,339 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [298, 585]
[2026-02-01 13:47:04,309 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [298, 585]
[2026-02-01 13:47:04,672 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: Salad.cmu
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13201.877930
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.887695
[LAV DEBUG]   Pair loss = -33.5919 + 0.01 * (13201.8779 + 11782.8877) = 216.2558
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.90GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 432.5115
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.90GB | Reserved: 21.73GB | Peak: 20.59GB
[MEM Before backward] Allocated: 18.90GB | Reserved: 21.73GB | Peak: 20.59GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.73GB | Peak: 20.59GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.73GB | Peak: 20.59GB
[MEM Batch 13 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM Batch 14 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 15 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 16 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.81GB
[MEM Batch 17 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.70GB
[MEM Batch 18 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.88GB | Peak: 20.17GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.17GB
[MEM After forward pass] Allocated: 18.62GB | Reserved: 21.65GB | Peak: 20.17GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.62GB, Reserved: 21.65GB

[LAV DEBUG] Processing pair (0,1): N=175, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.255285
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10209.873047
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.940918
[LAV DEBUG]   Pair loss = -26.2553 + 0.01 * (10209.8730 + 5897.9409) = 134.8229
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.63GB

[LAV DEBUG] Processing pair (1,0): N=133, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.255285
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.940918
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10209.873047
[LAV DEBUG]   Pair loss = -26.2553 + 0.01 * (5897.9409 + 10209.8730) = 134.8229
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.64GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 269.6457
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.64GB | Reserved: 21.65GB | Peak: 20.17GB
[MEM Before backward] Allocated: 18.64GB | Reserved: 21.65GB | Peak: 20.17GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.65GB | Peak: 20.17GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.65GB | Peak: 20.17GB
[MEM Batch 19 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.17GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.17GB
[MEM Batch 20 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.67GB
[MEM Batch 21 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.67GB
[MEM Batch 22 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 23 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.42GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.42GB
[MEM Batch 24 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 25 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 26 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM After forward pass] Allocated: 18.50GB | Reserved: 21.61GB | Peak: 19.54GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([127, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([141, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.50GB, Reserved: 21.61GB

[LAV DEBUG] Processing pair (0,1): N=127, M=141
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.092201
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=127) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5377.945312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=141) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6628.611328
[LAV DEBUG]   Pair loss = -23.0922 + 0.01 * (5377.9453 + 6628.6113) = 96.9734
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.51GB

[LAV DEBUG] Processing pair (1,0): N=141, M=127
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.092201
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=141) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6628.611328
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=127) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5377.945312
[LAV DEBUG]   Pair loss = -23.0922 + 0.01 * (6628.6113 + 5377.9453) = 96.9734
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.51GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 193.9467
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.51GB | Reserved: 21.61GB | Peak: 19.54GB
[MEM Before backward] Allocated: 18.51GB | Reserved: 21.61GB | Peak: 19.54GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.62GB | Peak: 19.54GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.62GB | Peak: 19.54GB
[MEM Batch 27 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM Batch 28 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.71GB
[2026-02-01 13:47:04,823 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [130, 224]
[2026-02-01 13:47:06,909 - INFO - alignment_training_loop.py:353] - [BATCH 29] Loss value: 389.3813
[2026-02-01 13:47:09,447 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Sandwich.cmu
[2026-02-01 13:47:09,528 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [142, 179]
[2026-02-01 13:47:11,483 - INFO - alignment_training_loop.py:353] - [BATCH 30] Loss value: 293.0899
[2026-02-01 13:47:13,771 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: PastaSalad.egtea
[2026-02-01 13:47:14,307 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [989, 1438]
[2026-02-01 13:47:17,246 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [989, 1438]
[2026-02-01 13:47:17,685 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: Brownie.cmu
[2026-02-01 13:47:17,952 - INFO - alignment_training_loop.py:286] - [BATCH 32] After preprocessing - Num sequences: 2, Lengths: [397, 494]
[2026-02-01 13:47:20,854 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [397, 494]
[2026-02-01 13:47:21,253 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: Pizza.cmu
[2026-02-01 13:47:21,528 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [575, 351]
[2026-02-01 13:47:24,549 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [575, 351]
[2026-02-01 13:47:24,805 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Salad.cmu
[2026-02-01 13:47:25,053 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [253, 529]
[2026-02-01 13:47:27,919 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [253, 529]
[2026-02-01 13:47:28,282 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: tent
[2026-02-01 13:47:28,806 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [721, 1317]
[2026-02-01 13:47:31,644 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [721, 1317]
[2026-02-01 13:47:32,062 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: tent
[2026-02-01 13:47:32,129 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: Brownie.cmu
[2026-02-01 13:47:32,369 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [621, 406]
[2026-02-01 13:47:35,232 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [621, 406]
[2026-02-01 13:47:35,607 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: meccano
[2026-02-01 13:47:36,041 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [759, 838]
[2026-02-01 13:47:38,917 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [759, 838]
[2026-02-01 13:47:39,327 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: pc_assembly
[2026-02-01 13:47:39,693 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [757, 581]
[2026-02-01 13:47:42,592 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [757, 581]
[2026-02-01 13:47:42,982 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: Brownie.cmu
[2026-02-01 13:47:43,247 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [313, 528]
[2026-02-01 13:47:46,144 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [313, 528]
[2026-02-01 13:47:46,510 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: BaconAndEggs.egtea
[2026-02-01 13:47:46,937 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [718, 856]
[2026-02-01 13:47:49,780 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [718, 856]
[2026-02-01 13:47:50,177 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: BaconAndEggs.egtea
[2026-02-01 13:47:50,630 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [839, 776]
[2026-02-01 13:47:53,501 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [839, 776]
[2026-02-01 13:47:53,916 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: Brownie.cmu
[2026-02-01 13:47:54,207 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [294, 689]
[2026-02-01 13:47:57,122 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [294, 689]
[2026-02-01 13:47:57,499 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: GreekSalad.egtea
[2026-02-01 13:47:57,823 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [467, 658]
[2026-02-01 13:48:00,760 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [467, 658]
[2026-02-01 13:48:01,131 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: Sandwich.cmu
[2026-02-01 13:48:01,282 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [189, 184]
[MEM Batch 29 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After forward pass] Allocated: 18.76GB | Reserved: 21.70GB | Peak: 19.68GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.76GB, Reserved: 21.70GB

[LAV DEBUG] Processing pair (0,1): N=130, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.927340
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.940430
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.861328
[LAV DEBUG]   Pair loss = -28.9273 + 0.01 * (5634.9404 + 16726.8613) = 194.6907
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.77GB

[LAV DEBUG] Processing pair (1,0): N=224, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.927340
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.861328
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.940430
[LAV DEBUG]   Pair loss = -28.9273 + 0.01 * (16726.8613 + 5634.9404) = 194.6907
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.79GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 389.3813
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 18.79GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM Before backward] Allocated: 18.79GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.70GB | Peak: 19.68GB
[MEM Batch 30 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After forward pass] Allocated: 18.66GB | Reserved: 21.66GB | Peak: 19.68GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([142, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.66GB, Reserved: 21.66GB

[LAV DEBUG] Processing pair (0,1): N=142, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.503218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=142) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6722.935059
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10681.881836
[LAV DEBUG]   Pair loss = -27.5032 + 0.01 * (6722.9351 + 10681.8818) = 146.5449
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.67GB

[LAV DEBUG] Processing pair (1,0): N=179, M=142
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.503218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10681.881836
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=142) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6722.935059
[LAV DEBUG]   Pair loss = -27.5032 + 0.01 * (10681.8818 + 6722.9351) = 146.5449
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.68GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 293.0899
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.68GB | Reserved: 21.66GB | Peak: 19.68GB
[MEM Before backward] Allocated: 18.68GB | Reserved: 21.66GB | Peak: 19.68GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.67GB | Peak: 19.68GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.67GB | Peak: 19.68GB
[MEM Batch 31 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM Batch 32 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.75GB
[MEM Batch 33 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM Batch 34 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.71GB
[MEM Batch 35 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.60GB
[MEM Batch 36 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 37 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 38 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 39 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 40 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 41 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 42 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 43 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM Batch 44 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.75GB
[MEM Batch 45 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.86GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM After forward pass] Allocated: 18.82GB | Reserved: 21.71GB | Peak: 19.86GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([189, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.82GB, Reserved: 21.71GB

[LAV DEBUG] Processing pair (0,1): N=189, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.377247
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=189) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11908.570312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11286.898438
[2026-02-01 13:48:03,444 - INFO - alignment_training_loop.py:353] - [BATCH 45] Loss value: 399.1549
[2026-02-01 13:48:06,105 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Brownie.cmu
[2026-02-01 13:48:06,261 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [330, 297]
[2026-02-01 13:48:09,163 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [330, 297]
[2026-02-01 13:48:09,519 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: Salad.cmu
[2026-02-01 13:48:09,758 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [306, 430]
[2026-02-01 13:48:12,668 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [306, 430]
[2026-02-01 13:48:13,024 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: Cheeseburger.egtea
[2026-02-01 13:48:13,517 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [1138, 680]
[2026-02-01 13:48:16,447 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [1138, 680]
[2026-02-01 13:48:16,849 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: Sandwich.cmu
[2026-02-01 13:48:17,009 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [224, 160]
[2026-02-01 13:48:19,220 - INFO - alignment_training_loop.py:353] - [BATCH 49] Loss value: 440.0528
[2026-02-01 13:48:21,950 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: Salad.cmu
[2026-02-01 13:48:22,125 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [390, 346]
[2026-02-01 13:48:25,044 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [390, 346]
[2026-02-01 13:48:25,408 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Sandwich.cmu
[2026-02-01 13:48:25,578 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [213, 238]
[2026-02-01 13:48:28,151 - INFO - alignment_training_loop.py:353] - [BATCH 51] Loss value: 601.8495
[2026-02-01 13:48:31,378 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: Pizza.cmu
[2026-02-01 13:48:31,690 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [471, 839]
[2026-02-01 13:48:34,696 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [471, 839]
[2026-02-01 13:48:35,082 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: BaconAndEggs.egtea
[2026-02-01 13:48:35,760 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [826, 1835]
[2026-02-01 13:48:38,632 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [826, 1835]
[2026-02-01 13:48:39,076 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: Salad.cmu
[2026-02-01 13:48:39,298 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [423, 272]
[2026-02-01 13:48:42,182 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [423, 272]
[2026-02-01 13:48:42,540 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Pizza.cmu
[2026-02-01 13:48:42,900 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [762, 531]
[2026-02-01 13:48:45,778 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [762, 531]
[2026-02-01 13:48:46,158 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: PastaSalad.egtea
[2026-02-01 13:48:46,836 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [1796, 906]
[2026-02-01 13:48:47,154 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1796, 906]
[2026-02-01 13:48:47,399 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 13:48:47,536 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [237, 339]
[LAV DEBUG]   Pair loss = -32.3772 + 0.01 * (11908.5703 + 11286.8984) = 199.5774
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.84GB

[LAV DEBUG] Processing pair (1,0): N=184, M=189
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.377247
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11286.898438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=189) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11908.570312
[LAV DEBUG]   Pair loss = -32.3772 + 0.01 * (11286.8984 + 11908.5703) = 199.5774
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.85GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 399.1549
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.85GB | Reserved: 21.71GB | Peak: 19.86GB
[MEM Before backward] Allocated: 18.85GB | Reserved: 21.71GB | Peak: 19.86GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.72GB | Peak: 19.86GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.72GB | Peak: 19.86GB
[MEM Batch 46 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM Batch 47 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 48 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM Batch 49 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM After forward pass] Allocated: 18.85GB | Reserved: 21.72GB | Peak: 19.87GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([160, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.85GB, Reserved: 21.72GB

[LAV DEBUG] Processing pair (0,1): N=224, M=160
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.591354
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.857422
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=160) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8534.920898
[LAV DEBUG]   Pair loss = -32.5914 + 0.01 * (16726.8574 + 8534.9209) = 220.0264
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.87GB

[LAV DEBUG] Processing pair (1,0): N=160, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.591354
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=160) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8534.920898
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.857422
[LAV DEBUG]   Pair loss = -32.5914 + 0.01 * (8534.9209 + 16726.8574) = 220.0264
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.89GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 440.0528
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.89GB | Reserved: 21.72GB | Peak: 19.87GB
[MEM Before backward] Allocated: 18.89GB | Reserved: 21.72GB | Peak: 19.87GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.73GB | Peak: 19.87GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.73GB | Peak: 19.87GB
[MEM Batch 50 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM Batch 51 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM After forward pass] Allocated: 19.06GB | Reserved: 21.79GB | Peak: 19.57GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([213, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([238, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.06GB, Reserved: 21.79GB

[LAV DEBUG] Processing pair (0,1): N=213, M=238
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.148872
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=213) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15124.518555
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=238) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18882.845703
[LAV DEBUG]   Pair loss = -39.1489 + 0.01 * (15124.5186 + 18882.8457) = 300.9248
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.08GB

[LAV DEBUG] Processing pair (1,0): N=238, M=213
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.148872
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=238) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18882.845703
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=213) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15124.518555
[LAV DEBUG]   Pair loss = -39.1489 + 0.01 * (18882.8457 + 15124.5186) = 300.9248
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.11GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 601.8495
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.11GB | Reserved: 21.79GB | Peak: 19.57GB
[MEM Before backward] Allocated: 19.11GB | Reserved: 21.79GB | Peak: 19.57GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.79GB | Peak: 19.57GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.79GB | Peak: 19.57GB
[MEM Batch 52 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM Batch 53 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.00GB
[MEM Batch 54 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 55 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM Batch 56 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.01GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.01GB
[MEM After forward pass] Allocated: 19.44GB | Reserved: 21.93GB | Peak: 19.51GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([237, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([339, 128]), dtype=torch.float32, device=cuda:0
[2026-02-01 13:48:50,659 - INFO - alignment_training_loop.py:353] - [BATCH 57] Loss value: 1042.7152
[2026-02-01 13:48:54,766 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: Eggs.cmu
[2026-02-01 13:48:54,901 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [325, 229]
[2026-02-01 13:48:58,043 - INFO - alignment_training_loop.py:353] - [BATCH 58] Loss value: 959.5608
[2026-02-01 13:49:02,013 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Salad.cmu
[2026-02-01 13:49:02,158 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [329, 272]
[2026-02-01 13:49:05,038 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [329, 272]
[2026-02-01 13:49:05,389 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: Brownie.cmu
[2026-02-01 13:49:05,652 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [523, 329]
[2026-02-01 13:49:08,576 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [523, 329]
[2026-02-01 13:49:08,955 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: Pizza.cmu
[2026-02-01 13:49:09,260 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [381, 593]
[2026-02-01 13:49:12,190 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [381, 593]
[2026-02-01 13:49:12,563 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: Brownie.cmu
[2026-02-01 13:49:12,814 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [373, 418]
[2026-02-01 13:49:15,719 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [373, 418]
[2026-02-01 13:49:16,085 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: Pizza.cmu
[2026-02-01 13:49:16,355 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [458, 439]
[2026-02-01 13:49:19,293 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [458, 439]
[2026-02-01 13:49:19,663 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: Eggs.cmu
[2026-02-01 13:49:19,894 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [347, 349]
[2026-02-01 13:49:22,773 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [347, 349]
[2026-02-01 13:49:23,130 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: Pizza.cmu
[2026-02-01 13:49:23,416 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [346, 596]
[2026-02-01 13:49:26,337 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [346, 596]
[2026-02-01 13:49:26,714 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: ContinentalBreakfast.egtea
[2026-02-01 13:49:27,187 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [1343, 445]
[2026-02-01 13:49:30,170 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [1343, 445]
[2026-02-01 13:49:30,574 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Eggs.cmu
[2026-02-01 13:49:30,797 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [271, 378]
[2026-02-01 13:49:33,648 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [271, 378]
[2026-02-01 13:49:34,000 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: TurkeySandwich.egtea
[2026-02-01 13:49:34,235 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [383, 327]
[2026-02-01 13:49:37,140 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [383, 327]
[2026-02-01 13:49:37,499 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: pc_disassembly
[2026-02-01 13:49:37,723 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [317, 361]
[2026-02-01 13:49:40,610 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [317, 361]
[2026-02-01 13:49:40,967 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: Pizza.egtea
[2026-02-01 13:49:41,347 - INFO - alignment_training_loop.py:286] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [632, 747]
[2026-02-01 13:49:44,221 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [632, 747]
[2026-02-01 13:49:44,607 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: Salad.cmu
[2026-02-01 13:49:44,794 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [223, 273]
[LAV DEBUG] Initial GPU Memory - Allocated: 19.44GB, Reserved: 21.93GB

[LAV DEBUG] Processing pair (0,1): N=237, M=339
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.968449
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=237) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18724.492188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=339) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38308.113281
[LAV DEBUG]   Pair loss = -48.9684 + 0.01 * (18724.4922 + 38308.1133) = 521.3576
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.48GB

[LAV DEBUG] Processing pair (1,0): N=339, M=237
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.968449
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=339) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38308.113281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=237) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18724.492188
[LAV DEBUG]   Pair loss = -48.9684 + 0.01 * (38308.1133 + 18724.4922) = 521.3576
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.52GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1042.7152
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.52GB | Reserved: 21.92GB | Peak: 19.56GB
[MEM Before backward] Allocated: 19.52GB | Reserved: 21.92GB | Peak: 19.56GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 58 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM After forward pass] Allocated: 19.38GB | Reserved: 21.90GB | Peak: 19.69GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([325, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.38GB, Reserved: 21.90GB

[LAV DEBUG] Processing pair (0,1): N=325, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -47.132824
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=325) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35209.480469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17481.843750
[LAV DEBUG]   Pair loss = -47.1328 + 0.01 * (35209.4805 + 17481.8438) = 479.7804
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.41GB

[LAV DEBUG] Processing pair (1,0): N=229, M=325
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -47.132824
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17481.843750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=325) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35209.480469
[LAV DEBUG]   Pair loss = -47.1328 + 0.01 * (17481.8438 + 35209.4805) = 479.7804
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.45GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 959.5608
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 19.45GB | Reserved: 21.90GB | Peak: 19.69GB
[MEM Before backward] Allocated: 19.45GB | Reserved: 21.90GB | Peak: 19.69GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.90GB | Peak: 19.69GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.90GB | Peak: 19.69GB
[MEM Batch 59 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM Batch 60 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.47GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.47GB
[MEM Batch 61 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 62 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.75GB
[MEM Batch 63 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.61GB
[MEM Batch 64 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM Batch 65 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM Batch 66 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.72GB
[MEM Batch 67 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.02GB
[MEM Batch 68 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.50GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.50GB
[MEM Batch 69 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 70 START - Task Pizza.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.52GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.52GB
[MEM Batch 71 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM After forward pass] Allocated: 19.20GB | Reserved: 21.84GB | Peak: 19.49GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.20GB, Reserved: 21.84GB

[LAV DEBUG] Processing pair (0,1): N=223, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.850910
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16577.818359
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24844.435547
[LAV DEBUG]   Pair loss = -42.8509 + 0.01 * (16577.8184 + 24844.4355) = 371.3716
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.23GB

[LAV DEBUG] Processing pair (1,0): N=273, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.850910
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24844.435547
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16577.818359
[LAV DEBUG]   Pair loss = -42.8509 + 0.01 * (24844.4355 + 16577.8184) = 371.3716
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.26GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 742.7432
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[2026-02-01 13:49:47,573 - INFO - alignment_training_loop.py:353] - [BATCH 71] Loss value: 742.7432
[2026-02-01 13:49:51,124 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: ContinentalBreakfast.egtea
[2026-02-01 13:49:51,354 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [469, 491]
[2026-02-01 13:49:54,302 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [469, 491]
[2026-02-01 13:49:54,684 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Sandwich.cmu
[2026-02-01 13:49:54,838 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [214, 156]
[2026-02-01 13:49:56,984 - INFO - alignment_training_loop.py:353] - [BATCH 73] Loss value: 404.6664
[2026-02-01 13:49:59,640 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: Eggs.cmu
[2026-02-01 13:49:59,750 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [246, 196]
[2026-02-01 13:50:02,309 - INFO - alignment_training_loop.py:353] - [BATCH 74] Loss value: 583.5011
[2026-02-01 13:50:05,472 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: pc_disassembly
[2026-02-01 13:50:05,629 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [340, 295]
[2026-02-01 13:50:08,564 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [340, 295]
[2026-02-01 13:50:08,921 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: pc_assembly
[2026-02-01 13:50:09,278 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [656, 656]
[2026-02-01 13:50:12,199 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [656, 656]
[2026-02-01 13:50:12,586 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: TurkeySandwich.egtea
[2026-02-01 13:50:13,034 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [1109, 582]
[2026-02-01 13:50:15,964 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [1109, 582]
[2026-02-01 13:50:16,392 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: tent
[2026-02-01 13:50:16,958 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [768, 1374]
[2026-02-01 13:50:19,807 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [768, 1374]
[2026-02-01 13:50:20,243 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: Pizza.cmu
[2026-02-01 13:50:20,400 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [126, 236]
[2026-02-01 13:50:22,500 - INFO - alignment_training_loop.py:353] - [BATCH 79] Loss value: 419.1650
[MEM After loss computation] Allocated: 19.26GB | Reserved: 21.84GB | Peak: 19.49GB
[MEM Before backward] Allocated: 19.26GB | Reserved: 21.84GB | Peak: 19.49GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.85GB | Peak: 19.49GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.85GB | Peak: 19.49GB
[MEM Batch 72 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 73 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.73GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.73GB
[MEM After forward pass] Allocated: 18.81GB | Reserved: 21.71GB | Peak: 19.73GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([156, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.81GB, Reserved: 21.71GB

[LAV DEBUG] Processing pair (0,1): N=214, M=156
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.471397
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15266.865234
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=156) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8113.594238
[LAV DEBUG]   Pair loss = -31.4714 + 0.01 * (15266.8652 + 8113.5942) = 202.3332
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.83GB

[LAV DEBUG] Processing pair (1,0): N=156, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.471397
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=156) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8113.594238
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15266.865234
[LAV DEBUG]   Pair loss = -31.4714 + 0.01 * (8113.5942 + 15266.8652) = 202.3332
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.84GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 404.6664
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.84GB | Reserved: 21.71GB | Peak: 19.73GB
[MEM Before backward] Allocated: 18.84GB | Reserved: 21.71GB | Peak: 19.73GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.71GB | Peak: 19.73GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.71GB | Peak: 19.73GB
[MEM Batch 74 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.73GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.73GB
[MEM After forward pass] Allocated: 19.03GB | Reserved: 21.79GB | Peak: 19.73GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([246, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.03GB, Reserved: 21.79GB

[LAV DEBUG] Processing pair (0,1): N=246, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.053352
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=246) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 20173.501953
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.887695
[LAV DEBUG]   Pair loss = -38.0534 + 0.01 * (20173.5020 + 12806.8877) = 291.7505
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.05GB

[LAV DEBUG] Processing pair (1,0): N=196, M=246
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.053352
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.887695
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=246) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 20173.501953
[LAV DEBUG]   Pair loss = -38.0534 + 0.01 * (12806.8877 + 20173.5020) = 291.7505
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.08GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 583.5011
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.08GB | Reserved: 21.79GB | Peak: 19.73GB
[MEM Before backward] Allocated: 19.08GB | Reserved: 21.79GB | Peak: 19.73GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.79GB | Peak: 19.73GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.79GB | Peak: 19.73GB
[MEM Batch 75 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.73GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.73GB
[MEM Batch 76 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 77 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.51GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.51GB
[MEM Batch 78 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.84GB
[MEM Batch 79 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM After forward pass] Allocated: 18.78GB | Reserved: 21.71GB | Peak: 19.59GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([126, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.78GB, Reserved: 21.71GB

[LAV DEBUG] Processing pair (0,1): N=126, M=236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.022118
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=126) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5293.626465
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18566.835938
[LAV DEBUG]   Pair loss = -29.0221 + 0.01 * (5293.6265 + 18566.8359) = 209.5825
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.80GB

[LAV DEBUG] Processing pair (1,0): N=236, M=126
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.022118
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18566.835938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=126) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5293.626465
[LAV DEBUG]   Pair loss = -29.0221 + 0.01 * (18566.8359 + 5293.6265) = 209.5825
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.81GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 419.1650
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.81GB | Reserved: 21.71GB | Peak: 19.59GB
[MEM Before backward] Allocated: 18.81GB | Reserved: 21.71GB | Peak: 19.59GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.71GB | Peak: 19.59GB
[2026-02-01 13:50:25,079 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: GreekSalad.egtea
[2026-02-01 13:50:25,358 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [808, 364]
[2026-02-01 13:50:28,279 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [808, 364]
[2026-02-01 13:50:28,671 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: BaconAndEggs.egtea
[2026-02-01 13:50:29,630 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [1727, 2332]
[2026-02-01 13:50:32,628 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1727, 2332]
[2026-02-01 13:50:33,141 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Brownie.cmu
[2026-02-01 13:50:33,388 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [403, 369]
[2026-02-01 13:50:36,262 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [403, 369]
[2026-02-01 13:50:36,629 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Pizza.cmu
[2026-02-01 13:50:36,970 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [756, 421]
[2026-02-01 13:50:39,852 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [756, 421]
[2026-02-01 13:50:40,236 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: Pizza.egtea
[2026-02-01 13:50:40,735 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [693, 1236]
[2026-02-01 13:50:43,598 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [693, 1236]
[2026-02-01 13:50:44,013 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Cheeseburger.egtea
[2026-02-01 13:50:44,369 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [844, 447]
[2026-02-01 13:50:47,223 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [844, 447]
[2026-02-01 13:50:47,607 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: Eggs.cmu
[2026-02-01 13:50:47,814 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [341, 222]
[2026-02-01 13:50:50,977 - INFO - alignment_training_loop.py:353] - [BATCH 86] Loss value: 1009.1818
[2026-02-01 13:50:55,013 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: Salad.cmu
[2026-02-01 13:50:55,176 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [379, 279]
[2026-02-01 13:50:58,078 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [379, 279]
[2026-02-01 13:50:58,430 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: Brownie.cmu
[2026-02-01 13:50:58,669 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [335, 416]
[2026-02-01 13:51:01,556 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [335, 416]
[2026-02-01 13:51:01,920 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: Salad.cmu
[2026-02-01 13:51:02,129 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [408, 173]
[2026-02-01 13:51:04,964 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [408, 173]
[2026-02-01 13:51:05,264 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: TurkeySandwich.egtea
[2026-02-01 13:51:05,556 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [506, 502]
[2026-02-01 13:51:08,495 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [506, 502]
[2026-02-01 13:51:08,874 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: Eggs.cmu
[2026-02-01 13:51:09,062 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [292, 181]
[2026-02-01 13:51:11,770 - INFO - alignment_training_loop.py:353] - [BATCH 91] Loss value: 708.2329
[2026-02-01 13:51:15,167 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: meccano
[2026-02-01 13:51:15,733 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [694, 1833]
[2026-02-01 13:51:18,622 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [694, 1833]
[2026-02-01 13:51:19,051 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: pc_assembly
[2026-02-01 13:51:19,379 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [555, 574]
[2026-02-01 13:51:22,328 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [555, 574]
[2026-02-01 13:51:22,682 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: pc_assembly
[2026-02-01 13:51:22,992 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [536, 513]
[2026-02-01 13:51:25,924 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [536, 513]
[2026-02-01 13:51:26,292 - INFO - alignment_training_loop.py:417] - Epoch 2 stats - Total: 95, Successful: 20, Skipped (length): 2, Skipped (exception): 73
[2026-02-01 13:51:26,433 - INFO - alignment_training_loop.py:428] - Epoch [2/50], Loss: 1892.2294 (424.14s)
[2026-02-01 13:51:26,437 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: tent
[2026-02-01 13:51:26,997 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [1374, 768]
[2026-02-01 13:51:29,946 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [1374, 768]
[2026-02-01 13:51:30,369 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: Salad.cmu
[2026-02-01 13:51:30,573 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [273, 306]
[2026-02-01 13:51:33,403 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [273, 306]
[2026-02-01 13:51:33,718 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: pc_disassembly
[2026-02-01 13:51:33,933 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [295, 314]
[2026-02-01 13:51:36,825 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [295, 314]
[2026-02-01 13:51:37,194 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Brownie.cmu
[2026-02-01 13:51:37,477 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [397, 523]
[2026-02-01 13:51:40,435 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [397, 523]
[2026-02-01 13:51:40,827 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: ContinentalBreakfast.egtea
[2026-02-01 13:51:41,122 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [469, 474]
[2026-02-01 13:51:44,045 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [469, 474]
[2026-02-01 13:51:44,421 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Sandwich.cmu
[2026-02-01 13:51:44,589 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [188, 238]
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.71GB | Peak: 19.59GB
[MEM Batch 80 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM Batch 81 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.62GB
[MEM Batch 82 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.31GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.31GB
[MEM Batch 83 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM Batch 84 START - Task Pizza.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 85 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 86 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM After forward pass] Allocated: 19.40GB | Reserved: 21.91GB | Peak: 19.65GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([222, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.40GB, Reserved: 21.91GB

[LAV DEBUG] Processing pair (0,1): N=341, M=222
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -47.317745
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38761.339844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=222) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16429.527344
[LAV DEBUG]   Pair loss = -47.3177 + 0.01 * (38761.3398 + 16429.5273) = 504.5909
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.44GB

[LAV DEBUG] Processing pair (1,0): N=222, M=341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -47.317745
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=222) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16429.527344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38761.339844
[LAV DEBUG]   Pair loss = -47.3177 + 0.01 * (16429.5273 + 38761.3398) = 504.5909
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.48GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1009.1818
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.48GB | Reserved: 21.91GB | Peak: 19.65GB
[MEM Before backward] Allocated: 19.48GB | Reserved: 21.91GB | Peak: 19.65GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.91GB | Peak: 19.65GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.91GB | Peak: 19.65GB
[MEM Batch 87 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 88 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.51GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.51GB
[MEM Batch 89 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 90 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.41GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM Batch 91 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.77GB
[MEM After forward pass] Allocated: 19.13GB | Reserved: 21.82GB | Peak: 19.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([292, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([181, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.13GB, Reserved: 21.82GB

[LAV DEBUG] Processing pair (0,1): N=292, M=181
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.327808
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=292) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28422.527344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=181) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10921.901367
[LAV DEBUG]   Pair loss = -39.3278 + 0.01 * (28422.5273 + 10921.9014) = 354.1165
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.15GB

[LAV DEBUG] Processing pair (1,0): N=181, M=292
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.327808
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=181) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10921.901367
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=292) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28422.527344
[LAV DEBUG]   Pair loss = -39.3278 + 0.01 * (10921.9014 + 28422.5273) = 354.1165
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.18GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 708.2329
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.18GB | Reserved: 21.82GB | Peak: 19.77GB
[MEM Before backward] Allocated: 19.18GB | Reserved: 21.82GB | Peak: 19.77GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.82GB | Peak: 19.77GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.82GB | Peak: 19.77GB
[MEM Batch 92 START - Task meccano] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.77GB
[MEM Batch 93 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 94 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.86GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM Batch 0 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.80GB
[MEM Batch 1 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.04GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.04GB
[MEM Batch 2 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.41GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM Batch 3 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.47GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.47GB
[MEM Batch 4 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.70GB
[MEM Batch 5 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.72GB
[MEM After forward pass] Allocated: 18.98GB | Reserved: 21.77GB | Peak: 19.72GB
[2026-02-01 13:51:47,028 - INFO - alignment_training_loop.py:353] - [BATCH 5] Loss value: 540.0551
[2026-02-01 13:51:50,084 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: Cheeseburger.egtea
[2026-02-01 13:51:50,380 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [844, 447]
[2026-02-01 13:51:53,299 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [844, 447]
[2026-02-01 13:51:53,688 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Brownie.cmu
[2026-02-01 13:51:53,947 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [330, 491]
[2026-02-01 13:51:56,853 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [330, 491]
[2026-02-01 13:51:57,224 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: Brownie.cmu
[2026-02-01 13:51:57,527 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [621, 406]
[2026-02-01 13:52:00,387 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [621, 406]
[2026-02-01 13:52:00,758 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Sandwich.cmu
[2026-02-01 13:52:00,889 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [93, 133]
[2026-02-01 13:52:02,310 - INFO - alignment_training_loop.py:353] - [BATCH 9] Loss value: 137.7594
[2026-02-01 13:52:03,927 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: PastaSalad.egtea
[2026-02-01 13:52:04,447 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [543, 1728]
[2026-02-01 13:52:07,560 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [543, 1728]
[2026-02-01 13:52:07,809 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: tent
[2026-02-01 13:52:07,875 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Eggs.cmu
[2026-02-01 13:52:08,047 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [325, 355]
[2026-02-01 13:52:10,896 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [325, 355]
[2026-02-01 13:52:11,252 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: BaconAndEggs.egtea
[2026-02-01 13:52:12,085 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [2332, 1070]
[2026-02-01 13:52:12,498 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [2332, 1070]
[2026-02-01 13:52:12,772 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: Pizza.cmu
[2026-02-01 13:52:12,981 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [596, 298]
[2026-02-01 13:52:15,992 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [596, 298]
[2026-02-01 13:52:16,182 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Brownie.cmu
[2026-02-01 13:52:16,397 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [297, 313]
[2026-02-01 13:52:19,209 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [297, 313]
[2026-02-01 13:52:19,567 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Brownie.cmu
[2026-02-01 13:52:19,858 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [689, 294]
[2026-02-01 13:52:22,697 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [689, 294]
[2026-02-01 13:52:23,070 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: Salad.cmu
[2026-02-01 13:52:23,283 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [300, 279]
[2026-02-01 13:52:26,086 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [300, 279]
[2026-02-01 13:52:26,401 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: PastaSalad.egtea
[2026-02-01 13:52:27,253 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [989, 2492]
[2026-02-01 13:52:30,115 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [989, 2492]
[2026-02-01 13:52:30,587 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: Pizza.cmu
[2026-02-01 13:52:30,892 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [593, 439]
[2026-02-01 13:52:33,978 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [593, 439]
[2026-02-01 13:52:34,170 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: ContinentalBreakfast.egtea
[2026-02-01 13:52:34,623 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [1167, 543]
[2026-02-01 13:52:37,500 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [1167, 543]
[2026-02-01 13:52:37,904 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: GreekSalad.egtea
[2026-02-01 13:52:38,272 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [484, 808]
[2026-02-01 13:52:41,223 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [484, 808]
[2026-02-01 13:52:41,611 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Cheeseburger.egtea
[2026-02-01 13:52:42,268 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [470, 670]
[2026-02-01 13:52:45,141 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [470, 670]
[2026-02-01 13:52:45,526 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: Sandwich.cmu
[2026-02-01 13:52:45,702 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [184, 256]

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([238, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.98GB, Reserved: 21.77GB

[LAV DEBUG] Processing pair (0,1): N=188, M=238
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.629841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.897461
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=238) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18882.839844
[LAV DEBUG]   Pair loss = -36.6298 + 0.01 * (11782.8975 + 18882.8398) = 270.0275
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.00GB

[LAV DEBUG] Processing pair (1,0): N=238, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.629841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=238) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18882.839844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.897461
[LAV DEBUG]   Pair loss = -36.6298 + 0.01 * (18882.8398 + 11782.8975) = 270.0275
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 540.0551
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.02GB | Reserved: 21.77GB | Peak: 19.72GB
[MEM Before backward] Allocated: 19.02GB | Reserved: 21.77GB | Peak: 19.72GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.77GB | Peak: 19.72GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.77GB | Peak: 19.72GB
[MEM Batch 6 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.72GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 8 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 9 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After forward pass] Allocated: 18.37GB | Reserved: 21.57GB | Peak: 19.48GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.37GB, Reserved: 21.57GB

[LAV DEBUG] Processing pair (0,1): N=93, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -18.946030
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.635986
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.936523
[LAV DEBUG]   Pair loss = -18.9460 + 0.01 * (2884.6360 + 5897.9365) = 68.8797
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.37GB

[LAV DEBUG] Processing pair (1,0): N=133, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -18.946030
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.936523
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.635986
[LAV DEBUG]   Pair loss = -18.9460 + 0.01 * (5897.9365 + 2884.6360) = 68.8797
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 18.38GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 137.7594
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.38GB | Reserved: 21.57GB | Peak: 19.48GB
[MEM Before backward] Allocated: 18.38GB | Reserved: 21.57GB | Peak: 19.48GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.57GB | Peak: 19.48GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.57GB | Peak: 19.48GB
[MEM Batch 10 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 11 START - Task tent] Allocated: 17.67GB | Reserved: 21.88GB | Peak: 20.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM Batch 12 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.59GB
[MEM Batch 13 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 14 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM Batch 15 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM Batch 16 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.47GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.47GB
[MEM Batch 17 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 18 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.41GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM Batch 19 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.75GB
[MEM Batch 20 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.79GB
[MEM Batch 21 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.89GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.89GB
[MEM Batch 22 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.98GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.98GB
[MEM Batch 23 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM After forward pass] Allocated: 19.02GB | Reserved: 21.79GB | Peak: 19.87GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.02GB, Reserved: 21.79GB

[LAV DEBUG] Processing pair (0,1): N=184, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.441345
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11286.904297
[2026-02-01 13:52:48,175 - INFO - alignment_training_loop.py:353] - [BATCH 23] Loss value: 587.7920
[2026-02-01 13:52:51,331 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: meccano
[2026-02-01 13:52:51,844 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [759, 1410]
[2026-02-01 13:52:54,713 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [759, 1410]
[2026-02-01 13:52:55,192 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: TurkeySandwich.egtea
[2026-02-01 13:52:55,430 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [429, 327]
[2026-02-01 13:52:58,327 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [429, 327]
[2026-02-01 13:52:58,689 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: ContinentalBreakfast.egtea
[2026-02-01 13:52:58,955 - INFO - alignment_training_loop.py:286] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [445, 436]
[2026-02-01 13:53:01,844 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [445, 436]
[2026-02-01 13:53:02,239 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: Eggs.cmu
[2026-02-01 13:53:02,457 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [292, 341]
[2026-02-01 13:53:05,329 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [292, 341]
[2026-02-01 13:53:05,684 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: PastaSalad.egtea
[2026-02-01 13:53:06,464 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [906, 2196]
[2026-02-01 13:53:09,331 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [906, 2196]
[2026-02-01 13:53:09,792 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: GreekSalad.egtea
[2026-02-01 13:53:10,095 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [658, 364]
[2026-02-01 13:53:12,914 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [658, 364]
[2026-02-01 13:53:13,290 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Eggs.cmu
[2026-02-01 13:53:13,484 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [181, 349]
[2026-02-01 13:53:16,478 - INFO - alignment_training_loop.py:353] - [BATCH 30] Loss value: 945.6801
[2026-02-01 13:53:20,278 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Eggs.cmu
[2026-02-01 13:53:20,399 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [196, 264]
[2026-02-01 13:53:23,042 - INFO - alignment_training_loop.py:353] - [BATCH 31] Loss value: 642.1570
[2026-02-01 13:53:26,340 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: Pizza.cmu
[2026-02-01 13:53:26,554 - INFO - alignment_training_loop.py:286] - [BATCH 32] After preprocessing - Num sequences: 2, Lengths: [346, 507]
[2026-02-01 13:53:29,497 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [346, 507]
[2026-02-01 13:53:29,865 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: Salad.cmu
[2026-02-01 13:53:30,106 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [423, 329]
[2026-02-01 13:53:33,007 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [423, 329]
[2026-02-01 13:53:33,376 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Salad.cmu
[2026-02-01 13:53:33,586 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [408, 173]
[2026-02-01 13:53:36,455 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [408, 173]
[2026-02-01 13:53:36,769 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: meccano
[2026-02-01 13:53:37,466 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [1474, 1341]
[2026-02-01 13:53:40,423 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1474, 1341]
[2026-02-01 13:53:40,924 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: Salad.cmu
[2026-02-01 13:53:41,181 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [253, 529]
[2026-02-01 13:53:44,055 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [253, 529]
[2026-02-01 13:53:44,421 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: Pizza.egtea
[2026-02-01 13:53:44,816 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [632, 747]
[2026-02-01 13:53:47,658 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [632, 747]
[2026-02-01 13:53:48,061 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: Brownie.cmu
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21846.828125
[LAV DEBUG]   Pair loss = -37.4413 + 0.01 * (11286.9043 + 21846.8281) = 293.8960
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.05GB

[LAV DEBUG] Processing pair (1,0): N=256, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.441345
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21846.828125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11286.904297
[LAV DEBUG]   Pair loss = -37.4413 + 0.01 * (21846.8281 + 11286.9043) = 293.8960
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 587.7920
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.07GB | Reserved: 21.79GB | Peak: 19.87GB
[MEM Before backward] Allocated: 19.07GB | Reserved: 21.79GB | Peak: 19.87GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.79GB | Peak: 19.87GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.79GB | Peak: 19.87GB
[MEM Batch 24 START - Task meccano] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM Batch 25 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 26 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 27 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.68GB
[MEM Batch 28 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 29 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM Batch 30 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.51GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.51GB
[MEM After forward pass] Allocated: 19.30GB | Reserved: 21.88GB | Peak: 19.51GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([181, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([349, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.30GB, Reserved: 21.88GB

[LAV DEBUG] Processing pair (0,1): N=181, M=349
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.392841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=181) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10921.897461
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=349) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 40601.394531
[LAV DEBUG]   Pair loss = -42.3928 + 0.01 * (10921.8975 + 40601.3945) = 472.8401
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.33GB

[LAV DEBUG] Processing pair (1,0): N=349, M=181
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.392841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=349) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 40601.394531
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=181) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10921.897461
[LAV DEBUG]   Pair loss = -42.3928 + 0.01 * (40601.3945 + 10921.8975) = 472.8401
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.36GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 945.6801
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.36GB | Reserved: 21.88GB | Peak: 19.51GB
[MEM Before backward] Allocated: 19.36GB | Reserved: 21.88GB | Peak: 19.51GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.89GB | Peak: 19.55GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.89GB | Peak: 19.55GB
[MEM Batch 31 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM After forward pass] Allocated: 19.09GB | Reserved: 21.81GB | Peak: 19.55GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.09GB, Reserved: 21.81GB

[LAV DEBUG] Processing pair (0,1): N=196, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.325218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.898438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 23233.476562
[LAV DEBUG]   Pair loss = -39.3252 + 0.01 * (12806.8984 + 23233.4766) = 321.0785
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.11GB

[LAV DEBUG] Processing pair (1,0): N=264, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.325218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 23233.476562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.898438
[LAV DEBUG]   Pair loss = -39.3252 + 0.01 * (23233.4766 + 12806.8984) = 321.0785
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.14GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 642.1570
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 19.14GB | Reserved: 21.81GB | Peak: 19.55GB
[MEM Before backward] Allocated: 19.14GB | Reserved: 21.81GB | Peak: 19.55GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.81GB | Peak: 19.55GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.81GB | Peak: 19.55GB
[MEM Batch 32 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 33 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 34 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 35 START - Task meccano] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.41GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.41GB
[MEM Batch 36 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.12GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.12GB
[MEM Batch 37 START - Task Pizza.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.60GB
[2026-02-01 13:53:48,265 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [369, 224]
[2026-02-01 13:53:51,087 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [369, 224]
[2026-02-01 13:53:51,426 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: Eggs.cmu
[2026-02-01 13:53:51,658 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [466, 246]
[2026-02-01 13:53:54,518 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [466, 246]
[2026-02-01 13:53:54,887 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: pc_assembly
[2026-02-01 13:53:55,216 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [581, 555]
[2026-02-01 13:53:58,465 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [581, 555]
[2026-02-01 13:53:58,705 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: PastaSalad.egtea
[2026-02-01 13:53:59,780 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [2489, 1796]
[2026-02-01 13:54:00,222 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2489, 1796]
[2026-02-01 13:54:00,536 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: Sandwich.cmu
[2026-02-01 13:54:00,619 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [179, 141]
[2026-02-01 13:54:02,427 - INFO - alignment_training_loop.py:353] - [BATCH 42] Loss value: 291.4148
[2026-02-01 13:54:04,654 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: PastaSalad.egtea
[2026-02-01 13:54:05,300 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [1401, 1497]
[2026-02-01 13:54:08,208 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1401, 1497]
[2026-02-01 13:54:08,661 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: Eggs.cmu
[2026-02-01 13:54:08,898 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [347, 378]
[2026-02-01 13:54:11,736 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [347, 378]
[2026-02-01 13:54:12,127 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: meccano
[2026-02-01 13:54:12,707 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [694, 1598]
[2026-02-01 13:54:15,522 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [694, 1598]
[2026-02-01 13:54:15,952 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Pizza.cmu
[2026-02-01 13:54:16,255 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [471, 575]
[2026-02-01 13:54:19,151 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [471, 575]
[2026-02-01 13:54:19,527 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: Salad.cmu
[2026-02-01 13:54:19,712 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [130, 379]
[2026-02-01 13:54:22,552 - INFO - alignment_training_loop.py:353] - [BATCH 47] Loss value: 999.2993
[2026-02-01 13:54:26,179 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: ContinentalBreakfast.egtea
[2026-02-01 13:54:26,599 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [491, 1343]
[2026-02-01 13:54:29,332 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [491, 1343]
[2026-02-01 13:54:29,557 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: meccano
[2026-02-01 13:54:30,211 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [838, 1833]
[2026-02-01 13:54:33,044 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [838, 1833]
[2026-02-01 13:54:33,509 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: Eggs.cmu
[2026-02-01 13:54:33,687 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [237, 202]
[MEM Batch 38 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.49GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.49GB
[MEM Batch 39 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.45GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.45GB
[MEM Batch 40 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 41 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM Batch 42 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM After forward pass] Allocated: 18.66GB | Reserved: 21.66GB | Peak: 19.53GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([141, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.66GB, Reserved: 21.66GB

[LAV DEBUG] Processing pair (0,1): N=179, M=141
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.397602
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10681.880859
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=141) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6628.616699
[LAV DEBUG]   Pair loss = -27.3976 + 0.01 * (10681.8809 + 6628.6167) = 145.7074
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.67GB

[LAV DEBUG] Processing pair (1,0): N=141, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.397602
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=141) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6628.616699
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10681.880859
[LAV DEBUG]   Pair loss = -27.3976 + 0.01 * (6628.6167 + 10681.8809) = 145.7074
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.68GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 291.4148
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.68GB | Reserved: 21.66GB | Peak: 19.53GB
[MEM Before backward] Allocated: 18.68GB | Reserved: 21.66GB | Peak: 19.53GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.66GB | Peak: 19.53GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.66GB | Peak: 19.53GB
[MEM Batch 43 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 44 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.06GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.06GB
[MEM Batch 45 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.56GB
[MEM Batch 46 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 47 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.80GB
[MEM After forward pass] Allocated: 19.24GB | Reserved: 21.86GB | Peak: 19.80GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([379, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.24GB, Reserved: 21.86GB

[LAV DEBUG] Processing pair (0,1): N=130, M=379
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.512653
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.953125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=379) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47881.277344
[LAV DEBUG]   Pair loss = -35.5127 + 0.01 * (5634.9531 + 47881.2773) = 499.6496
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.26GB

[LAV DEBUG] Processing pair (1,0): N=379, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.512653
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=379) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47881.277344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.953125
[LAV DEBUG]   Pair loss = -35.5127 + 0.01 * (47881.2773 + 5634.9531) = 499.6496
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.29GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 999.2993
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.29GB | Reserved: 21.86GB | Peak: 19.80GB
[MEM Before backward] Allocated: 19.29GB | Reserved: 21.86GB | Peak: 19.80GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.87GB | Peak: 19.80GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.87GB | Peak: 19.80GB
[MEM Batch 48 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.80GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.80GB
[MEM Batch 49 START - Task meccano] Allocated: 17.67GB | Reserved: 21.83GB | Peak: 20.15GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.15GB
[MEM Batch 50 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM After forward pass] Allocated: 19.02GB | Reserved: 21.78GB | Peak: 19.64GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([237, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.02GB, Reserved: 21.78GB

[LAV DEBUG] Processing pair (0,1): N=237, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.992863
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=237) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18724.486328
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.873047
[LAV DEBUG]   Pair loss = -37.9929 + 0.01 * (18724.4863 + 13602.8730) = 285.2807
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.05GB

[LAV DEBUG] Processing pair (1,0): N=202, M=237
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.992863
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.873047
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=237) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18724.486328
[LAV DEBUG]   Pair loss = -37.9929 + 0.01 * (13602.8730 + 18724.4863) = 285.2807
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[2026-02-01 13:54:36,231 - INFO - alignment_training_loop.py:353] - [BATCH 50] Loss value: 570.5615
[2026-02-01 13:54:39,346 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Sandwich.cmu
[2026-02-01 13:54:39,436 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [199, 156]
[2026-02-01 13:54:41,579 - INFO - alignment_training_loop.py:353] - [BATCH 51] Loss value: 365.4540
[2026-02-01 13:54:44,109 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: Salad.cmu
[2026-02-01 13:54:44,292 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [430, 305]
[2026-02-01 13:54:47,222 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [430, 305]
[2026-02-01 13:54:47,626 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Pizza.cmu
[2026-02-01 13:54:47,876 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [351, 458]
[2026-02-01 13:54:50,757 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [351, 458]
[2026-02-01 13:54:51,132 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: Brownie.cmu
[2026-02-01 13:54:51,382 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [418, 359]
[2026-02-01 13:54:54,269 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [418, 359]
[2026-02-01 13:54:54,633 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Cheeseburger.egtea
[2026-02-01 13:54:55,137 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [680, 1138]
[2026-02-01 13:54:58,040 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [680, 1138]
[2026-02-01 13:54:58,449 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: BaconAndEggs.egtea
[2026-02-01 13:54:59,159 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [1835, 839]
[2026-02-01 13:54:59,489 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1835, 839]
[2026-02-01 13:54:59,735 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Sandwich.cmu
[2026-02-01 13:54:59,840 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [224, 189]
[2026-02-01 13:55:02,097 - INFO - alignment_training_loop.py:353] - [BATCH 57] Loss value: 501.3249
[2026-02-01 13:55:05,019 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: pc_assembly
[2026-02-01 13:55:05,291 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [656, 513]
[2026-02-01 13:55:08,134 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [656, 513]
[2026-02-01 13:55:08,527 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Salad.cmu
[2026-02-01 13:55:08,773 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [523, 272]
[2026-02-01 13:55:11,644 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [523, 272]
[2026-02-01 13:55:12,001 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: pc_disassembly
[2026-02-01 13:55:12,229 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [340, 361]
[2026-02-01 13:55:15,110 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [340, 361]
[2026-02-01 13:55:15,482 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: Sandwich.cmu
[2026-02-01 13:55:15,632 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [160, 175]
[LAV DEBUG]   GPU Memory after pair: 19.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 570.5615
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 19.07GB | Reserved: 21.78GB | Peak: 19.64GB
[MEM Before backward] Allocated: 19.07GB | Reserved: 21.78GB | Peak: 19.64GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.78GB | Peak: 19.64GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.78GB | Peak: 19.64GB
[MEM Batch 51 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM After forward pass] Allocated: 18.76GB | Reserved: 21.70GB | Peak: 19.64GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([156, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.76GB, Reserved: 21.70GB

[LAV DEBUG] Processing pair (0,1): N=199, M=156
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.427855
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13201.882812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=156) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8113.604980
[LAV DEBUG]   Pair loss = -30.4279 + 0.01 * (13201.8828 + 8113.6050) = 182.7270
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.78GB

[LAV DEBUG] Processing pair (1,0): N=156, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.427855
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=156) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8113.604980
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13201.882812
[LAV DEBUG]   Pair loss = -30.4279 + 0.01 * (8113.6050 + 13201.8828) = 182.7270
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.79GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 365.4540
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 18.79GB | Reserved: 21.70GB | Peak: 19.64GB
[MEM Before backward] Allocated: 18.79GB | Reserved: 21.70GB | Peak: 19.64GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.70GB | Peak: 19.64GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.70GB | Peak: 19.64GB
[MEM Batch 52 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM Batch 53 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM Batch 54 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.62GB
[MEM Batch 55 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.60GB
[MEM Batch 56 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.52GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.52GB
[MEM Batch 57 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After forward pass] Allocated: 18.94GB | Reserved: 21.75GB | Peak: 19.04GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([189, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.94GB, Reserved: 21.75GB

[LAV DEBUG] Processing pair (0,1): N=224, M=189
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.691833
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=189) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11908.554688
[LAV DEBUG]   Pair loss = -35.6918 + 0.01 * (16726.8750 + 11908.5547) = 250.6624
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.96GB

[LAV DEBUG] Processing pair (1,0): N=189, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.691833
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=189) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11908.554688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.875000
[LAV DEBUG]   Pair loss = -35.6918 + 0.01 * (11908.5547 + 16726.8750) = 250.6624
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.98GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 501.3249
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.98GB | Reserved: 21.75GB | Peak: 19.04GB
[MEM Before backward] Allocated: 18.98GB | Reserved: 21.75GB | Peak: 19.04GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.76GB | Peak: 19.19GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.76GB | Peak: 19.19GB
[MEM Batch 58 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.19GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.19GB
[MEM Batch 59 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.51GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.51GB
[MEM Batch 60 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.61GB
[MEM Batch 61 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM After forward pass] Allocated: 18.70GB | Reserved: 21.68GB | Peak: 19.54GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([160, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.70GB, Reserved: 21.68GB

[LAV DEBUG] Processing pair (0,1): N=160, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.990484
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=160) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8534.920898
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10209.898438
[LAV DEBUG]   Pair loss = -28.9905 + 0.01 * (8534.9209 + 10209.8984) = 158.4577
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.72GB

[LAV DEBUG] Processing pair (1,0): N=175, M=160
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.990484
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10209.898438
[2026-02-01 13:55:17,619 - INFO - alignment_training_loop.py:353] - [BATCH 61] Loss value: 316.9154
[2026-02-01 13:55:19,997 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: GreekSalad.egtea
[2026-02-01 13:55:20,301 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [850, 467]
[2026-02-01 13:55:23,204 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [850, 467]
[2026-02-01 13:55:23,593 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: pc_assembly
[2026-02-01 13:55:23,936 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [574, 656]
[2026-02-01 13:55:26,975 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [574, 656]
[2026-02-01 13:55:27,253 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: Brownie.cmu
[2026-02-01 13:55:27,513 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [335, 528]
[2026-02-01 13:55:30,406 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [335, 528]
[2026-02-01 13:55:30,803 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: Brownie.cmu
[2026-02-01 13:55:31,059 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [403, 416]
[2026-02-01 13:55:33,978 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [403, 416]
[2026-02-01 13:55:34,348 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Sandwich.cmu
[2026-02-01 13:55:34,501 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [214, 145]
[2026-02-01 13:55:36,586 - INFO - alignment_training_loop.py:353] - [BATCH 66] Loss value: 385.1246
[2026-02-01 13:55:39,140 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Salad.cmu
[2026-02-01 13:55:39,289 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [272, 346]
[2026-02-01 13:55:42,172 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 346]
[2026-02-01 13:55:42,536 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: Sandwich.cmu
[2026-02-01 13:55:42,668 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [142, 127]
[2026-02-01 13:55:44,307 - INFO - alignment_training_loop.py:353] - [BATCH 68] Loss value: 195.6721
[2026-02-01 13:55:46,231 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: pc_disassembly
[2026-02-01 13:55:46,390 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [317, 324]
[2026-02-01 13:55:49,327 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [317, 324]
[2026-02-01 13:55:49,695 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: tent
[2026-02-01 13:55:49,758 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: Salad.cmu
[2026-02-01 13:55:49,901 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [224, 396]
[2026-02-01 13:55:52,895 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [224, 396]
[2026-02-01 13:55:53,250 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Sandwich.cmu
[2026-02-01 13:55:53,405 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [213, 168]
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=160) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8534.920898
[LAV DEBUG]   Pair loss = -28.9905 + 0.01 * (10209.8984 + 8534.9209) = 158.4577
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.73GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 316.9154
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.73GB | Reserved: 21.68GB | Peak: 19.54GB
[MEM Before backward] Allocated: 18.73GB | Reserved: 21.68GB | Peak: 19.54GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.68GB | Peak: 19.54GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.68GB | Peak: 19.54GB
[MEM Batch 62 START - Task GreekSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.54GB
[MEM Batch 63 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 64 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.94GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.94GB
[MEM Batch 65 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.66GB
[MEM Batch 66 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM After forward pass] Allocated: 18.78GB | Reserved: 21.70GB | Peak: 19.63GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.78GB, Reserved: 21.70GB

[LAV DEBUG] Processing pair (0,1): N=214, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.205725
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15266.864258
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.936523
[LAV DEBUG]   Pair loss = -30.2057 + 0.01 * (15266.8643 + 7009.9365) = 192.5623
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.79GB

[LAV DEBUG] Processing pair (1,0): N=145, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.205725
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.936523
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15266.864258
[LAV DEBUG]   Pair loss = -30.2057 + 0.01 * (7009.9365 + 15266.8643) = 192.5623
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.81GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 385.1246
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.81GB | Reserved: 21.70GB | Peak: 19.63GB
[MEM Before backward] Allocated: 18.81GB | Reserved: 21.70GB | Peak: 19.63GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.70GB | Peak: 19.63GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.70GB | Peak: 19.63GB
[MEM Batch 67 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 68 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After forward pass] Allocated: 18.50GB | Reserved: 21.61GB | Peak: 19.48GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([142, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([127, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.50GB, Reserved: 21.61GB

[LAV DEBUG] Processing pair (0,1): N=142, M=127
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.172680
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=142) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6722.936035
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=127) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5377.939453
[LAV DEBUG]   Pair loss = -23.1727 + 0.01 * (6722.9360 + 5377.9395) = 97.8361
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.51GB

[LAV DEBUG] Processing pair (1,0): N=127, M=142
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -23.172680
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=127) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5377.939453
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=142) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6722.936035
[LAV DEBUG]   Pair loss = -23.1727 + 0.01 * (5377.9395 + 6722.9360) = 97.8361
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.52GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 195.6721
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.52GB | Reserved: 21.61GB | Peak: 19.48GB
[MEM Before backward] Allocated: 18.52GB | Reserved: 21.61GB | Peak: 19.48GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.62GB | Peak: 19.48GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.62GB | Peak: 19.48GB
[MEM Batch 69 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 70 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.50GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.50GB
[MEM Batch 71 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.50GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.50GB
[MEM Batch 72 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After forward pass] Allocated: 18.84GB | Reserved: 21.72GB | Peak: 19.48GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([213, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.84GB, Reserved: 21.72GB

[LAV DEBUG] Processing pair (0,1): N=213, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.708427
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=213) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15124.533203
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.591797
[LAV DEBUG]   Pair loss = -32.7084 + 0.01 * (15124.5332 + 9409.5918) = 212.6328
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.86GB

[LAV DEBUG] Processing pair (1,0): N=168, M=213
[2026-02-01 13:55:55,607 - INFO - alignment_training_loop.py:353] - [BATCH 72] Loss value: 425.2656
[2026-02-01 13:55:58,329 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Pizza.cmu
[2026-02-01 13:55:58,657 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [839, 585]
[2026-02-01 13:56:01,581 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [839, 585]
[2026-02-01 13:56:01,972 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: Salad.cmu
[2026-02-01 13:56:02,182 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [390, 223]
[2026-02-01 13:56:05,060 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [390, 223]
[2026-02-01 13:56:05,447 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: Brownie.cmu
[2026-02-01 13:56:05,702 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [373, 431]
[2026-02-01 13:56:08,607 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [373, 431]
[2026-02-01 13:56:08,972 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: Pizza.cmu
[2026-02-01 13:56:09,305 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [762, 381]
[2026-02-01 13:56:12,175 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [762, 381]
[2026-02-01 13:56:12,556 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: BaconAndEggs.egtea
[2026-02-01 13:56:13,161 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [1727, 718]
[2026-02-01 13:56:16,188 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1727, 718]
[2026-02-01 13:56:16,631 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: TurkeySandwich.egtea
[2026-02-01 13:56:16,926 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [383, 582]
[2026-02-01 13:56:19,786 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [383, 582]
[2026-02-01 13:56:20,152 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: Pizza.egtea
[2026-02-01 13:56:20,647 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [1236, 693]
[2026-02-01 13:56:23,576 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [1236, 693]
[2026-02-01 13:56:23,992 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: Pizza.cmu
[2026-02-01 13:56:24,320 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [780, 421]
[2026-02-01 13:56:27,160 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [780, 421]
[2026-02-01 13:56:27,542 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: TurkeySandwich.egtea
[2026-02-01 13:56:27,832 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [506, 502]
[2026-02-01 13:56:30,738 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [506, 502]
[2026-02-01 13:56:31,111 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Brownie.cmu
[2026-02-01 13:56:31,370 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [494, 329]
[2026-02-01 13:56:34,240 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [494, 329]
[2026-02-01 13:56:34,611 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Pizza.cmu
[2026-02-01 13:56:34,856 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [529, 236]
[2026-02-01 13:56:37,729 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [529, 236]
[2026-02-01 13:56:38,086 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: pc_assembly
[2026-02-01 13:56:38,442 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [555, 757]
[2026-02-01 13:56:41,427 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [555, 757]
[2026-02-01 13:56:41,791 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Eggs.cmu
[2026-02-01 13:56:41,993 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [282, 271]
[2026-02-01 13:56:45,139 - INFO - alignment_training_loop.py:353] - [BATCH 85] Loss value: 923.4008
[2026-02-01 13:56:49,080 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: TurkeySandwich.egtea
[2026-02-01 13:56:49,526 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [1109, 875]
[2026-02-01 13:56:52,451 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [1109, 875]
[2026-02-01 13:56:52,865 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: Eggs.cmu
[2026-02-01 13:56:53,063 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [339, 229]
[2026-02-01 13:56:56,249 - INFO - alignment_training_loop.py:353] - [BATCH 87] Loss value: 1019.7322
[2026-02-01 13:57:00,305 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: PastaSalad.egtea
[2026-02-01 13:57:01,101 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [2192, 1438]
[2026-02-01 13:57:01,488 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2192, 1438]
[2026-02-01 13:57:01,757 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: BaconAndEggs.egtea
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.708427
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.591797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=213) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15124.533203
[LAV DEBUG]   Pair loss = -32.7084 + 0.01 * (9409.5918 + 15124.5332) = 212.6328
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.88GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 425.2656
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.88GB | Reserved: 21.72GB | Peak: 19.48GB
[MEM Before backward] Allocated: 18.88GB | Reserved: 21.72GB | Peak: 19.48GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.72GB | Peak: 19.48GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.72GB | Peak: 19.48GB
[MEM Batch 73 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 74 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM Batch 75 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 76 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.62GB
[MEM Batch 77 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 78 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.31GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.31GB
[MEM Batch 79 START - Task Pizza.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.74GB
[MEM Batch 80 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.94GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.94GB
[MEM Batch 81 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.60GB
[MEM Batch 82 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.77GB
[MEM Batch 83 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 84 START - Task pc_assembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM Batch 85 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.00GB
[MEM After forward pass] Allocated: 19.37GB | Reserved: 21.91GB | Peak: 20.00GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([282, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([271, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.37GB, Reserved: 21.91GB

[LAV DEBUG] Processing pair (0,1): N=282, M=271
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.211460
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=282) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 26509.427734
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=271) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24481.755859
[LAV DEBUG]   Pair loss = -48.2115 + 0.01 * (26509.4277 + 24481.7559) = 461.7004
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.41GB

[LAV DEBUG] Processing pair (1,0): N=271, M=282
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.211460
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=271) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24481.755859
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=282) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 26509.427734
[LAV DEBUG]   Pair loss = -48.2115 + 0.01 * (24481.7559 + 26509.4277) = 461.7004
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.45GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 923.4008
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 19.45GB | Reserved: 21.91GB | Peak: 20.00GB
[MEM Before backward] Allocated: 19.45GB | Reserved: 21.91GB | Peak: 20.00GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.91GB | Peak: 20.00GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.91GB | Peak: 20.00GB
[MEM Batch 86 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.00GB
[MEM Batch 87 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.84GB
[MEM After forward pass] Allocated: 19.42GB | Reserved: 21.92GB | Peak: 19.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([339, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.42GB, Reserved: 21.92GB

[LAV DEBUG] Processing pair (0,1): N=339, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.032913
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=339) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38308.050781
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17481.847656
[LAV DEBUG]   Pair loss = -48.0329 + 0.01 * (38308.0508 + 17481.8477) = 509.8661
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.46GB

[LAV DEBUG] Processing pair (1,0): N=229, M=339
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.032913
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17481.847656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=339) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38308.050781
[LAV DEBUG]   Pair loss = -48.0329 + 0.01 * (17481.8477 + 38308.0508) = 509.8661
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.50GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1019.7322
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.50GB | Reserved: 21.92GB | Peak: 19.84GB
[MEM Before backward] Allocated: 19.50GB | Reserved: 21.92GB | Peak: 19.84GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.92GB | Peak: 19.84GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.84GB
[MEM Batch 88 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.84GB
[2026-02-01 13:57:02,141 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [856, 826]
[2026-02-01 13:57:04,983 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [856, 826]
[2026-02-01 13:57:05,388 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: tent
[2026-02-01 13:57:05,900 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [721, 1317]
[2026-02-01 13:57:08,713 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [721, 1317]
[2026-02-01 13:57:09,120 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: Eggs.cmu
[2026-02-01 13:57:09,376 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [428, 368]
[2026-02-01 13:57:12,248 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [428, 368]
[2026-02-01 13:57:12,611 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: Pizza.cmu
[2026-02-01 13:57:12,881 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [756, 126]
[2026-02-01 13:57:15,755 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [756, 126]
[2026-02-01 13:57:16,117 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: meccano
[2026-02-01 13:57:16,698 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [1438, 875]
[2026-02-01 13:57:19,659 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1438, 875]
[2026-02-01 13:57:20,080 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: BaconAndEggs.egtea
[2026-02-01 13:57:20,730 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [776, 1825]
[2026-02-01 13:57:23,574 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [776, 1825]
[2026-02-01 13:57:24,009 - INFO - alignment_training_loop.py:417] - Epoch 3 stats - Total: 95, Successful: 16, Skipped (length): 2, Skipped (exception): 77
[2026-02-01 13:57:24,156 - INFO - alignment_training_loop.py:428] - Epoch [3/50], Loss: 552.9755 (357.72s)
[2026-02-01 13:57:24,160 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Pizza.cmu
[2026-02-01 13:57:24,421 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [756, 126]
[2026-02-01 13:57:27,327 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [756, 126]
[2026-02-01 13:57:27,704 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: Pizza.cmu
[2026-02-01 13:57:28,024 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [839, 236]
[2026-02-01 13:57:30,928 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [839, 236]
[2026-02-01 13:57:31,337 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: PastaSalad.egtea
[2026-02-01 13:57:32,202 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [1796, 1728]
[2026-02-01 13:57:32,523 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1796, 1728]
[2026-02-01 13:57:32,800 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Sandwich.cmu
[2026-02-01 13:57:32,890 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [188, 184]
[2026-02-01 13:57:34,957 - INFO - alignment_training_loop.py:353] - [BATCH 3] Loss value: 396.8141
[2026-02-01 13:57:37,579 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Eggs.cmu
[2026-02-01 13:57:37,769 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [428, 355]
[2026-02-01 13:57:40,663 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [428, 355]
[2026-02-01 13:57:41,021 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: TurkeySandwich.egtea
[2026-02-01 13:57:41,315 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [582, 429]
[2026-02-01 13:57:44,390 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [582, 429]
[2026-02-01 13:57:44,625 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: Salad.cmu
[2026-02-01 13:57:44,856 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [396, 329]
[2026-02-01 13:57:47,725 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [396, 329]
[2026-02-01 13:57:48,085 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: PastaSalad.egtea
[2026-02-01 13:57:48,792 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [1497, 1438]
[2026-02-01 13:57:51,748 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1497, 1438]
[2026-02-01 13:57:52,205 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: Eggs.cmu
[2026-02-01 13:57:52,389 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [271, 196]
[2026-02-01 13:57:55,043 - INFO - alignment_training_loop.py:353] - [BATCH 8] Loss value: 666.1740
[2026-02-01 13:57:58,370 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Brownie.cmu
[2026-02-01 13:57:58,545 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [416, 329]
[2026-02-01 13:58:01,443 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [416, 329]
[2026-02-01 13:58:01,807 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Brownie.cmu
[2026-02-01 13:58:02,090 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [621, 294]
[2026-02-01 13:58:04,926 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [621, 294]
[2026-02-01 13:58:05,294 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: BaconAndEggs.egtea
[2026-02-01 13:58:05,795 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [826, 1070]
[2026-02-01 13:58:08,684 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [826, 1070]
[2026-02-01 13:58:09,096 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: pc_disassembly
[2026-02-01 13:58:09,321 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [361, 324]
[2026-02-01 13:58:12,166 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [361, 324]
[2026-02-01 13:58:12,515 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: TurkeySandwich.egtea
[2026-02-01 13:58:12,905 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [327, 1109]
[2026-02-01 13:58:15,838 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [327, 1109]
[2026-02-01 13:58:16,230 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: Salad.cmu
[2026-02-01 13:58:16,433 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [305, 253]
[MEM Batch 89 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.31GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.31GB
[MEM Batch 90 START - Task tent] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 91 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.55GB
[MEM Batch 92 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.61GB
[MEM Batch 93 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 94 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.09GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.09GB
[MEM Batch 0 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.59GB
[MEM Batch 1 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 2 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.64GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.01GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.01GB
[MEM After forward pass] Allocated: 18.82GB | Reserved: 21.71GB | Peak: 19.01GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.82GB, Reserved: 21.71GB

[LAV DEBUG] Processing pair (0,1): N=188, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.290947
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.891602
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11286.911133
[LAV DEBUG]   Pair loss = -32.2909 + 0.01 * (11782.8916 + 11286.9111) = 198.4071
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.83GB

[LAV DEBUG] Processing pair (1,0): N=184, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.290947
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11286.911133
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.891602
[LAV DEBUG]   Pair loss = -32.2909 + 0.01 * (11286.9111 + 11782.8916) = 198.4071
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.85GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 396.8141
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 18.85GB | Reserved: 21.71GB | Peak: 19.01GB
[MEM Before backward] Allocated: 18.85GB | Reserved: 21.71GB | Peak: 19.01GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.71GB | Peak: 19.07GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.71GB | Peak: 19.07GB
[MEM Batch 4 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.07GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.07GB
[MEM Batch 5 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.60GB
[MEM Batch 6 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.77GB
[MEM Batch 7 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.56GB
[MEM Batch 8 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.13GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.13GB
[MEM After forward pass] Allocated: 19.11GB | Reserved: 21.82GB | Peak: 20.13GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([271, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.11GB, Reserved: 21.82GB

[LAV DEBUG] Processing pair (0,1): N=271, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.799583
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=271) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24481.779297
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.878906
[LAV DEBUG]   Pair loss = -39.7996 + 0.01 * (24481.7793 + 12806.8789) = 333.0870
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.13GB

[LAV DEBUG] Processing pair (1,0): N=196, M=271
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.799583
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.878906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=271) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24481.779297
[LAV DEBUG]   Pair loss = -39.7996 + 0.01 * (12806.8789 + 24481.7793) = 333.0870
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.16GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 666.1740
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.16GB | Reserved: 21.81GB | Peak: 20.13GB
[MEM Before backward] Allocated: 19.16GB | Reserved: 21.81GB | Peak: 20.13GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.82GB | Peak: 20.13GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.82GB | Peak: 20.13GB
[MEM Batch 9 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.13GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.13GB
[MEM Batch 10 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.57GB
[MEM Batch 11 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 12 START - Task pc_disassembly] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.63GB
[MEM Batch 13 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.53GB
[MEM Batch 14 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 20.09GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.09GB
[MEM After forward pass] Allocated: 19.39GB | Reserved: 21.92GB | Peak: 20.09GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[2026-02-01 13:58:19,537 - INFO - alignment_training_loop.py:353] - [BATCH 14] Loss value: 950.2996
[2026-02-01 13:58:23,521 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: BaconAndEggs.egtea
[2026-02-01 13:58:23,890 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [856, 718]
[2026-02-01 13:58:26,762 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [856, 718]
[2026-02-01 13:58:27,161 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: PastaSalad.egtea
[2026-02-01 13:58:28,011 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [906, 2492]
[2026-02-01 13:58:30,826 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [906, 2492]
[2026-02-01 13:58:31,330 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: Eggs.cmu
[2026-02-01 13:58:31,517 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [229, 264]
[2026-02-01 13:58:34,296 - INFO - alignment_training_loop.py:353] - [BATCH 17] Loss value: 728.7698
[2026-02-01 13:58:37,778 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Cheeseburger.egtea
[2026-02-01 13:58:38,221 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [1138, 680]
[2026-02-01 13:58:41,161 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [1138, 680]
[2026-02-01 13:58:41,577 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: Pizza.cmu
[2026-02-01 13:58:41,829 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [298, 507]
[2026-02-01 13:58:44,701 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [298, 507]
[2026-02-01 13:58:45,063 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: meccano
[2026-02-01 13:58:45,717 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [1833, 845]
[2026-02-01 13:58:46,045 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1833, 845]
[2026-02-01 13:58:46,280 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Sandwich.cmu
[2026-02-01 13:58:46,364 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [168, 133]
[2026-02-01 13:58:48,083 - INFO - alignment_training_loop.py:353] - [BATCH 21] Loss value: 254.6359
[2026-02-01 13:58:50,203 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: PastaSalad.egtea
[2026-02-01 13:58:50,832 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [2196, 543]
[2026-02-01 13:58:51,224 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2196, 543]
[2026-02-01 13:58:51,460 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: Pizza.cmu
[2026-02-01 13:58:51,733 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [593, 529]
[2026-02-01 13:58:54,769 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [593, 529]
[2026-02-01 13:58:54,987 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: Eggs.cmu
[2026-02-01 13:58:55,179 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [246, 292]
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([305, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([253, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.39GB, Reserved: 21.92GB

[LAV DEBUG] Processing pair (0,1): N=305, M=253
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.323467
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=305) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31009.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=253) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21337.794922
[LAV DEBUG]   Pair loss = -48.3235 + 0.01 * (31009.5312 + 21337.7949) = 475.1498
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.43GB

[LAV DEBUG] Processing pair (1,0): N=253, M=305
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.323467
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=253) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21337.794922
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=305) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31009.531250
[LAV DEBUG]   Pair loss = -48.3235 + 0.01 * (21337.7949 + 31009.5312) = 475.1498
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 950.2996
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 19.46GB | Reserved: 21.92GB | Peak: 20.09GB
[MEM Before backward] Allocated: 19.46GB | Reserved: 21.92GB | Peak: 20.09GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.92GB | Peak: 20.09GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 20.09GB
[MEM Batch 15 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.09GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 20.09GB
[MEM Batch 16 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.65GB
[MEM Batch 17 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM After forward pass] Allocated: 19.19GB | Reserved: 21.84GB | Peak: 19.69GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.19GB, Reserved: 21.84GB

[LAV DEBUG] Processing pair (0,1): N=229, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.768230
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17481.832031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 23233.478516
[LAV DEBUG]   Pair loss = -42.7682 + 0.01 * (17481.8320 + 23233.4785) = 364.3849
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.22GB

[LAV DEBUG] Processing pair (1,0): N=264, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.768230
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 23233.478516
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17481.832031
[LAV DEBUG]   Pair loss = -42.7682 + 0.01 * (23233.4785 + 17481.8320) = 364.3849
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.25GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 728.7698
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 19.25GB | Reserved: 21.84GB | Peak: 19.69GB
[MEM Before backward] Allocated: 19.25GB | Reserved: 21.84GB | Peak: 19.69GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.84GB | Peak: 19.69GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.84GB | Peak: 19.69GB
[MEM Batch 18 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.69GB
[MEM Batch 19 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.87GB
[MEM Batch 20 START - Task meccano] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.62GB
[MEM Batch 21 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After forward pass] Allocated: 18.60GB | Reserved: 21.64GB | Peak: 19.04GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.60GB, Reserved: 21.64GB

[LAV DEBUG] Processing pair (0,1): N=168, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -25.757481
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.948242
[LAV DEBUG]   Pair loss = -25.7575 + 0.01 * (9409.5938 + 5897.9482) = 127.3179
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.61GB

[LAV DEBUG] Processing pair (1,0): N=133, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -25.757481
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.948242
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.593750
[LAV DEBUG]   Pair loss = -25.7575 + 0.01 * (5897.9482 + 9409.5938) = 127.3179
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.62GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 254.6359
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 18.62GB | Reserved: 21.64GB | Peak: 19.04GB
[MEM Before backward] Allocated: 18.62GB | Reserved: 21.64GB | Peak: 19.04GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.65GB | Peak: 19.04GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.65GB | Peak: 19.04GB
[MEM Batch 22 START - Task PastaSalad.egtea] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM Batch 23 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.31GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.31GB
[MEM Batch 24 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.86GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM After forward pass] Allocated: 19.33GB | Reserved: 21.90GB | Peak: 19.86GB
[2026-02-01 13:58:58,187 - INFO - alignment_training_loop.py:353] - [BATCH 24] Loss value: 878.6675
[2026-02-01 13:59:01,994 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: Salad.cmu
[2026-02-01 13:59:02,153 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [272, 346]
[2026-02-01 13:59:05,033 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 346]
[2026-02-01 13:59:05,388 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: Brownie.cmu
[2026-02-01 13:59:05,669 - INFO - alignment_training_loop.py:286] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [528, 403]
[2026-02-01 13:59:08,574 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [528, 403]
[2026-02-01 13:59:08,938 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: BaconAndEggs.egtea
[2026-02-01 13:59:09,620 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [1835, 776]
[2026-02-01 13:59:09,949 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1835, 776]
[2026-02-01 13:59:10,185 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: Pizza.cmu
[2026-02-01 13:59:10,451 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [762, 351]
[2026-02-01 13:59:13,224 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [762, 351]
[2026-02-01 13:59:13,591 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: Eggs.cmu
[2026-02-01 13:59:13,794 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [237, 347]
[2026-02-01 13:59:16,573 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [237, 347]
[2026-02-01 13:59:16,878 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: TurkeySandwich.egtea
[2026-02-01 13:59:17,229 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [383, 875]
[2026-02-01 13:59:20,184 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [383, 875]
[2026-02-01 13:59:20,564 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Salad.cmu
[2026-02-01 13:59:20,790 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [408, 272]
[2026-02-01 13:59:23,663 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [408, 272]
[2026-02-01 13:59:24,021 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: Cheeseburger.egtea
[2026-02-01 13:59:24,431 - INFO - alignment_training_loop.py:286] - [BATCH 32] After preprocessing - Num sequences: 2, Lengths: [670, 844]
[2026-02-01 13:59:27,241 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [670, 844]
[2026-02-01 13:59:27,665 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: ContinentalBreakfast.egtea
[2026-02-01 13:59:27,969 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [445, 543]
[2026-02-01 13:59:30,853 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [445, 543]
[2026-02-01 13:59:31,226 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Brownie.cmu
[2026-02-01 13:59:31,497 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [494, 373]
[2026-02-01 13:59:34,401 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [494, 373]
[2026-02-01 13:59:34,780 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: Sandwich.cmu
[2026-02-01 13:59:34,947 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [224, 175]
[2026-02-01 13:59:37,263 - INFO - alignment_training_loop.py:353] - [BATCH 35] Loss value: 470.2502
[2026-02-01 13:59:40,118 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: Salad.cmu
[2026-02-01 13:59:40,269 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [300, 273]

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([246, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([292, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.33GB, Reserved: 21.90GB

[LAV DEBUG] Processing pair (0,1): N=246, M=292
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.627304
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=246) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 20173.507812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=292) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28422.597656
[LAV DEBUG]   Pair loss = -46.6273 + 0.01 * (20173.5078 + 28422.5977) = 439.3337
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.36GB

[LAV DEBUG] Processing pair (1,0): N=292, M=246
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -46.627304
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=292) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28422.597656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=246) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 20173.507812
[LAV DEBUG]   Pair loss = -46.6273 + 0.01 * (28422.5977 + 20173.5078) = 439.3337
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.40GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 878.6675
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.40GB | Reserved: 21.90GB | Peak: 19.86GB
[MEM Before backward] Allocated: 19.40GB | Reserved: 21.90GB | Peak: 19.86GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.90GB | Peak: 19.86GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.90GB | Peak: 19.86GB
[MEM Batch 25 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.86GB
[MEM Batch 26 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.48GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.48GB
[MEM Batch 27 START - Task BaconAndEggs.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.71GB
[MEM Batch 28 START - Task Pizza.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.04GB
[MEM Batch 29 START - Task Eggs.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.58GB
[MEM Batch 30 START - Task TurkeySandwich.egtea] Allocated: 17.67GB | Reserved: 21.92GB | Peak: 19.42GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.42GB
[MEM Batch 31 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.96GB
[MEM Batch 32 START - Task Cheeseburger.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.52GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.52GB
[MEM Batch 33 START - Task ContinentalBreakfast.egtea] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.52GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.52GB
[MEM Batch 34 START - Task Brownie.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.76GB
[MEM Batch 35 START - Task Sandwich.cmu] Allocated: 17.67GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.66GB
[MEM After forward pass] Allocated: 18.90GB | Reserved: 21.74GB | Peak: 19.66GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.90GB, Reserved: 21.74GB

[LAV DEBUG] Processing pair (0,1): N=224, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -34.242695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10209.904297
[LAV DEBUG]   Pair loss = -34.2427 + 0.01 * (16726.8750 + 10209.9043) = 235.1251
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.92GB

[LAV DEBUG] Processing pair (1,0): N=175, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -34.242695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10209.904297
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.875000
[LAV DEBUG]   Pair loss = -34.2427 + 0.01 * (10209.9043 + 16726.8750) = 235.1251
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 470.2502
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 18.94GB | Reserved: 21.74GB | Peak: 19.66GB
[MEM Before backward] Allocated: 18.94GB | Reserved: 21.74GB | Peak: 19.66GB
[MEM After backward] Allocated: 17.85GB | Reserved: 21.74GB | Peak: 19.66GB
[MEM After optimizer step] Allocated: 17.67GB | Reserved: 21.74GB | Peak: 19.66GB
[MEM Batch 36 START - Task Salad.cmu] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 17.67GB | Reserved: 21.35GB | Peak: 19.66GB
[MEM After forward pass] Allocated: 19.44GB | Reserved: 21.93GB | Peak: 19.66GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([300, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.44GB, Reserved: 21.93GB

[LAV DEBUG] Processing pair (0,1): N=300, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.897747
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=300) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 30001.259766
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24844.451172
[LAV DEBUG]   Pair loss = -49.8977 + 0.01 * (30001.2598 + 24844.4512) = 498.5594
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.47GB

[LAV DEBUG] Processing pair (1,0): N=273, M=300
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.897747
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24844.451172
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=300) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 30001.259766
[LAV DEBUG]   Pair loss = -49.8977 + 0.01 * (24844.4512 + 30001.2598) = 498.5594
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 19.51GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 997.1187
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
[2026-02-01 13:59:43,501 - INFO - alignment_training_loop.py:353] - [BATCH 36] Loss value: 997.1187
[2026-02-01 13:59:43,694 - ERROR - alignment_training_loop.py:364] - [OOM in BACKWARD] Task: Salad.cmu, Loss value: 997.1187
[2026-02-01 13:59:43,813 - INFO - alignment_training_loop.py:396] - [OOM RECOVERED] Memory after cleanup: 19.43GB
[2026-02-01 13:59:43,813 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: Brownie.cmu
[2026-02-01 13:59:43,964 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [418, 224]
[2026-02-01 13:59:44,053 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [418, 224]
[2026-02-01 13:59:44,210 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: tent
[2026-02-01 13:59:44,570 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: Sandwich.cmu
[2026-02-01 13:59:44,662 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [179, 199]
[2026-02-01 13:59:44,709 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [179, 199]
[2026-02-01 13:59:44,854 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: GreekSalad.egtea
[2026-02-01 13:59:45,047 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [364, 467]
[2026-02-01 13:59:45,126 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [364, 467]
[2026-02-01 13:59:45,295 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: Eggs.cmu
[2026-02-01 13:59:45,420 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [202, 282]
[2026-02-01 13:59:45,471 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [202, 282]
[2026-02-01 13:59:45,622 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: pc_disassembly
[2026-02-01 13:59:45,783 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [340, 317]
[2026-02-01 13:59:45,858 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [340, 317]
[2026-02-01 13:59:46,018 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: ContinentalBreakfast.egtea
[2026-02-01 13:59:46,389 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [1167, 469]
[2026-02-01 13:59:46,603 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [1167, 469]
[2026-02-01 13:59:46,809 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: Pizza.cmu
[2026-02-01 13:59:47,000 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [421, 381]
[2026-02-01 13:59:47,089 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [421, 381]
[2026-02-01 13:59:47,258 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: Pizza.cmu
[2026-02-01 13:59:47,536 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [780, 458]
[2026-02-01 13:59:47,688 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [780, 458]
[2026-02-01 13:59:47,873 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Salad.cmu
[2026-02-01 13:59:47,994 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [173, 279]
[2026-02-01 13:59:48,040 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [173, 279]
[2026-02-01 13:59:48,187 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: BaconAndEggs.egtea
[2026-02-01 13:59:49,072 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [2332, 1727]
[2026-02-01 13:59:49,089 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [2332, 1727]
[2026-02-01 13:59:49,413 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: Eggs.cmu
[2026-02-01 13:59:49,582 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [368, 339]
[2026-02-01 13:59:49,663 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [368, 339]
[2026-02-01 13:59:49,826 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: BaconAndEggs.egtea
[2026-02-01 13:59:50,445 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [839, 1825]
[2026-02-01 13:59:50,607 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [839, 1825]
[2026-02-01 13:59:50,846 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: Sandwich.cmu
[2026-02-01 13:59:50,945 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [238, 156]
[2026-02-01 13:59:51,002 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [238, 156]
[2026-02-01 13:59:51,149 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Eggs.cmu
[2026-02-01 13:59:51,318 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [378, 325]
[2026-02-01 13:59:51,400 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [378, 325]
[2026-02-01 13:59:51,557 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: meccano
[2026-02-01 13:59:52,214 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [1410, 1438]
[2026-02-01 13:59:52,480 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1410, 1438]
[2026-02-01 13:59:52,758 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Sandwich.cmu
[2026-02-01 13:59:52,881 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [256, 214]
[2026-02-01 13:59:52,943 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [256, 214]
[2026-02-01 13:59:53,096 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: Pizza.cmu
[2026-02-01 13:59:53,361 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [575, 585]
[2026-02-01 13:59:53,482 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [575, 585]
[2026-02-01 13:59:53,658 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Brownie.cmu
[2026-02-01 13:59:53,829 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [335, 397]
[2026-02-01 13:59:53,903 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [335, 397]
[2026-02-01 13:59:54,062 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: pc_assembly
[2026-02-01 13:59:54,324 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [555, 574]
[2026-02-01 13:59:54,436 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [555, 574]
[2026-02-01 13:59:54,615 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 13:59:54,747 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [181, 349]
[2026-02-01 13:59:54,795 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [181, 349]
[2026-02-01 13:59:54,952 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: PastaSalad.egtea
[2026-02-01 13:59:55,833 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [1401, 2489]
[2026-02-01 13:59:56,086 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1401, 2489]
[2026-02-01 13:59:56,385 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Brownie.cmu
[2026-02-01 13:59:56,555 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [297, 406]
[2026-02-01 13:59:56,627 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [297, 406]
[2026-02-01 13:59:56,786 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: ContinentalBreakfast.egtea
[2026-02-01 13:59:57,000 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [491, 436]
[2026-02-01 13:59:57,107 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [491, 436]
[2026-02-01 13:59:57,278 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: Brownie.cmu
[2026-02-01 13:59:57,512 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [689, 313]
[2026-02-01 13:59:57,648 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [689, 313]
[2026-02-01 13:59:57,826 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: Salad.cmu
[2026-02-01 13:59:57,995 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [390, 306]
[2026-02-01 13:59:58,187 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [390, 306]
[2026-02-01 13:59:58,350 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: meccano
[2026-02-01 13:59:58,712 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [694, 875]
[2026-02-01 13:59:58,849 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [694, 875]
[2026-02-01 13:59:59,047 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: pc_assembly
[2026-02-01 13:59:59,341 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [536, 757]
[2026-02-01 13:59:59,450 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [536, 757]
[2026-02-01 13:59:59,641 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: Pizza.cmu
[2026-02-01 13:59:59,827 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [346, 439]
[2026-02-01 13:59:59,904 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [346, 439]
[2026-02-01 14:00:00,071 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Pizza.egtea
[2026-02-01 14:00:00,391 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [747, 632]
[2026-02-01 14:00:00,542 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [747, 632]
[2026-02-01 14:00:00,733 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Pizza.egtea
[2026-02-01 14:00:01,169 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [693, 1236]
[2026-02-01 14:00:01,306 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [693, 1236]
[2026-02-01 14:00:01,521 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: tent
[2026-02-01 14:00:01,746 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: tent
[2026-02-01 14:00:01,959 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: GreekSalad.egtea
[2026-02-01 14:00:02,261 - INFO - alignment_training_loop.py:286] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [484, 808]
[2026-02-01 14:00:02,362 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [484, 808]
[2026-02-01 14:00:02,546 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: Sandwich.cmu
[2026-02-01 14:00:02,615 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [160, 93]
[2026-02-01 14:00:02,658 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [160, 93]
[2026-02-01 14:00:02,793 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Eggs.cmu
[2026-02-01 14:00:02,931 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [341, 222]
[2026-02-01 14:00:03,006 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [341, 222]
[2026-02-01 14:00:03,159 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Sandwich.cmu
[2026-02-01 14:00:03,240 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [189, 141]
[2026-02-01 14:00:03,289 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [189, 141]
[2026-02-01 14:00:03,439 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: Salad.cmu
[2026-02-01 14:00:03,600 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [430, 224]
[2026-02-01 14:00:03,691 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [430, 224]
[2026-02-01 14:00:03,848 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: Sandwich.cmu
[2026-02-01 14:00:03,920 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [127, 145]
[2026-02-01 14:00:03,958 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [127, 145]
[2026-02-01 14:00:04,094 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: pc_assembly
[2026-02-01 14:00:04,368 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [656, 513]
[2026-02-01 14:00:04,500 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [656, 513]
[2026-02-01 14:00:04,692 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: Brownie.cmu
[2026-02-01 14:00:04,895 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [359, 491]
[2026-02-01 14:00:04,975 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [359, 491]
[2026-02-01 14:00:05,150 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: tent
[2026-02-01 14:00:05,550 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: ContinentalBreakfast.egtea
[2026-02-01 14:00:05,968 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [474, 1343]
[2026-02-01 14:00:06,067 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [474, 1343]
[2026-02-01 14:00:06,285 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: Brownie.cmu
[2026-02-01 14:00:06,472 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [330, 431]
[2026-02-01 14:00:06,545 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [330, 431]
[2026-02-01 14:00:06,707 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: meccano
[2026-02-01 14:00:07,360 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [1598, 1341]
[2026-02-01 14:00:07,649 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1598, 1341]
[2026-02-01 14:00:07,914 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Salad.cmu
============================================================

[MEM After loss computation] Allocated: 19.51GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Before backward] Allocated: 19.51GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 37 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 38 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 39 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 40 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 41 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 42 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM Batch 43 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 44 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.31GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.31GB
[MEM Batch 45 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 46 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM Batch 47 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 48 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 49 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 50 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 51 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM Batch 52 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 53 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM Batch 54 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM Batch 55 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM Batch 56 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM Batch 58 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 59 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.48GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.48GB
[MEM Batch 60 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 61 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 62 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM Batch 63 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.73GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.73GB
[MEM Batch 64 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM Batch 65 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 66 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 67 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM Batch 68 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM Batch 69 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM Batch 70 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.96GB
[MEM Batch 71 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM Batch 72 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM Batch 73 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 74 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM Batch 75 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM Batch 76 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM Batch 77 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 78 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 79 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 80 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 81 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 82 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.63GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.63GB[2026-02-01 14:00:08,091 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [529, 223]
[2026-02-01 14:00:08,203 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [529, 223]
[2026-02-01 14:00:08,373 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Sandwich.cmu
[2026-02-01 14:00:08,459 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [142, 213]
[2026-02-01 14:00:08,500 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [142, 213]
[2026-02-01 14:00:08,640 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: Pizza.cmu
[2026-02-01 14:00:08,878 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [471, 531]
[2026-02-01 14:00:08,976 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [471, 531]
[2026-02-01 14:00:09,159 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Salad.cmu
[2026-02-01 14:00:09,320 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [523, 130]
[2026-02-01 14:00:09,429 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [523, 130]
[2026-02-01 14:00:09,586 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: GreekSalad.egtea
[2026-02-01 14:00:09,945 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [850, 658]
[2026-02-01 14:00:10,110 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [850, 658]
[2026-02-01 14:00:10,312 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: meccano
[2026-02-01 14:00:10,834 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [838, 1474]
[2026-02-01 14:00:10,997 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [838, 1474]
[2026-02-01 14:00:11,235 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: TurkeySandwich.egtea
[2026-02-01 14:00:11,468 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [506, 502]
[2026-02-01 14:00:11,573 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [506, 502]
[2026-02-01 14:00:11,750 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: Brownie.cmu
[2026-02-01 14:00:11,961 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [369, 523]
[2026-02-01 14:00:12,042 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [369, 523]
[2026-02-01 14:00:12,223 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: Salad.cmu
[2026-02-01 14:00:12,419 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [423, 379]
[2026-02-01 14:00:12,510 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [423, 379]
[2026-02-01 14:00:12,706 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: Cheeseburger.egtea
[2026-02-01 14:00:12,928 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [470, 447]
[2026-02-01 14:00:13,026 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [470, 447]
[2026-02-01 14:00:13,196 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: pc_disassembly
[2026-02-01 14:00:13,354 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [295, 314]
[2026-02-01 14:00:13,432 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [295, 314]
[2026-02-01 14:00:13,624 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: pc_assembly
[2026-02-01 14:00:13,882 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [581, 555]
[2026-02-01 14:00:14,000 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [581, 555]
[2026-02-01 14:00:14,186 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: PastaSalad.egtea
[2026-02-01 14:00:14,894 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [989, 2192]
[2026-02-01 14:00:15,077 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [989, 2192]
[2026-02-01 14:00:15,342 - INFO - alignment_training_loop.py:417] - Epoch 4 stats - Total: 95, Successful: 7, Skipped (length): 4, Skipped (exception): 84
[2026-02-01 14:00:15,474 - INFO - alignment_training_loop.py:428] - Epoch [4/50], Loss: 763.2471 (171.32s)
[2026-02-01 14:00:15,478 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Sandwich.cmu
[2026-02-01 14:00:15,552 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [141, 160]
[2026-02-01 14:00:15,593 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [141, 160]
[2026-02-01 14:00:15,736 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: GreekSalad.egtea
[2026-02-01 14:00:15,934 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [467, 364]
[2026-02-01 14:00:16,031 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [467, 364]
[2026-02-01 14:00:16,202 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Eggs.cmu
[2026-02-01 14:00:16,358 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [368, 264]
[2026-02-01 14:00:16,438 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [368, 264]
[2026-02-01 14:00:16,595 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: TurkeySandwich.egtea
[2026-02-01 14:00:16,791 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [327, 502]
[2026-02-01 14:00:16,864 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [327, 502]
[2026-02-01 14:00:17,026 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Eggs.cmu
[2026-02-01 14:00:17,190 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [428, 237]
[2026-02-01 14:00:17,281 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [428, 237]
[2026-02-01 14:00:17,437 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Sandwich.cmu
[2026-02-01 14:00:17,520 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [145, 188]
[2026-02-01 14:00:17,561 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [145, 188]
[2026-02-01 14:00:17,701 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: Eggs.cmu
[2026-02-01 14:00:17,893 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [466, 341]
[2026-02-01 14:00:17,990 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [466, 341]
[2026-02-01 14:00:18,153 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: ContinentalBreakfast.egtea
[2026-02-01 14:00:18,379 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [469, 474]
[2026-02-01 14:00:18,477 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [469, 474]
[2026-02-01 14:00:18,649 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-02-01 14:00:19,003 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [826, 718]
[2026-02-01 14:00:19,164 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [826, 718]
[2026-02-01 14:00:19,369 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: TurkeySandwich.egtea
[2026-02-01 14:00:19,755 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [1109, 582]
[2026-02-01 14:00:19,962 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [1109, 582]
[2026-02-01 14:00:20,170 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Sandwich.cmu
[2026-02-01 14:00:20,248 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [142, 179]
[2026-02-01 14:00:20,289 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [142, 179]
[2026-02-01 14:00:20,434 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: pc_assembly
[2026-02-01 14:00:20,717 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [574, 656]
[2026-02-01 14:00:20,833 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [574, 656]
[2026-02-01 14:00:21,019 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Pizza.cmu
[2026-02-01 14:00:21,246 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [381, 585]
[2026-02-01 14:00:21,329 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [381, 585]
[2026-02-01 14:00:21,500 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Eggs.cmu
[2026-02-01 14:00:21,632 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [222, 292]
[2026-02-01 14:00:21,687 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [222, 292]
[2026-02-01 14:00:21,835 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: Sandwich.cmu
[2026-02-01 14:00:21,928 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [238, 156]
[2026-02-01 14:00:21,986 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [238, 156]
[2026-02-01 14:00:22,129 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Brownie.cmu
[2026-02-01 14:00:22,330 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [418, 403]
[2026-02-01 14:00:22,419 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [418, 403]
[2026-02-01 14:00:22,585 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Salad.cmu
[2026-02-01 14:00:22,774 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [379, 423]
[2026-02-01 14:00:22,856 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [379, 423]
[2026-02-01 14:00:23,041 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: Brownie.cmu
[2026-02-01 14:00:23,216 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [528, 224]
[2026-02-01 14:00:23,325 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [528, 224]
[2026-02-01 14:00:23,485 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Pizza.cmu
[2026-02-01 14:00:23,645 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [529, 126]
[2026-02-01 14:00:23,754 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [529, 126]
[2026-02-01 14:00:23,909 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: pc_assembly
[2026-02-01 14:00:24,206 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [555, 757]
[2026-02-01 14:00:24,319 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [555, 757]
[2026-02-01 14:00:24,505 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: PastaSalad.egtea
[2026-02-01 14:00:25,320 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [2192, 1497]
[2026-02-01 14:00:25,336 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2192, 1497]
[2026-02-01 14:00:25,622 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: tent
[2026-02-01 14:00:26,236 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [1374, 1317]
[2026-02-01 14:00:26,485 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [1374, 1317]
[2026-02-01 14:00:26,727 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Eggs.cmu
[2026-02-01 14:00:26,885 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [347, 339]
[2026-02-01 14:00:26,962 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [347, 339]
[2026-02-01 14:00:27,119 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: BaconAndEggs.egtea
[2026-02-01 14:00:27,559 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [776, 1070]
[2026-02-01 14:00:27,710 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [776, 1070]
[2026-02-01 14:00:27,918 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: Salad.cmu
[2026-02-01 14:00:28,102 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [529, 273]
[2026-02-01 14:00:28,216 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [529, 273]
[2026-02-01 14:00:28,385 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: Brownie.cmu
[2026-02-01 14:00:28,546 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [369, 294]
[2026-02-01 14:00:28,626 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [369, 294]
[2026-02-01 14:00:28,787 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: Brownie.cmu
[2026-02-01 14:00:29,032 - INFO - alignment_training_loop.py:286] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [689, 397]
[2026-02-01 14:00:29,168 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [689, 397]
[2026-02-01 14:00:29,345 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: meccano
[2026-02-01 14:00:29,845 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [1438, 759]
[2026-02-01 14:00:30,104 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1438, 759]
[2026-02-01 14:00:30,348 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: Pizza.cmu
[2026-02-01 14:00:30,528 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [236, 507]
[2026-02-01 14:00:30,585 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [236, 507]
[2026-02-01 14:00:30,746 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: PastaSalad.egtea
[2026-02-01 14:00:31,699 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [2492, 1728]
[2026-02-01 14:00:31,714 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2492, 1728]
[2026-02-01 14:00:32,032 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Eggs.cmu
[2026-02-01 14:00:32,156 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [202, 282]
[2026-02-01 14:00:32,207 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [202, 282]
[2026-02-01 14:00:32,356 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Brownie.cmu
[2026-02-01 14:00:32,560 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [359, 523]
[2026-02-01 14:00:32,638 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [359, 523]
[2026-02-01 14:00:32,804 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: Salad.cmu
[2026-02-01 14:00:32,912 - INFO - alignment_training_loop.py:286] - [BATCH 32] After preprocessing - Num sequences: 2, Lengths: [173, 253]
[2026-02-01 14:00:32,958 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [173, 253]
[2026-02-01 14:00:33,111 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: PastaSalad.egtea
[2026-02-01 14:00:33,640 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [906, 1438]
[2026-02-01 14:00:33,809 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [906, 1438]
[2026-02-01 14:00:34,052 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Pizza.cmu
[2026-02-01 14:00:34,378 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [593, 780]
[2026-02-01 14:00:34,497 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [593, 780]
[2026-02-01 14:00:34,718 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: ContinentalBreakfast.egtea

[MEM Batch 83 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 84 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM Batch 85 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 86 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM Batch 87 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.08GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.08GB
[MEM Batch 88 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 89 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM Batch 90 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 91 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM Batch 92 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 93 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 94 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM Batch 0 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.17GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.17GB
[MEM Batch 1 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM Batch 2 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 3 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 4 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM Batch 5 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM Batch 6 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM Batch 7 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 9 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.06GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.06GB
[MEM Batch 10 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.26GB
[MEM Batch 11 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM Batch 12 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.87GB
[MEM Batch 13 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 14 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM Batch 15 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM Batch 16 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 17 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 18 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM Batch 19 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 20 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM Batch 21 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 22 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.46GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.46GB
[MEM Batch 23 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 24 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM Batch 25 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 26 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 27 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM Batch 28 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.51GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.51GB
[MEM Batch 29 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM Batch 30 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 31 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM Batch 32 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 33 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 34 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.11GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.11GB
[2026-02-01 14:00:34,958 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [543, 445]
[2026-02-01 14:00:35,068 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [543, 445]
[2026-02-01 14:00:35,239 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: Sandwich.cmu
[2026-02-01 14:00:35,301 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [127, 93]
[2026-02-01 14:00:35,340 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [127, 93]
[2026-02-01 14:00:35,472 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: meccano
[2026-02-01 14:00:36,129 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [1410, 1474]
[2026-02-01 14:00:36,384 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1410, 1474]
[2026-02-01 14:00:36,642 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: ContinentalBreakfast.egtea
[2026-02-01 14:00:37,018 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [491, 1167]
[2026-02-01 14:00:37,120 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [491, 1167]
[2026-02-01 14:00:37,321 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: PastaSalad.egtea
[2026-02-01 14:00:38,319 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [2489, 1796]
[2026-02-01 14:00:38,335 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2489, 1796]
[2026-02-01 14:00:38,653 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: tent
[2026-02-01 14:00:39,004 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [768, 721]
[2026-02-01 14:00:39,154 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [768, 721]
[2026-02-01 14:00:39,350 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: BaconAndEggs.egtea
[2026-02-01 14:00:40,204 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [1825, 1835]
[2026-02-01 14:00:40,220 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1825, 1835]
[2026-02-01 14:00:40,534 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: TurkeySandwich.egtea
[2026-02-01 14:00:40,742 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [506, 383]
[2026-02-01 14:00:40,845 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [506, 383]
[2026-02-01 14:00:41,020 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: Eggs.cmu
[2026-02-01 14:00:41,134 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [271, 181]
[2026-02-01 14:00:41,197 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [271, 181]
[2026-02-01 14:00:41,347 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: Pizza.cmu
[2026-02-01 14:00:41,622 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [756, 439]
[2026-02-01 14:00:41,769 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [756, 439]
[2026-02-01 14:00:41,958 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: GreekSalad.egtea
[2026-02-01 14:00:42,260 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [808, 484]
[2026-02-01 14:00:42,416 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [808, 484]
[2026-02-01 14:00:42,606 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Brownie.cmu
[2026-02-01 14:00:42,758 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [297, 335]
[2026-02-01 14:00:42,826 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [297, 335]
[2026-02-01 14:00:42,981 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: tent
[2026-02-01 14:00:42,986 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: BaconAndEggs.egtea
[2026-02-01 14:00:43,391 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [839, 856]
[2026-02-01 14:00:43,552 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [839, 856]
[2026-02-01 14:00:43,764 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: Brownie.cmu
[2026-02-01 14:00:43,920 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [329, 313]
[2026-02-01 14:00:43,993 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [329, 313]
[2026-02-01 14:00:44,151 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: Eggs.cmu
[2026-02-01 14:00:44,262 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [229, 196]
[2026-02-01 14:00:44,319 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [229, 196]
[2026-02-01 14:00:44,471 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Brownie.cmu
[2026-02-01 14:00:44,670 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [330, 491]
[2026-02-01 14:00:44,744 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [330, 491]
[2026-02-01 14:00:44,917 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: BaconAndEggs.egtea
[2026-02-01 14:00:45,818 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [2332, 1727]
[2026-02-01 14:00:45,838 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [2332, 1727]
[2026-02-01 14:00:46,150 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Pizza.cmu
[2026-02-01 14:00:46,333 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [421, 351]
[2026-02-01 14:00:46,431 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [421, 351]
[2026-02-01 14:00:46,599 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: tent
[2026-02-01 14:00:46,605 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: pc_assembly
[2026-02-01 14:00:46,849 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [536, 555]
[2026-02-01 14:00:46,958 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [536, 555]
[2026-02-01 14:00:47,132 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: TurkeySandwich.egtea
[2026-02-01 14:00:47,431 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [429, 875]
[2026-02-01 14:00:47,521 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [429, 875]
[2026-02-01 14:00:47,707 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 14:00:47,857 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [246, 378]
[2026-02-01 14:00:47,916 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [246, 378]
[2026-02-01 14:00:48,077 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: Salad.cmu
[2026-02-01 14:00:48,226 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [306, 305]
[2026-02-01 14:00:48,295 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [306, 305]
[2026-02-01 14:00:48,450 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Pizza.egtea
[2026-02-01 14:00:48,875 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [632, 1236]
[2026-02-01 14:00:49,001 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [632, 1236]
[2026-02-01 14:00:49,212 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: Cheeseburger.egtea
[2026-02-01 14:00:49,476 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [447, 670]
[2026-02-01 14:00:49,570 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [447, 670]
[2026-02-01 14:00:49,753 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: Sandwich.cmu
[2026-02-01 14:00:49,846 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [168, 199]
[2026-02-01 14:00:49,891 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [168, 199]
[2026-02-01 14:00:50,030 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: PastaSalad.egtea
[2026-02-01 14:00:50,558 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [989, 1401]
[2026-02-01 14:00:50,739 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [989, 1401]
[2026-02-01 14:00:50,976 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: Pizza.cmu
[2026-02-01 14:00:51,307 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [531, 839]
[2026-02-01 14:00:51,443 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [531, 839]
[2026-02-01 14:00:51,635 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: Salad.cmu
[2026-02-01 14:00:51,792 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [390, 272]
[2026-02-01 14:00:51,876 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [390, 272]
[2026-02-01 14:00:52,039 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: Salad.cmu
[2026-02-01 14:00:52,181 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [272, 279]
[2026-02-01 14:00:52,244 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 279]
[2026-02-01 14:00:52,399 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Pizza.cmu
[2026-02-01 14:00:52,633 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [458, 575]
[2026-02-01 14:00:52,744 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [458, 575]
[2026-02-01 14:00:52,925 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Salad.cmu
[2026-02-01 14:00:53,073 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [396, 224]
[2026-02-01 14:00:53,158 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [396, 224]
[2026-02-01 14:00:53,317 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: Sandwich.cmu
[2026-02-01 14:00:53,413 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [184, 213]
[2026-02-01 14:00:53,461 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [184, 213]
[2026-02-01 14:00:53,605 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: Brownie.cmu
[2026-02-01 14:00:53,844 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [621, 406]
[2026-02-01 14:00:53,966 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [621, 406]
[2026-02-01 14:00:54,141 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: GreekSalad.egtea
[2026-02-01 14:00:54,503 - INFO - alignment_training_loop.py:286] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [658, 850]
[2026-02-01 14:00:54,633 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [658, 850]
[2026-02-01 14:00:54,827 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: meccano
[2026-02-01 14:00:55,217 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [845, 875]
[2026-02-01 14:00:55,380 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [845, 875]
[2026-02-01 14:00:55,582 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Salad.cmu
[2026-02-01 14:00:55,765 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [329, 430]
[2026-02-01 14:00:55,839 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [329, 430]
[2026-02-01 14:00:55,999 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Brownie.cmu
[2026-02-01 14:00:56,195 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [373, 431]
[2026-02-01 14:00:56,276 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [373, 431]
[2026-02-01 14:00:56,450 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: Eggs.cmu
[2026-02-01 14:00:56,629 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [355, 349]
[2026-02-01 14:00:56,708 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [355, 349]
[2026-02-01 14:00:56,898 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: Sandwich.cmu
[2026-02-01 14:00:56,991 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [189, 175]
[2026-02-01 14:00:57,040 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [189, 175]
[2026-02-01 14:00:57,192 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: Cheeseburger.egtea
[2026-02-01 14:00:57,494 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [470, 844]
[2026-02-01 14:00:57,592 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [470, 844]
[2026-02-01 14:00:57,784 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: Sandwich.cmu
[2026-02-01 14:00:57,879 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [133, 214]
[2026-02-01 14:00:57,919 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [133, 214]
[2026-02-01 14:00:58,062 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: Salad.cmu
[2026-02-01 14:00:58,219 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [408, 223]
[2026-02-01 14:00:58,307 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [408, 223]
[2026-02-01 14:00:58,465 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: meccano
[2026-02-01 14:00:59,064 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [1833, 838]
[2026-02-01 14:00:59,080 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1833, 838]
[2026-02-01 14:00:59,332 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: pc_disassembly
[2026-02-01 14:00:59,485 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [317, 314]
[2026-02-01 14:00:59,556 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [317, 314]
[2026-02-01 14:00:59,710 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: Salad.cmu
[2026-02-01 14:00:59,822 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [300, 130]
[2026-02-01 14:00:59,893 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [300, 130]
[2026-02-01 14:01:00,043 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: pc_disassembly
[MEM Batch 35 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.88GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.88GB
[MEM Batch 36 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM Batch 37 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM Batch 38 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM Batch 39 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 40 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 41 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.01GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.01GB
[MEM Batch 42 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 43 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM Batch 44 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM Batch 45 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM Batch 46 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.04GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.04GB
[MEM Batch 47 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 48 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 49 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 50 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 51 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM Batch 52 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 53 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 54 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 55 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.75GB
[MEM Batch 56 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM Batch 58 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.62GB
[MEM Batch 59 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM Batch 60 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.91GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.91GB
[MEM Batch 61 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM Batch 62 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 63 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.17GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.17GB
[MEM Batch 64 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 65 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.73GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.73GB
[MEM Batch 66 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM Batch 67 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.78GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.78GB
[MEM Batch 68 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM Batch 69 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM Batch 70 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.90GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.90GB
[MEM Batch 71 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 72 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 73 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 74 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 75 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 76 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM Batch 77 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 78 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM Batch 79 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM Batch 80 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 81 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[2026-02-01 14:01:00,201 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [295, 340]
[2026-02-01 14:01:00,269 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [295, 340]
[2026-02-01 14:01:00,445 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Pizza.cmu
[2026-02-01 14:01:00,639 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [346, 471]
[2026-02-01 14:01:00,718 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [346, 471]
[2026-02-01 14:01:00,883 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: PastaSalad.egtea
[2026-02-01 14:01:01,518 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [2196, 543]
[2026-02-01 14:01:01,533 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2196, 543]
[2026-02-01 14:01:01,785 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Cheeseburger.egtea
[2026-02-01 14:01:02,220 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [1138, 680]
[2026-02-01 14:01:02,428 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [1138, 680]
[2026-02-01 14:01:02,638 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: Salad.cmu
[2026-02-01 14:01:02,848 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [346, 523]
[2026-02-01 14:01:02,924 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [346, 523]
[2026-02-01 14:01:03,088 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: Pizza.egtea
[2026-02-01 14:01:03,416 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [747, 693]
[2026-02-01 14:01:03,563 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [747, 693]
[2026-02-01 14:01:03,769 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: ContinentalBreakfast.egtea
[2026-02-01 14:01:04,176 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [436, 1343]
[2026-02-01 14:01:04,270 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [436, 1343]
[2026-02-01 14:01:04,487 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: Pizza.cmu
[2026-02-01 14:01:04,692 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [596, 298]
[2026-02-01 14:01:04,813 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [596, 298]
[2026-02-01 14:01:04,989 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: pc_assembly
[2026-02-01 14:01:05,272 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [656, 581]
[2026-02-01 14:01:05,407 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [656, 581]
[2026-02-01 14:01:05,597 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: Brownie.cmu
[2026-02-01 14:01:05,810 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [494, 416]
[2026-02-01 14:01:05,914 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [494, 416]
[2026-02-01 14:01:06,084 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: pc_disassembly
[2026-02-01 14:01:06,248 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [361, 324]
[2026-02-01 14:01:06,327 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [361, 324]
[2026-02-01 14:01:06,487 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: meccano
[2026-02-01 14:01:07,151 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [1341, 1598]
[2026-02-01 14:01:07,399 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1341, 1598]
[2026-02-01 14:01:07,676 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: Sandwich.cmu
[2026-02-01 14:01:07,801 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [256, 224]
[2026-02-01 14:01:07,865 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [256, 224]
[2026-02-01 14:01:08,020 - INFO - alignment_training_loop.py:417] - Epoch 5 stats - Total: 95, Successful: 0, Skipped (length): 2, Skipped (exception): 93
[2026-02-01 14:01:08,161 - INFO - alignment_training_loop.py:428] - Epoch [5/50], Loss: 0.0000 (52.69s)
[2026-02-01 14:01:08,166 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Pizza.egtea
[2026-02-01 14:01:08,495 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [747, 693]
[2026-02-01 14:01:08,641 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [747, 693]
[2026-02-01 14:01:08,845 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: Pizza.egtea
[2026-02-01 14:01:09,276 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [1236, 632]
[2026-02-01 14:01:09,504 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [1236, 632]
[2026-02-01 14:01:09,723 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: GreekSalad.egtea
[2026-02-01 14:01:10,113 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [808, 850]
[2026-02-01 14:01:10,271 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [808, 850]
[2026-02-01 14:01:10,480 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: pc_disassembly
[2026-02-01 14:01:10,630 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [314, 295]
[2026-02-01 14:01:10,701 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [314, 295]
[2026-02-01 14:01:10,856 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Salad.cmu
[2026-02-01 14:01:11,000 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [273, 300]
[2026-02-01 14:01:11,064 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [273, 300]
[2026-02-01 14:01:11,224 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Pizza.cmu
[2026-02-01 14:01:11,449 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [439, 507]
[2026-02-01 14:01:11,543 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [439, 507]
[2026-02-01 14:01:11,725 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: GreekSalad.egtea
[2026-02-01 14:01:11,924 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [484, 364]
[2026-02-01 14:01:12,026 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [484, 364]
[2026-02-01 14:01:12,196 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: TurkeySandwich.egtea
[2026-02-01 14:01:12,377 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [429, 327]
[2026-02-01 14:01:12,469 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [429, 327]
[2026-02-01 14:01:12,633 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: Brownie.cmu
[2026-02-01 14:01:12,809 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [330, 416]
[2026-02-01 14:01:12,883 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [330, 416]
[2026-02-01 14:01:13,050 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: ContinentalBreakfast.egtea
[2026-02-01 14:01:13,424 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [491, 1167]
[2026-02-01 14:01:13,526 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [491, 1167]
[2026-02-01 14:01:13,734 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: pc_disassembly
[2026-02-01 14:01:13,890 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [317, 324]
[2026-02-01 14:01:13,962 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [317, 324]
[2026-02-01 14:01:14,121 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: tent
[2026-02-01 14:01:14,351 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Sandwich.cmu
[2026-02-01 14:01:14,434 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [142, 160]
[2026-02-01 14:01:14,475 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [142, 160]
[2026-02-01 14:01:14,615 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Salad.cmu
[2026-02-01 14:01:14,803 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [253, 523]
[2026-02-01 14:01:14,864 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [253, 523]
[2026-02-01 14:01:15,033 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: GreekSalad.egtea
[2026-02-01 14:01:15,300 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [658, 467]
[2026-02-01 14:01:15,432 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [658, 467]
[2026-02-01 14:01:15,612 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: PastaSalad.egtea
[2026-02-01 14:01:16,435 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [1497, 2192]
[2026-02-01 14:01:16,706 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1497, 2192]
[2026-02-01 14:01:16,994 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Sandwich.cmu
[2026-02-01 14:01:17,078 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [127, 189]
[2026-02-01 14:01:17,117 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [127, 189]
[2026-02-01 14:01:17,254 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: Pizza.cmu
[2026-02-01 14:01:17,582 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [593, 762]
[2026-02-01 14:01:17,702 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [593, 762]
[2026-02-01 14:01:17,910 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Salad.cmu
[2026-02-01 14:01:18,075 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [272, 408]
[2026-02-01 14:01:18,138 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 408]
[2026-02-01 14:01:18,299 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: Brownie.cmu
[2026-02-01 14:01:18,487 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [369, 403]
[2026-02-01 14:01:18,568 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [369, 403]
[2026-02-01 14:01:18,748 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: PastaSalad.egtea
[2026-02-01 14:01:19,715 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [2489, 1728]
[2026-02-01 14:01:19,735 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2489, 1728]
[2026-02-01 14:01:20,049 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Salad.cmu
[2026-02-01 14:01:20,161 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [329, 130]
[2026-02-01 14:01:20,234 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [329, 130]
[2026-02-01 14:01:20,382 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Cheeseburger.egtea
[2026-02-01 14:01:20,687 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [844, 470]
[2026-02-01 14:01:20,851 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [844, 470]
[2026-02-01 14:01:21,037 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: Eggs.cmu
[2026-02-01 14:01:21,201 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [222, 428]
[2026-02-01 14:01:21,256 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [222, 428]
[2026-02-01 14:01:21,410 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: Sandwich.cmu
[2026-02-01 14:01:21,499 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [156, 213]
[2026-02-01 14:01:21,542 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [156, 213]
[2026-02-01 14:01:21,684 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: Eggs.cmu
[2026-02-01 14:01:21,810 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [325, 181]
[2026-02-01 14:01:21,886 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [325, 181]
[2026-02-01 14:01:22,053 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: Eggs.cmu
[2026-02-01 14:01:22,241 - INFO - alignment_training_loop.py:286] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [378, 368]
[2026-02-01 14:01:22,323 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [378, 368]
[2026-02-01 14:01:22,488 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: meccano
[2026-02-01 14:01:23,011 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [1410, 845]
[2026-02-01 14:01:23,269 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1410, 845]
[2026-02-01 14:01:23,501 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: TurkeySandwich.egtea
[2026-02-01 14:01:23,714 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [502, 383]
[2026-02-01 14:01:23,818 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [502, 383]
[2026-02-01 14:01:23,988 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: Brownie.cmu
[2026-02-01 14:01:24,186 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [373, 431]
[2026-02-01 14:01:24,267 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [373, 431]
[2026-02-01 14:01:24,434 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Sandwich.cmu
[2026-02-01 14:01:24,530 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [133, 238]
[2026-02-01 14:01:24,570 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [133, 238]
[2026-02-01 14:01:24,715 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Sandwich.cmu
[2026-02-01 14:01:24,798 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [199, 141]
[2026-02-01 14:01:24,850 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [199, 141]
[2026-02-01 14:01:25,008 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: Pizza.cmu
[2026-02-01 14:01:25,246 - INFO - alignment_training_loop.py:286] - [BATCH 32] After preprocessing - Num sequences: 2, Lengths: [471, 585]
[2026-02-01 14:01:25,344 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [471, 585]
[2026-02-01 14:01:25,527 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: Sandwich.cmu
[2026-02-01 14:01:25,609 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [175, 145]
[2026-02-01 14:01:25,656 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [175, 145]
[2026-02-01 14:01:25,796 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: PastaSalad.egtea
[MEM Batch 82 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 83 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 84 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 85 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 86 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.28GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.28GB
[MEM Batch 87 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 88 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM Batch 89 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM Batch 90 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.89GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.89GB
[MEM Batch 91 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 92 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 93 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.71GB
[MEM Batch 94 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.44GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.44GB
[MEM Batch 0 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM Batch 1 START - Task Pizza.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM Batch 2 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.36GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.36GB
[MEM Batch 3 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.04GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.04GB
[MEM Batch 4 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM Batch 6 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM Batch 7 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.80GB
[MEM Batch 8 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.76GB
[MEM Batch 9 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 10 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 11 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM Batch 12 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM Batch 13 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.55GB
[MEM Batch 14 START - Task GreekSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.63GB
[MEM Batch 15 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 16 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.55GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.55GB
[MEM Batch 17 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM Batch 18 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.88GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.88GB
[MEM Batch 19 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM Batch 20 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 21 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 22 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 23 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 24 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM Batch 25 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.56GB
[MEM Batch 26 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.68GB
[MEM Batch 27 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 28 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.49GB
[MEM Batch 29 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 30 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 31 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.54GB
[MEM Batch 32 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.59GB
[MEM Batch 33 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[2026-02-01 14:01:26,237 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [1401, 543]
[2026-02-01 14:01:26,493 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1401, 543]
[2026-02-01 14:01:26,709 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: Pizza.cmu
[2026-02-01 14:01:27,022 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [756, 529]
[2026-02-01 14:01:27,171 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [756, 529]
[2026-02-01 14:01:27,370 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: BaconAndEggs.egtea
[2026-02-01 14:01:28,023 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [1835, 856]
[2026-02-01 14:01:28,038 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1835, 856]
[2026-02-01 14:01:28,287 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: Brownie.cmu
[2026-02-01 14:01:28,523 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [689, 359]
[2026-02-01 14:01:28,661 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [689, 359]
[2026-02-01 14:01:28,836 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: Salad.cmu
[2026-02-01 14:01:28,984 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [223, 390]
[2026-02-01 14:01:29,039 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [223, 390]
[2026-02-01 14:01:29,193 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: Pizza.cmu
[2026-02-01 14:01:29,381 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [458, 346]
[2026-02-01 14:01:29,477 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [458, 346]
[2026-02-01 14:01:29,643 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: Salad.cmu
[2026-02-01 14:01:29,787 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [379, 224]
[2026-02-01 14:01:29,870 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [379, 224]
[2026-02-01 14:01:30,028 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: TurkeySandwich.egtea
[2026-02-01 14:01:30,342 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [506, 875]
[2026-02-01 14:01:30,447 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [506, 875]
[2026-02-01 14:01:30,641 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: Brownie.cmu
[2026-02-01 14:01:30,862 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [297, 621]
[2026-02-01 14:01:30,930 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [297, 621]
[2026-02-01 14:01:31,100 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: pc_disassembly
[2026-02-01 14:01:31,269 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [340, 361]
[2026-02-01 14:01:31,344 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [340, 361]
[2026-02-01 14:01:31,508 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: TurkeySandwich.egtea
[2026-02-01 14:01:31,896 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [1109, 582]
[2026-02-01 14:01:32,100 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [1109, 582]
[2026-02-01 14:01:32,305 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: meccano
[2026-02-01 14:01:32,643 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [759, 694]
[2026-02-01 14:01:32,792 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [759, 694]
[2026-02-01 14:01:32,987 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Brownie.cmu
[2026-02-01 14:01:33,191 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [313, 528]
[2026-02-01 14:01:33,261 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [313, 528]
[2026-02-01 14:01:33,435 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: ContinentalBreakfast.egtea
[2026-02-01 14:01:33,650 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [474, 436]
[2026-02-01 14:01:33,749 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [474, 436]
[2026-02-01 14:01:33,919 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: Pizza.cmu
[2026-02-01 14:01:34,083 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [126, 575]
[2026-02-01 14:01:34,121 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [126, 575]
[2026-02-01 14:01:34,280 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: tent
[2026-02-01 14:01:34,648 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: Brownie.cmu
[2026-02-01 14:01:34,803 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [294, 329]
[2026-02-01 14:01:34,872 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [294, 329]
[2026-02-01 14:01:35,030 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Salad.cmu
[2026-02-01 14:01:35,198 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [279, 396]
[2026-02-01 14:01:35,264 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [279, 396]
[2026-02-01 14:01:35,422 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: Salad.cmu
[2026-02-01 14:01:35,620 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [529, 305]
[2026-02-01 14:01:35,729 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [529, 305]
[2026-02-01 14:01:35,897 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Brownie.cmu
[2026-02-01 14:01:36,052 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [406, 224]
[2026-02-01 14:01:36,140 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [406, 224]
[2026-02-01 14:01:36,303 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: meccano
[2026-02-01 14:01:36,837 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [1474, 875]
[2026-02-01 14:01:37,105 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1474, 875]
[2026-02-01 14:01:37,339 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Salad.cmu
[2026-02-01 14:01:37,509 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [272, 430]
[2026-02-01 14:01:37,573 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 430]
[2026-02-01 14:01:37,734 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: Pizza.cmu
[2026-02-01 14:01:38,066 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [839, 596]
[2026-02-01 14:01:38,230 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [839, 596]
[2026-02-01 14:01:38,431 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: PastaSalad.egtea
[2026-02-01 14:01:38,856 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [906, 989]
[2026-02-01 14:01:39,026 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [906, 989]
[2026-02-01 14:01:39,242 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: Pizza.cmu
[2026-02-01 14:01:39,454 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [531, 351]
[2026-02-01 14:01:39,563 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [531, 351]
[2026-02-01 14:01:39,731 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: ContinentalBreakfast.egtea
[2026-02-01 14:01:39,950 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [445, 469]
[2026-02-01 14:01:40,044 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [445, 469]
[2026-02-01 14:01:40,237 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: BaconAndEggs.egtea
[2026-02-01 14:01:40,674 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [776, 1070]
[2026-02-01 14:01:40,827 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [776, 1070]
[2026-02-01 14:01:41,059 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: meccano
[2026-02-01 14:01:41,795 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [1833, 1438]
[2026-02-01 14:01:41,811 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1833, 1438]
[2026-02-01 14:01:42,093 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: Sandwich.cmu
[2026-02-01 14:01:42,179 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [214, 93]
[2026-02-01 14:01:42,233 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [214, 93]
[2026-02-01 14:01:42,372 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: Sandwich.cmu
[2026-02-01 14:01:42,465 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [188, 179]
[2026-02-01 14:01:42,513 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [188, 179]
[2026-02-01 14:01:42,655 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: PastaSalad.egtea
[2026-02-01 14:01:43,744 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [2492, 2196]
[2026-02-01 14:01:43,759 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2492, 2196]
[2026-02-01 14:01:44,088 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: Eggs.cmu
[2026-02-01 14:01:44,240 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [347, 271]
[2026-02-01 14:01:44,316 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [347, 271]
[2026-02-01 14:01:44,478 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Brownie.cmu
[2026-02-01 14:01:44,675 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [491, 335]
[2026-02-01 14:01:44,776 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [491, 335]
[2026-02-01 14:01:44,941 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Cheeseburger.egtea
[2026-02-01 14:01:45,215 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [447, 680]
[2026-02-01 14:01:45,308 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [447, 680]
[2026-02-01 14:01:45,489 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: Brownie.cmu
[2026-02-01 14:01:45,699 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [494, 397]
[2026-02-01 14:01:45,801 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [494, 397]
[2026-02-01 14:01:45,967 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: pc_assembly
[2026-02-01 14:01:46,237 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [656, 513]
[2026-02-01 14:01:46,367 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [656, 513]
[2026-02-01 14:01:46,548 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: tent
[2026-02-01 14:01:46,554 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: tent
[2026-02-01 14:01:47,056 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [1374, 721]
[2026-02-01 14:01:47,316 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: tent, Lengths: [1374, 721]
[2026-02-01 14:01:47,536 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Salad.cmu
[2026-02-01 14:01:47,666 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [346, 173]
[2026-02-01 14:01:47,742 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [346, 173]
[2026-02-01 14:01:47,890 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Sandwich.cmu
[2026-02-01 14:01:48,000 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [168, 256]
[2026-02-01 14:01:48,045 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [168, 256]
[2026-02-01 14:01:48,194 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: BaconAndEggs.egtea
[2026-02-01 14:01:48,988 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [1825, 1727]
[2026-02-01 14:01:49,005 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [1825, 1727]
[2026-02-01 14:01:49,288 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: Brownie.cmu
[2026-02-01 14:01:49,509 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [523, 418]
[2026-02-01 14:01:49,616 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [523, 418]
[2026-02-01 14:01:49,787 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: Eggs.cmu
[2026-02-01 14:01:49,952 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [466, 246]
[2026-02-01 14:01:50,048 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [466, 246]
[2026-02-01 14:01:50,207 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: BaconAndEggs.egtea
[2026-02-01 14:01:50,905 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [2332, 826]
[2026-02-01 14:01:50,920 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [2332, 826]
[2026-02-01 14:01:51,188 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: ContinentalBreakfast.egtea
[2026-02-01 14:01:51,626 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [543, 1343]
[2026-02-01 14:01:51,736 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [543, 1343]
[2026-02-01 14:01:51,953 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: Cheeseburger.egtea
[2026-02-01 14:01:52,386 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [670, 1138]
[2026-02-01 14:01:52,519 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [670, 1138]
[2026-02-01 14:01:52,728 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: PastaSalad.egtea
[MEM Batch 34 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 35 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.48GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.48GB
[MEM Batch 36 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.00GB
[MEM Batch 37 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 38 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.95GB
[MEM Batch 39 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.61GB
[MEM Batch 40 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.78GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.78GB
[MEM Batch 41 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.72GB
[MEM Batch 42 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.82GB
[MEM Batch 43 START - Task pc_disassembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 44 START - Task TurkeySandwich.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.69GB
[MEM Batch 45 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.26GB
[MEM Batch 46 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.01GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.01GB
[MEM Batch 47 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.67GB
[MEM Batch 48 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 49 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM Batch 50 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.53GB
[MEM Batch 51 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.66GB
[MEM Batch 52 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.65GB
[MEM Batch 53 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 54 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.74GB
[MEM Batch 55 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.54GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.54GB
[MEM Batch 56 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.64GB
[MEM Batch 57 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.07GB
[MEM Batch 58 START - Task Pizza.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.11GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.11GB
[MEM Batch 59 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.84GB
[MEM Batch 60 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM Batch 61 START - Task meccano] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.02GB
[MEM Batch 62 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 63 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.60GB
[MEM Batch 64 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.58GB
[MEM Batch 65 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 66 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 67 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 68 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.77GB
[MEM Batch 69 START - Task pc_assembly] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.81GB
[MEM Batch 70 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 71 START - Task tent] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.93GB
[MEM Batch 72 START - Task Salad.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.46GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 20.46GB
[MEM Batch 73 START - Task Sandwich.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.70GB
[MEM Batch 74 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.57GB
[MEM Batch 75 START - Task Brownie.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 76 START - Task Eggs.cmu] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.83GB
[MEM Batch 77 START - Task BaconAndEggs.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.79GB
[MEM Batch 78 START - Task ContinentalBreakfast.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.43GB
[MEM Batch 79 START - Task Cheeseburger.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM After preprocess] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.85GB
[MEM Batch 80 START - Task PastaSalad.egtea] Allocated: 19.43GB | Reserved: 21.93GB | Peak: 19.94GB
[2026-02-01 14:01:53,473 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [1438, 1796]
[2026-02-01 14:01:53,732 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [1438, 1796]
[2026-02-01 14:01:54,007 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: Salad.cmu
[2026-02-01 14:01:54,190 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [423, 306]
[2026-02-01 14:01:54,280 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [423, 306]
[2026-02-01 14:01:54,444 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Eggs.cmu
[2026-02-01 14:01:54,584 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [264, 292]
[2026-02-01 14:01:54,645 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [264, 292]
[2026-02-01 14:01:54,800 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: BaconAndEggs.egtea
[2026-02-01 14:01:55,169 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [839, 718]
[2026-02-01 14:01:55,330 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [839, 718]
[2026-02-01 14:01:55,525 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: Eggs.cmu
[2026-02-01 14:01:55,657 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [339, 229]
[2026-02-01 14:01:55,732 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [339, 229]
[2026-02-01 14:01:55,884 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: pc_assembly
[2026-02-01 14:01:56,186 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [757, 581]
[2026-02-01 14:01:56,336 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [757, 581]
[2026-02-01 14:01:56,532 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: Eggs.cmu
[2026-02-01 14:01:56,679 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [237, 355]
[2026-02-01 14:01:56,737 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [237, 355]
[2026-02-01 14:01:56,897 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: pc_assembly
[2026-02-01 14:01:57,155 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [536, 574]
[2026-02-01 14:01:57,265 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [536, 574]
[2026-02-01 14:01:57,444 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: Pizza.cmu
[2026-02-01 14:01:57,686 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [780, 298]
[2026-02-01 14:01:57,837 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [780, 298]
[2026-02-01 14:01:58,013 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: pc_assembly
[2026-02-01 14:01:58,262 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [555, 555]
[2026-02-01 14:01:58,373 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: pc_assembly, Lengths: [555, 555]
[2026-02-01 14:01:58,552 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: Eggs.cmu
[2026-02-01 14:01:58,687 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [349, 196]
[2026-02-01 14:01:58,764 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [349, 196]
[2026-02-01 14:01:58,914 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: Eggs.cmu
[2026-02-01 14:01:59,069 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [341, 282]
[2026-02-01 14:01:59,146 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [341, 282]
[2026-02-01 14:01:59,307 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: Pizza.cmu
[2026-02-01 14:01:59,459 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [381, 236]
[2026-02-01 14:01:59,556 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [381, 236]
[2026-02-01 14:01:59,713 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: Sandwich.cmu
[2026-02-01 14:01:59,818 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [224, 184]
[2026-02-01 14:01:59,914 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [224, 184]
[2026-02-01 14:02:00,065 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: meccano
[2026-02-01 14:02:00,612 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [1598, 838]
[2026-02-01 14:02:00,904 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: meccano, Lengths: [1598, 838]
[2026-02-01 14:02:01,145 - INFO - alignment_training_loop.py:417] - Epoch 6 stats - Total: 95, Successful: 0, Skipped (length): 3, Skipped (exception): 92
[2026-02-01 14:02:01,276 - INFO - alignment_training_loop.py:428] - Epoch [6/50], Loss: 0.0000 (53.11s)
[2026-02-01 14:02:06,466 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Pizza.cmu
[2026-02-01 14:02:06,726 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [585, 575]
[2026-02-01 14:02:06,844 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [585, 575]
[2026-02-01 14:02:07,020 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: Salad.cmu
[2026-02-01 14:02:07,238 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [529, 390]
[2026-02-01 14:02:07,346 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [529, 390]
[2026-02-01 14:02:07,518 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Eggs.cmu
[2026-02-01 14:02:07,702 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [282, 466]
[2026-02-01 14:02:07,768 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [282, 466]
[2026-02-01 14:02:07,943 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Salad.cmu
[2026-02-01 14:02:08,084 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [272, 305]
[2026-02-01 14:02:08,148 - ERROR - alignment_training_loop.py:295] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [272, 305]
[2026-02-01 14:02:08,324 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: ContinentalBreakfast.egtea
