[2026-01-31 22:37:23,670 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-01-31 22:37:23,670 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,749 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-01-31 22:37:23,749 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,792 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-01-31 22:37:23,792 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,815 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-01-31 22:37:23,815 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,834 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-01-31 22:37:23,834 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,856 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-01-31 22:37:23,856 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,868 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-01-31 22:37:23,868 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,907 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-01-31 22:37:23,907 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,921 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-01-31 22:37:23,921 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,959 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-01-31 22:37:23,959 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,975 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-01-31 22:37:23,975 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:23,991 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-01-31 22:37:23,991 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:24,009 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-01-31 22:37:24,010 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:24,049 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-01-31 22:37:24,049 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:24,059 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-01-31 22:37:24,059 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:24,094 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-01-31 22:37:24,094 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-31 22:37:25,449 - INFO - alignment_training_loop.py:210] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-01-31 22:37:27,307 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Salad.cmu
[2026-01-31 22:37:27,538 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [379, 306]
[2026-01-31 22:37:34,069 - INFO - alignment_training_loop.py:323] - [BATCH 0] Loss value: 1462.9642
[2026-01-31 22:37:39,875 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-01-31 22:37:41,052 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [1438, 1497]
[2026-01-31 22:37:54,404 - INFO - alignment_training_loop.py:323] - [BATCH 1] Loss value: 28200.0176
[2026-01-31 22:38:14,510 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Sandwich.cmu
[2026-01-31 22:38:14,604 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [199, 127]
[2026-01-31 22:38:16,134 - INFO - alignment_training_loop.py:323] - [BATCH 2] Loss value: 317.2026
[2026-01-31 22:38:18,343 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Sandwich.cmu
[2026-01-31 22:38:18,440 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [256, 93]
[2026-01-31 22:38:20,001 - INFO - alignment_training_loop.py:323] - [BATCH 3] Loss value: 444.8308
[2026-01-31 22:38:22,352 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Sandwich.cmu
[2026-01-31 22:38:22,440 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [175, 145]
[2026-01-31 22:38:23,870 - INFO - alignment_training_loop.py:323] - [BATCH 4] Loss value: 289.1028
[2026-01-31 22:38:26,035 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Pizza.cmu
[2026-01-31 22:38:26,357 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [531, 439]
[2026-01-31 22:38:30,687 - INFO - alignment_training_loop.py:323] - [BATCH 5] Loss value: 2993.0139
[2026-01-31 22:38:37,186 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: PastaSalad.egtea
[2026-01-31 22:38:38,235 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [1728, 543]
[2026-01-31 22:38:48,495 - INFO - alignment_training_loop.py:323] - [BATCH 6] Loss value: 21538.5801
[2026-01-31 22:39:03,817 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Brownie.cmu
[2026-01-31 22:39:03,977 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [294, 313]
[2026-01-31 22:39:06,802 - INFO - alignment_training_loop.py:323] - [BATCH 7] Loss value: 1121.9457
[2026-01-31 22:39:10,901 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-01-31 22:39:11,764 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [1835, 1825]
[2026-01-31 22:39:29,336 - INFO - alignment_training_loop.py:323] - [BATCH 8] Loss value: 43939.5234
[2026-01-31 22:39:29,835 - ERROR - alignment_training_loop.py:334] - [OOM in BACKWARD] Task: BaconAndEggs.egtea, Loss value: 43939.5234
[2026-01-31 22:39:30,160 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Salad.cmu
[2026-01-31 22:39:30,310 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [272, 300]
[2026-01-31 22:39:33,061 - INFO - alignment_training_loop.py:323] - [BATCH 9] Loss value: 992.0068
[2026-01-31 22:39:37,479 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Cheeseburger.egtea
[2026-01-31 22:39:37,827 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [670, 680]
[2026-01-31 22:39:44,086 - INFO - alignment_training_loop.py:323] - [BATCH 10] Loss value: 5827.7124
[2026-01-31 22:39:53,171 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: Pizza.cmu
[2026-01-31 22:39:53,446 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [596, 575]
[2026-01-31 22:39:58,919 - INFO - alignment_training_loop.py:323] - [BATCH 11] Loss value: 4357.6538
[2026-01-31 22:40:06,837 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Salad.cmu
[2026-01-31 22:40:07,009 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [223, 423]
[2026-01-31 22:40:10,043 - INFO - alignment_training_loop.py:323] - [BATCH 12] Loss value: 1416.8722
[2026-01-31 22:40:14,416 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Pizza.cmu
[2026-01-31 22:40:14,665 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [593, 351]
[2026-01-31 22:40:19,088 - INFO - alignment_training_loop.py:323] - [BATCH 13] Loss value: 3000.6880
[2026-01-31 22:40:25,474 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: pc_assembly
[2026-01-31 22:40:25,783 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [513, 757]
[2026-01-31 22:40:31,770 - INFO - alignment_training_loop.py:323] - [BATCH 14] Loss value: 5341.5938
[2026-01-31 22:40:40,378 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Pizza.cmu
[2026-01-31 22:40:40,656 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [762, 346]
[2026-01-31 22:40:45,900 - INFO - alignment_training_loop.py:323] - [BATCH 15] Loss value: 4480.9990
[2026-01-31 22:40:53,405 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Eggs.cmu
[2026-01-31 22:40:53,565 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [355, 264]
[2026-01-31 22:40:56,563 - INFO - alignment_training_loop.py:323] - [BATCH 16] Loss value: 1193.5491
[2026-01-31 22:41:00,775 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-01-31 22:41:01,000 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [383, 502]
[2026-01-31 22:41:05,209 - INFO - alignment_training_loop.py:323] - [BATCH 17] Loss value: 2493.4814
[2026-01-31 22:41:11,232 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Brownie.cmu
[2026-01-31 22:41:11,426 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [431, 335]
[2026-01-31 22:41:15,091 - INFO - alignment_training_loop.py:323] - [BATCH 18] Loss value: 1844.3667
[2026-01-31 22:41:20,328 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: tent
[2026-01-31 22:41:20,335 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: Sandwich.cmu
[2026-01-31 22:41:20,436 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [184, 214]
[2026-01-31 22:41:22,350 - INFO - alignment_training_loop.py:323] - [BATCH 20] Loss value: 459.2508
[2026-01-31 22:41:25,115 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Pizza.cmu
[2026-01-31 22:41:25,385 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [507, 585]
[2026-01-31 22:41:30,675 - INFO - alignment_training_loop.py:323] - [BATCH 21] Loss value: 3779.1711
[2026-01-31 22:41:38,339 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Salad.cmu
[2026-01-31 22:41:38,564 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [346, 523]
[2026-01-31 22:41:42,822 - INFO - alignment_training_loop.py:323] - [BATCH 22] Loss value: 2455.9971
[2026-01-31 22:41:48,936 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-01-31 22:41:49,287 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [875, 582]
[2026-01-31 22:41:56,605 - INFO - alignment_training_loop.py:323] - [BATCH 23] Loss value: 7056.0317
[2026-01-31 22:42:06,971 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: PastaSalad.egtea
[2026-01-31 22:42:08,186 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [2492, 2489]
[2026-01-31 22:42:33,251 - WARNING - alignment_training_loop.py:302] - Skipping batch in task PastaSalad.egtea due to: CUDA out of memory. Tried to allocate 2.96 GiB (GPU 0; 22.16 GiB total capacity; 18.88 GiB already allocated; 1.89 GiB free; 20.04 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2026-01-31 22:42:33,251 - ERROR - alignment_training_loop.py:305] - [OOM] Task: PastaSalad.egtea, Sequences: 2, Lengths: [2492, 2489]
[2026-01-31 22:42:33,427 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: PastaSalad.egtea
[2026-01-31 22:42:34,193 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [1796, 1401]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 2.30GB | Reserved: 2.57GB | Peak: 2.36GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([379, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([306, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.30GB, Reserved: 2.57GB

[LAV DEBUG] Processing pair (0,1): N=379, M=306
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.298622
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=379)...
[LAV DEBUG]   IntraContrast v1 result: 47871.351562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=306)...
[LAV DEBUG]   IntraContrast v2 result: 31206.722656
[LAV DEBUG]   Pair loss = -59.2986 + 0.01 * (47871.3516 + 31206.7227) = 731.4821
[LAV DEBUG]   Pair (0,1) completed in 2.37s
[LAV DEBUG]   GPU Memory after pair: 2.36GB

[LAV DEBUG] Processing pair (1,0): N=306, M=379
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.298622
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=306)...
[LAV DEBUG]   IntraContrast v1 result: 31206.722656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=379)...
[LAV DEBUG]   IntraContrast v2 result: 47871.351562
[LAV DEBUG]   Pair loss = -59.2986 + 0.01 * (31206.7227 + 47871.3516) = 731.4821
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.42GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1462.9642
[LAV DEBUG] Total time: 2.39s
[LAV DEBUG] Avg time per pair: 1.19s
============================================================

[MEM After loss computation] Allocated: 2.42GB | Reserved: 2.69GB | Peak: 2.47GB
[MEM Before backward] Allocated: 2.42GB | Reserved: 2.69GB | Peak: 2.47GB
[MEM After backward] Allocated: 0.38GB | Reserved: 2.91GB | Peak: 2.59GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.91GB | Peak: 2.59GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 2.59GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 2.59GB
[MEM After forward pass] Allocated: 9.61GB | Reserved: 10.37GB | Peak: 9.65GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.61GB, Reserved: 10.37GB

[LAV DEBUG] Processing pair (0,1): N=1438, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -258.002533
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438)...
[LAV DEBUG]   IntraContrast v1 result: 689049.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497)...
[LAV DEBUG]   IntraContrast v2 result: 746751.812500
[LAV DEBUG]   Pair loss = -258.0025 + 0.01 * (689049.5000 + 746751.8125) = 14100.0088
[LAV DEBUG]   Pair (0,1) completed in 0.18s
[LAV DEBUG]   GPU Memory after pair: 10.72GB

[LAV DEBUG] Processing pair (1,0): N=1497, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -258.002533
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497)...
[LAV DEBUG]   IntraContrast v1 result: 746751.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438)...
[LAV DEBUG]   IntraContrast v2 result: 689049.500000
[LAV DEBUG]   Pair loss = -258.0025 + 0.01 * (746751.8125 + 689049.5000) = 14100.0088
[LAV DEBUG]   Pair (1,0) completed in 0.16s
[LAV DEBUG]   GPU Memory after pair: 11.82GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 28200.0176
[LAV DEBUG] Total time: 0.35s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 11.82GB | Reserved: 14.48GB | Peak: 12.78GB
[MEM Before backward] Allocated: 11.82GB | Reserved: 14.48GB | Peak: 12.78GB
[MEM After backward] Allocated: 0.74GB | Reserved: 16.54GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 16.54GB | Peak: 14.84GB
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 1.57GB | Reserved: 1.76GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([127, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.57GB, Reserved: 1.76GB

[LAV DEBUG] Processing pair (0,1): N=199, M=127
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.112371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199)...
[LAV DEBUG]   IntraContrast v1 result: 13195.860352
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=127)...
[LAV DEBUG]   IntraContrast v2 result: 5375.506836
[LAV DEBUG]   Pair loss = -27.1124 + 0.01 * (13195.8604 + 5375.5068) = 158.6013
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.58GB

[LAV DEBUG] Processing pair (1,0): N=127, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.112371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=127)...
[LAV DEBUG]   IntraContrast v1 result: 5375.506836
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199)...
[LAV DEBUG]   IntraContrast v2 result: 13195.860352
[LAV DEBUG]   Pair loss = -27.1124 + 0.01 * (5375.5068 + 13195.8604) = 158.6013
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.60GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 317.2026
[LAV DEBUG] Total time: 0.01s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 1.60GB | Reserved: 1.76GB | Peak: 14.84GB
[MEM Before backward] Allocated: 1.60GB | Reserved: 1.76GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.98GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.98GB | Peak: 14.84GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 1.64GB | Reserved: 1.85GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.64GB, Reserved: 1.85GB

[LAV DEBUG] Processing pair (0,1): N=256, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.751081
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256)...
[LAV DEBUG]   IntraContrast v1 result: 21833.697266
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93)...
[LAV DEBUG]   IntraContrast v2 result: 2882.952148
[LAV DEBUG]   Pair loss = -24.7511 + 0.01 * (21833.6973 + 2882.9521) = 222.4154
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.65GB

[LAV DEBUG] Processing pair (1,0): N=93, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.751081
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93)...
[LAV DEBUG]   IntraContrast v1 result: 2882.952148
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256)...
[LAV DEBUG]   IntraContrast v2 result: 21833.697266
[LAV DEBUG]   Pair loss = -24.7511 + 0.01 * (2882.9521 + 21833.6973) = 222.4154
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 444.8308
[LAV DEBUG] Total time: 0.01s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 1.67GB | Reserved: 1.85GB | Peak: 14.84GB
[MEM Before backward] Allocated: 1.67GB | Reserved: 1.85GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.06GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.06GB | Peak: 14.84GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 1.55GB | Reserved: 1.73GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.55GB, Reserved: 1.73GB

[LAV DEBUG] Processing pair (0,1): N=175, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.518393
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175)...
[LAV DEBUG]   IntraContrast v1 result: 10202.277344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145)...
[LAV DEBUG]   IntraContrast v2 result: 7004.701172
[LAV DEBUG]   Pair loss = -27.5184 + 0.01 * (10202.2773 + 7004.7012) = 144.5514
[LAV DEBUG]   Pair (0,1) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.57GB

[LAV DEBUG] Processing pair (1,0): N=145, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.518393
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145)...
[LAV DEBUG]   IntraContrast v1 result: 7004.701172
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175)...
[LAV DEBUG]   IntraContrast v2 result: 10202.277344
[LAV DEBUG]   Pair loss = -27.5184 + 0.01 * (7004.7012 + 10202.2773) = 144.5514
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 289.1028
[LAV DEBUG] Total time: 0.01s
[LAV DEBUG] Avg time per pair: 0.00s
============================================================

[MEM After loss computation] Allocated: 1.58GB | Reserved: 1.73GB | Peak: 14.84GB
[MEM Before backward] Allocated: 1.58GB | Reserved: 1.73GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.00GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.00GB | Peak: 14.84GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 3.56GB | Reserved: 3.91GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([531, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([439, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.56GB, Reserved: 3.91GB

[LAV DEBUG] Processing pair (0,1): N=531, M=439
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -84.333336
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=531)...
[LAV DEBUG]   IntraContrast v1 result: 93901.570312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=439)...
[LAV DEBUG]   IntraContrast v2 result: 64182.460938
[LAV DEBUG]   Pair loss = -84.3333 + 0.01 * (93901.5703 + 64182.4609) = 1496.5070
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.68GB

[LAV DEBUG] Processing pair (1,0): N=439, M=531
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -84.333336
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=439)...
[LAV DEBUG]   IntraContrast v1 result: 64182.460938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=531)...
[LAV DEBUG]   IntraContrast v2 result: 93901.570312
[LAV DEBUG]   Pair loss = -84.3333 + 0.01 * (64182.4609 + 93901.5703) = 1496.5070
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.80GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2993.0139
[LAV DEBUG] Total time: 0.05s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 3.80GB | Reserved: 4.26GB | Peak: 14.84GB
[MEM Before backward] Allocated: 3.80GB | Reserved: 4.26GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.49GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.49GB | Peak: 14.84GB
[MEM Batch 6 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 7.57GB | Reserved: 8.12GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1728, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.57GB, Reserved: 8.12GB

[LAV DEBUG] Processing pair (0,1): N=1728, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -154.621399
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1728)...
[LAV DEBUG]   IntraContrast v1 result: 994215.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543)...
[LAV DEBUG]   IntraContrast v2 result: 98175.398438
[LAV DEBUG]   Pair loss = -154.6214 + 0.01 * (994215.7500 + 98175.3984) = 10769.2900
[LAV DEBUG]   Pair (0,1) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 8.07GB

[LAV DEBUG] Processing pair (1,0): N=543, M=1728
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -154.621399
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543)...
[LAV DEBUG]   IntraContrast v1 result: 98175.398438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1728)...
[LAV DEBUG]   IntraContrast v2 result: 994215.750000
[LAV DEBUG]   Pair loss = -154.6214 + 0.01 * (98175.3984 + 994215.7500) = 10769.2900
[LAV DEBUG]   Pair (1,0) completed in 0.08s
[LAV DEBUG]   GPU Memory after pair: 8.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 21538.5801
[LAV DEBUG] Total time: 0.19s
[LAV DEBUG] Avg time per pair: 0.09s
============================================================

[MEM After loss computation] Allocated: 8.58GB | Reserved: 9.92GB | Peak: 14.84GB
[MEM Before backward] Allocated: 8.58GB | Reserved: 9.92GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 10.82GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 10.82GB | Peak: 14.84GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 2.44GB | Reserved: 2.68GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([294, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([313, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.44GB, Reserved: 2.68GB

[LAV DEBUG] Processing pair (0,1): N=294, M=313
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.938965
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=294)...
[LAV DEBUG]   IntraContrast v1 result: 28775.939453
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=313)...
[LAV DEBUG]   IntraContrast v2 result: 32615.244141
[LAV DEBUG]   Pair loss = -52.9390 + 0.01 * (28775.9395 + 32615.2441) = 560.9728
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.49GB

[LAV DEBUG] Processing pair (1,0): N=313, M=294
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.938965
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=313)...
[LAV DEBUG]   IntraContrast v1 result: 32615.244141
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=294)...
[LAV DEBUG]   IntraContrast v2 result: 28775.939453
[LAV DEBUG]   Pair loss = -52.9390 + 0.01 * (32615.2441 + 28775.9395) = 560.9728
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.53GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1121.9457
[LAV DEBUG] Total time: 0.03s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 2.53GB | Reserved: 2.73GB | Peak: 14.84GB
[MEM Before backward] Allocated: 2.53GB | Reserved: 2.73GB | Peak: 14.84GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.03GB | Peak: 14.84GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.03GB | Peak: 14.84GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 14.84GB
[MEM After forward pass] Allocated: 11.84GB | Reserved: 12.80GB | Peak: 14.84GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1835, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1825, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.84GB, Reserved: 12.80GB

[LAV DEBUG] Processing pair (0,1): N=1835, M=1825
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -321.971130
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1835)...
[LAV DEBUG]   IntraContrast v1 result: 1120677.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1825)...
[LAV DEBUG]   IntraContrast v2 result: 1108495.500000
[LAV DEBUG]   Pair loss = -321.9711 + 0.01 * (1120677.7500 + 1108495.5000) = 21969.7617
[LAV DEBUG]   Pair (0,1) completed in 0.30s
[LAV DEBUG]   GPU Memory after pair: 13.56GB

[LAV DEBUG] Processing pair (1,0): N=1825, M=1835
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -321.971130
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1825)...
[LAV DEBUG]   IntraContrast v1 result: 1108495.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1835)...
[LAV DEBUG]   IntraContrast v2 result: 1120677.750000
[LAV DEBUG]   Pair loss = -321.9711 + 0.01 * (1108495.5000 + 1120677.7500) = 21969.7617
[LAV DEBUG]   Pair (1,0) completed in 0.28s
[LAV DEBUG]   GPU Memory after pair: 15.28GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 43939.5234
[LAV DEBUG] Total time: 0.58s
[LAV DEBUG] Avg time per pair: 0.29s
============================================================

[MEM After loss computation] Allocated: 15.28GB | Reserved: 19.19GB | Peak: 16.77GB
[MEM Before backward] Allocated: 15.28GB | Reserved: 19.19GB | Peak: 16.77GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 15.16GB | Reserved: 17.59GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 15.16GB | Reserved: 17.59GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 16.93GB | Reserved: 18.14GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([300, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 16.93GB, Reserved: 18.14GB

[LAV DEBUG] Processing pair (0,1): N=272, M=300
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.801918
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272)...
[LAV DEBUG]   IntraContrast v1 result: 24624.939453
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=300)...
[LAV DEBUG]   IntraContrast v2 result: 29955.589844
[LAV DEBUG]   Pair loss = -49.8019 + 0.01 * (24624.9395 + 29955.5898) = 496.0034
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 16.97GB

[LAV DEBUG] Processing pair (1,0): N=300, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.801918
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=300)...
[LAV DEBUG]   IntraContrast v1 result: 29955.589844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272)...
[LAV DEBUG]   IntraContrast v2 result: 24624.939453
[LAV DEBUG]   Pair loss = -49.8019 + 0.01 * (29955.5898 + 24624.9395) = 496.0034
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 992.0068
[LAV DEBUG] Total time: 0.02s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 2.41GB | Reserved: 18.14GB | Peak: 18.37GB
[MEM Before backward] Allocated: 2.41GB | Reserved: 18.14GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 18.14GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 18.14GB | Peak: 18.37GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 4.72GB | Reserved: 5.16GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([670, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([680, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.72GB, Reserved: 5.16GB

[LAV DEBUG] Processing pair (0,1): N=670, M=680
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.420860
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=670)...
[LAV DEBUG]   IntraContrast v1 result: 149367.734375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=680)...
[LAV DEBUG]   IntraContrast v2 result: 153859.984375
[LAV DEBUG]   Pair loss = -118.4209 + 0.01 * (149367.7344 + 153859.9844) = 2913.8562
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.96GB

[LAV DEBUG] Processing pair (1,0): N=680, M=670
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.420860
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=680)...
[LAV DEBUG]   IntraContrast v1 result: 153859.984375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=670)...
[LAV DEBUG]   IntraContrast v2 result: 149367.734375
[LAV DEBUG]   Pair loss = -118.4209 + 0.01 * (153859.9844 + 149367.7344) = 2913.8562
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.19GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5827.7124
[LAV DEBUG] Total time: 0.08s
[LAV DEBUG] Avg time per pair: 0.04s
============================================================

[MEM After loss computation] Allocated: 5.19GB | Reserved: 5.82GB | Peak: 18.37GB
[MEM Before backward] Allocated: 5.19GB | Reserved: 5.82GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.26GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.26GB | Peak: 18.37GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 4.18GB | Reserved: 4.50GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([596, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([575, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.18GB, Reserved: 4.50GB

[LAV DEBUG] Processing pair (0,1): N=596, M=575
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -102.629631
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=596)...
[LAV DEBUG]   IntraContrast v1 result: 118163.132812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=575)...
[LAV DEBUG]   IntraContrast v2 result: 109982.515625
[LAV DEBUG]   Pair loss = -102.6296 + 0.01 * (118163.1328 + 109982.5156) = 2178.8269
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.35GB

[LAV DEBUG] Processing pair (1,0): N=575, M=596
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -102.629631
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=575)...
[LAV DEBUG]   IntraContrast v1 result: 109982.515625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=596)...
[LAV DEBUG]   IntraContrast v2 result: 118163.132812
[LAV DEBUG]   Pair loss = -102.6296 + 0.01 * (109982.5156 + 118163.1328) = 2178.8269
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.53GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4357.6538
[LAV DEBUG] Total time: 0.07s
[LAV DEBUG] Avg time per pair: 0.03s
============================================================

[MEM After loss computation] Allocated: 4.53GB | Reserved: 5.00GB | Peak: 18.37GB
[MEM Before backward] Allocated: 4.53GB | Reserved: 5.00GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.33GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.33GB | Peak: 18.37GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 2.56GB | Reserved: 2.88GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([423, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.56GB, Reserved: 2.88GB

[LAV DEBUG] Processing pair (0,1): N=223, M=423
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.988880
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223)...
[LAV DEBUG]   IntraContrast v1 result: 16538.802734
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=423)...
[LAV DEBUG]   IntraContrast v2 result: 59503.699219
[LAV DEBUG]   Pair loss = -51.9889 + 0.01 * (16538.8027 + 59503.6992) = 708.4361
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.61GB

[LAV DEBUG] Processing pair (1,0): N=423, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.988880
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=423)...
[LAV DEBUG]   IntraContrast v1 result: 59503.699219
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223)...
[LAV DEBUG]   IntraContrast v2 result: 16538.802734
[LAV DEBUG]   Pair loss = -51.9889 + 0.01 * (59503.6992 + 16538.8027) = 708.4361
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1416.8722
[LAV DEBUG] Total time: 0.03s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 2.66GB | Reserved: 2.89GB | Peak: 18.37GB
[MEM Before backward] Allocated: 2.66GB | Reserved: 2.89GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.15GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.15GB | Peak: 18.37GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 3.48GB | Reserved: 3.84GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([593, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([351, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.48GB, Reserved: 3.84GB

[LAV DEBUG] Processing pair (0,1): N=593, M=351
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.240479
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=593)...
[LAV DEBUG]   IntraContrast v1 result: 116900.921875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=351)...
[LAV DEBUG]   IntraContrast v2 result: 40957.531250
[LAV DEBUG]   Pair loss = -78.2405 + 0.01 * (116900.9219 + 40957.5312) = 1500.3440
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.58GB

[LAV DEBUG] Processing pair (1,0): N=351, M=593
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.240479
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=351)...
[LAV DEBUG]   IntraContrast v1 result: 40957.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=593)...
[LAV DEBUG]   IntraContrast v2 result: 116900.921875
[LAV DEBUG]   Pair loss = -78.2405 + 0.01 * (40957.5312 + 116900.9219) = 1500.3440
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.69GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3000.6880
[LAV DEBUG] Total time: 0.04s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 3.69GB | Reserved: 4.04GB | Peak: 18.37GB
[MEM Before backward] Allocated: 3.69GB | Reserved: 4.04GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.35GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.35GB | Peak: 18.37GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 4.49GB | Reserved: 4.86GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([513, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([757, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.49GB, Reserved: 4.86GB

[LAV DEBUG] Processing pair (0,1): N=513, M=757
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -108.046394
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=513)...
[LAV DEBUG]   IntraContrast v1 result: 87454.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=757)...
[LAV DEBUG]   IntraContrast v2 result: 190429.812500
[LAV DEBUG]   Pair loss = -108.0464 + 0.01 * (87454.5312 + 190429.8125) = 2670.7969
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.69GB

[LAV DEBUG] Processing pair (1,0): N=757, M=513
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -108.046394
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=757)...
[LAV DEBUG]   IntraContrast v1 result: 190429.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=513)...
[LAV DEBUG]   IntraContrast v2 result: 87454.531250
[LAV DEBUG]   Pair loss = -108.0464 + 0.01 * (190429.8125 + 87454.5312) = 2670.7969
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.89GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5341.5938
[LAV DEBUG] Total time: 0.07s
[LAV DEBUG] Avg time per pair: 0.04s
============================================================

[MEM After loss computation] Allocated: 4.89GB | Reserved: 5.41GB | Peak: 18.37GB
[MEM Before backward] Allocated: 4.89GB | Reserved: 5.41GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.79GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.79GB | Peak: 18.37GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 3.98GB | Reserved: 4.36GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([762, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.98GB, Reserved: 4.36GB

[LAV DEBUG] Processing pair (0,1): N=762, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -85.901344
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=762)...
[LAV DEBUG]   IntraContrast v1 result: 192872.468750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346)...
[LAV DEBUG]   IntraContrast v2 result: 39767.628906
[LAV DEBUG]   Pair loss = -85.9013 + 0.01 * (192872.4688 + 39767.6289) = 2240.4995
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.12GB

[LAV DEBUG] Processing pair (1,0): N=346, M=762
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -85.901344
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346)...
[LAV DEBUG]   IntraContrast v1 result: 39767.628906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=762)...
[LAV DEBUG]   IntraContrast v2 result: 192872.468750
[LAV DEBUG]   Pair loss = -85.9013 + 0.01 * (39767.6289 + 192872.4688) = 2240.4995
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 4.26GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4480.9990
[LAV DEBUG] Total time: 0.05s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 4.26GB | Reserved: 4.74GB | Peak: 18.37GB
[MEM Before backward] Allocated: 4.26GB | Reserved: 4.74GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.00GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.00GB | Peak: 18.37GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 2.48GB | Reserved: 2.71GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([355, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.48GB, Reserved: 2.71GB

[LAV DEBUG] Processing pair (0,1): N=355, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.083649
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=355)...
[LAV DEBUG]   IntraContrast v1 result: 41843.871094
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264)...
[LAV DEBUG]   IntraContrast v2 result: 23141.953125
[LAV DEBUG]   Pair loss = -53.0836 + 0.01 * (41843.8711 + 23141.9531) = 596.7745
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.52GB

[LAV DEBUG] Processing pair (1,0): N=264, M=355
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.083649
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264)...
[LAV DEBUG]   IntraContrast v1 result: 23141.953125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=355)...
[LAV DEBUG]   IntraContrast v2 result: 41843.871094
[LAV DEBUG]   Pair loss = -53.0836 + 0.01 * (23141.9531 + 41843.8711) = 596.7745
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.57GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1193.5491
[LAV DEBUG] Total time: 0.03s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 2.57GB | Reserved: 2.76GB | Peak: 18.37GB
[MEM Before backward] Allocated: 2.57GB | Reserved: 2.76GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.06GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.06GB | Peak: 18.37GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 3.29GB | Reserved: 3.61GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([383, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([502, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.29GB, Reserved: 3.61GB

[LAV DEBUG] Processing pair (0,1): N=383, M=502
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -76.322495
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=383)...
[LAV DEBUG]   IntraContrast v1 result: 48679.128906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=502)...
[LAV DEBUG]   IntraContrast v2 result: 83627.203125
[LAV DEBUG]   Pair loss = -76.3225 + 0.01 * (48679.1289 + 83627.2031) = 1246.7407
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.39GB

[LAV DEBUG] Processing pair (1,0): N=502, M=383
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -76.322495
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=502)...
[LAV DEBUG]   IntraContrast v1 result: 83627.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=383)...
[LAV DEBUG]   IntraContrast v2 result: 48679.128906
[LAV DEBUG]   Pair loss = -76.3225 + 0.01 * (83627.2031 + 48679.1289) = 1246.7407
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.49GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2493.4814
[LAV DEBUG] Total time: 0.04s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 3.49GB | Reserved: 3.81GB | Peak: 18.37GB
[MEM Before backward] Allocated: 3.49GB | Reserved: 3.81GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.10GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.10GB | Peak: 18.37GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 2.93GB | Reserved: 3.20GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([431, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([335, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.93GB, Reserved: 3.20GB

[LAV DEBUG] Processing pair (0,1): N=431, M=335
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.121658
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=431)...
[LAV DEBUG]   IntraContrast v1 result: 61609.386719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=335)...
[LAV DEBUG]   IntraContrast v2 result: 37221.113281
[LAV DEBUG]   Pair loss = -66.1217 + 0.01 * (61609.3867 + 37221.1133) = 922.1833
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.00GB

[LAV DEBUG] Processing pair (1,0): N=335, M=431
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.121658
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=335)...
[LAV DEBUG]   IntraContrast v1 result: 37221.113281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=431)...
[LAV DEBUG]   IntraContrast v2 result: 61609.386719
[LAV DEBUG]   Pair loss = -66.1217 + 0.01 * (37221.1133 + 61609.3867) = 922.1833
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.08GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1844.3667
[LAV DEBUG] Total time: 0.03s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 3.08GB | Reserved: 3.35GB | Peak: 18.37GB
[MEM Before backward] Allocated: 3.08GB | Reserved: 3.35GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.59GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.59GB | Peak: 18.37GB
[MEM Batch 19 START - Task tent] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 1.79GB | Reserved: 2.04GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.79GB, Reserved: 2.04GB

[LAV DEBUG] Processing pair (0,1): N=184, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -34.414104
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184)...
[LAV DEBUG]   IntraContrast v1 result: 11223.256836
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214)...
[LAV DEBUG]   IntraContrast v2 result: 15180.694336
[LAV DEBUG]   Pair loss = -34.4141 + 0.01 * (11223.2568 + 15180.6943) = 229.6254
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.81GB

[LAV DEBUG] Processing pair (1,0): N=214, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -34.414104
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214)...
[LAV DEBUG]   IntraContrast v1 result: 15180.694336
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184)...
[LAV DEBUG]   IntraContrast v2 result: 11223.256836
[LAV DEBUG]   Pair loss = -34.4141 + 0.01 * (15180.6943 + 11223.2568) = 229.6254
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.83GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 459.2508
[LAV DEBUG] Total time: 0.01s
[LAV DEBUG] Avg time per pair: 0.01s
============================================================

[MEM After loss computation] Allocated: 1.83GB | Reserved: 2.04GB | Peak: 18.37GB
[MEM Before backward] Allocated: 1.83GB | Reserved: 2.04GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.25GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.25GB | Peak: 18.37GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 3.93GB | Reserved: 4.32GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([507, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([585, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.93GB, Reserved: 4.32GB

[LAV DEBUG] Processing pair (0,1): N=507, M=585
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -95.288033
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=507)...
[LAV DEBUG]   IntraContrast v1 result: 85138.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=585)...
[LAV DEBUG]   IntraContrast v2 result: 113349.273438
[LAV DEBUG]   Pair loss = -95.2880 + 0.01 * (85138.0938 + 113349.2734) = 1889.5856
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.09GB

[LAV DEBUG] Processing pair (1,0): N=585, M=507
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -95.288033
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=585)...
[LAV DEBUG]   IntraContrast v1 result: 113349.273438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=507)...
[LAV DEBUG]   IntraContrast v2 result: 85138.093750
[LAV DEBUG]   Pair loss = -95.2880 + 0.01 * (113349.2734 + 85138.0938) = 1889.5856
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.24GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3779.1711
[LAV DEBUG] Total time: 0.06s
[LAV DEBUG] Avg time per pair: 0.03s
============================================================

[MEM After loss computation] Allocated: 4.24GB | Reserved: 4.76GB | Peak: 18.37GB
[MEM Before backward] Allocated: 4.24GB | Reserved: 4.76GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.05GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.05GB | Peak: 18.37GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 3.25GB | Reserved: 3.54GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.25GB, Reserved: 3.54GB

[LAV DEBUG] Processing pair (0,1): N=346, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -73.474800
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346)...
[LAV DEBUG]   IntraContrast v1 result: 39621.816406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523)...
[LAV DEBUG]   IntraContrast v2 result: 90525.531250
[LAV DEBUG]   Pair loss = -73.4748 + 0.01 * (39621.8164 + 90525.5312) = 1227.9985
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.34GB

[LAV DEBUG] Processing pair (1,0): N=523, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -73.474800
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523)...
[LAV DEBUG]   IntraContrast v1 result: 90525.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346)...
[LAV DEBUG]   IntraContrast v2 result: 39621.816406
[LAV DEBUG]   Pair loss = -73.4748 + 0.01 * (90525.5312 + 39621.8164) = 1227.9985
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.43GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2455.9971
[LAV DEBUG] Total time: 0.04s
[LAV DEBUG] Avg time per pair: 0.02s
============================================================

[MEM After loss computation] Allocated: 3.43GB | Reserved: 3.72GB | Peak: 18.37GB
[MEM Before backward] Allocated: 3.43GB | Reserved: 3.72GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.01GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.01GB | Peak: 18.37GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 5.06GB | Reserved: 5.43GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([582, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.06GB, Reserved: 5.43GB

[LAV DEBUG] Processing pair (0,1): N=875, M=582
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -123.639824
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875)...
[LAV DEBUG]   IntraContrast v1 result: 253161.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=582)...
[LAV DEBUG]   IntraContrast v2 result: 112004.156250
[LAV DEBUG]   Pair loss = -123.6398 + 0.01 * (253161.4375 + 112004.1562) = 3528.0159
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.33GB

[LAV DEBUG] Processing pair (1,0): N=582, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -123.639824
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=582)...
[LAV DEBUG]   IntraContrast v1 result: 112004.156250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875)...
[LAV DEBUG]   IntraContrast v2 result: 253161.437500
[LAV DEBUG]   Pair loss = -123.6398 + 0.01 * (112004.1562 + 253161.4375) = 3528.0159
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.59GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7056.0317
[LAV DEBUG] Total time: 0.09s
[LAV DEBUG] Avg time per pair: 0.04s
============================================================

[MEM After loss computation] Allocated: 5.59GB | Reserved: 6.16GB | Peak: 18.37GB
[MEM Before backward] Allocated: 5.59GB | Reserved: 6.16GB | Peak: 18.37GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.65GB | Peak: 18.37GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.65GB | Peak: 18.37GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.84GB | Peak: 18.37GB
[MEM After forward pass] Allocated: 15.92GB | Reserved: 17.12GB | Peak: 18.37GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2492, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2489, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 15.92GB, Reserved: 17.12GB

[LAV DEBUG] Processing pair (0,1): N=2492, M=2489
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.96 GiB (GPU 0; 22.16 GiB total capacity; 18.88 GiB already allocated; 1.89 GiB free; 20.04 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managemen
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 15.92GB | Reserved: 17.08GB | Peak: 18.88GB
[MEM After preprocess] Allocated: 15.92GB | Reserved: 17.08GB | Peak: 18.88GB
Traceback (most recent call last):
  File "multitask_train.py", line 150, in <module>
    alignment_training_loop(
  File "/vision/anishn/GTCC_CVPR2024/models/alignment_training_loop.py", line 288, in alignment_training_loop
    output_dict = model(inputs)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_multiprong.py", line 180, in forward
    general_features = self.base_model(videos)['outputs']
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_singleprong.py", line 70, in forward
    conv5 = self.conv_embedding(stack)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 613, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 608, in _conv_forward
    return F.conv3d(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.16 GiB total capacity; 20.46 GiB already allocated; 6.12 MiB free; 21.93 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
