[2026-02-01 00:32:08,246 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-02-01 00:32:08,246 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,276 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-02-01 00:32:08,276 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,306 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-02-01 00:32:08,306 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,325 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-02-01 00:32:08,325 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,341 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-02-01 00:32:08,341 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,359 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-02-01 00:32:08,359 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,370 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-02-01 00:32:08,370 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,406 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-02-01 00:32:08,406 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,417 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-02-01 00:32:08,417 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,451 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-02-01 00:32:08,451 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,465 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-02-01 00:32:08,465 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,480 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-02-01 00:32:08,480 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,496 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-02-01 00:32:08,496 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,534 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-02-01 00:32:08,534 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,544 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-02-01 00:32:08,544 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:08,575 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-02-01 00:32:08,575 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:32:10,541 - INFO - alignment_training_loop.py:210] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-02-01 00:32:12,420 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Salad.cmu
[2026-02-01 00:32:12,649 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [329, 279]
[2026-02-01 00:32:21,328 - INFO - alignment_training_loop.py:323] - [BATCH 0] Loss value: 1134.7788
[2026-02-01 00:32:30,768 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 00:32:31,784 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [989, 1401]
[2026-02-01 00:32:58,395 - INFO - alignment_training_loop.py:323] - [BATCH 1] Loss value: 19192.8516
[2026-02-01 00:33:35,147 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Sandwich.cmu
[2026-02-01 00:33:35,239 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [127, 175]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 2.07GB | Reserved: 2.37GB | Peak: 2.13GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([279, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.07GB, Reserved: 2.37GB

[LAV DEBUG] Processing pair (0,1): N=329, M=279
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.778160
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36073.910156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=279) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 25942.849609
[LAV DEBUG]   Pair loss = -52.7782 + 0.01 * (36073.9102 + 25942.8496) = 567.3894
[LAV DEBUG] [2026-02-01 00:33:40,856 - INFO - alignment_training_loop.py:323] - [BATCH 10] Loss value: 5871.5078
[2026-02-01 00:34:00,627 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: Pizza.cmu
[2026-02-01 00:34:00,872 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [458, 596]
[2026-02-01 00:34:12,424 - INFO - alignment_training_loop.py:323] - [BATCH 11] Loss value: 3584.1748
[2026-02-01 00:34:27,698 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Salad.cmu
[2026-02-01 00:34:27,857 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [300, 305]
[2026-02-01 00:34:34,478 - INFO - alignment_training_loop.py:323] - [BATCH 12] Loss value: 1114.5369
[2026-02-01 00:34:44,234 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Pizza.cmu
[2026-02-01 00:34:44,448 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [507, 351]
[2026-02-01 00:34:54,329 - INFO - alignment_training_loop.py:323] - [BATCH 13] Loss value: 2388.7405
[2026-02-01 00:35:07,544 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: pc_assembly
[2026-02-01 00:35:07,844 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [513, 757]
[2026-02-01 00:35:20,885 - INFO - alignment_training_loop.py:323] - [BATCH 14] Loss value: 5358.3667
[2026-02-01 00:35:40,054 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Pizza.cmu
[2026-02-01 00:35:40,291 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [585, 439]
[2026-02-01 00:35:52,093 - INFO - alignment_training_loop.py:323] - [BATCH 15] Loss value: 3389.6763
[2026-02-01 00:36:07,287 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Eggs.cmu
[2026-02-01 00:36:07,404 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [196, 264]
[2026-02-01 00:36:12,797 - INFO - alignment_training_loop.py:323] - [BATCH 16] Loss value: 642.1175
[2026-02-01 00:36:20,216 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-02-01 00:36:20,532 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [875, 502]
[2026-02-01 00:36:35,965 - INFO - alignment_training_loop.py:323] - [BATCH 17] Loss value: 6556.6001
[2026-02-01 00:36:36,052 - ERROR - alignment_training_loop.py:334] - [OOM in BACKWARD] Task: TurkeySandwich.egtea, Loss value: 6556.6001
[2026-02-01 00:36:36,182 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Brownie.cmu
[2026-02-01 00:36:36,360 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [313, 403]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 1.82GB | Reserved: 2.06GB | Peak: 1.89GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([306, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.82GB, Reserved: 2.06GB

[LAV DEBUG] Processing pair (0,1): N=223, M=306
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.188736
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16574.546875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=306) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31207.181641
[LAV DEBUG]   Pair loss = -45.1887 + 0.01 * (16574.5469 + 31207.1816) = 432.6285
[LAV DEBUG]   Pair (0,1) completed in 1.13s
[LAV DEBUG]   GPU Memory after pair: 1.86GB

[LAV DEBUG] Processing pair (1,0): N=306, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.188736
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=306) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31207.181641
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16574.546875
[LAV DEBUG]   Pair loss = -45.1887 + 0.01 * (31207.1816 + 16574.5469) = 432.6285
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.89GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 865.2571
[LAV DEBUG] Total time: 1.38s
[LAV DEBUG] Avg time per pair: 0.69s
============================================================

[MEM After loss computation] Allocated: 1.89GB | Reserved: 2.02GB | Peak: 1.92GB
[MEM Before backward] Allocated: 1.89GB | Reserved: 2.02GB | Peak: 1.92GB
[MEM After backward] Allocated: 0.38GB | Reserved: 2.44GB | Peak: 2.07GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.44GB | Peak: 2.07GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 2.07GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 2.07GB
[MEM After forward pass] Allocated: 10.42GB | Reserved: 11.26GB | Peak: 10.47GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1796, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1401, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.42GB, Reserved: 11.26GB

[LAV DEBUG] Processing pair (0,1): N=1796, M=1401
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -277.717438
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1075035.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 654164.375000
[LAV DEBUG]   Pair loss = -277.7174 + 0.01 * (1075035.5000 + 654164.3750) = 17014.2812
[LAV DEBUG]   Pair (0,1) completed in 0.23s
[LAV DEBUG]   GPU Memory after pair: 11.64GB

[LAV DEBUG] Processing pair (1,0): N=1401, M=1796
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -277.717438
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 654164.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1075035.500000
[LAV DEBUG]   Pair loss = -277.7174 + 0.01 * (654164.3750 + 1075035.5000) = 17014.2812
[LAV DEBUG]   Pair (1,0) completed in 0.22s
[LAV DEBUG]   GPU Memory after pair: 12.86GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 34028.5625
[LAV DEBUG] Total time: 0.75s
[LAV DEBUG] Avg time per pair: 0.37s
============================================================

[MEM After loss computation] Allocated: 12.86GB | Reserved: 13.67GB | Peak: 14.05GB
[MEM Before backward] Allocated: 12.86GB | Reserved: 13.67GB | Peak: 14.05GB
[MEM After backward] Allocated: 0.74GB | Reserved: 17.29GB | Peak: 16.45GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 17.29GB | Peak: 16.45GB
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After forward pass] Allocated: 1.53GB | Reserved: 1.76GB | Peak: 16.45GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.53GB, Reserved: 1.76GB

[LAV DEBUG] Processing pair (0,1): N=133, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.532047
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.189941
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10680.537109
[LAV DEBUG]   Pair loss = -26.5320 + 0.01 * (5897.1899 + 10680.5371) = 139.2452
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.54GB

[LAV DEBUG] Processing pair (1,0): N=179, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -26.532047
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10680.537109
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.189941
[LAV DEBUG]   Pair loss = -26.5320 + 0.01 * (10680.5371 + 5897.1899) = 139.2452
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 278.4904
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 1.55GB | Reserved: 1.65GB | Peak: 16.45GB
[MEM Before backward] Allocated: 1.55GB | Reserved: 1.65GB | Peak: 16.45GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.98GB | Peak: 16.45GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.98GB | Peak: 16.45GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After forward pass] Allocated: 1.47GB | Reserved: 1.64GB | Peak: 16.45GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.47GB, Reserved: 1.64GB

[LAV DEBUG] Processing pair (0,1): N=199, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -22.488653
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13200.332031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.292969
[LAV DEBUG]   Pair loss = -22.4887 + 0.01 * (13200.3320 + 2884.2930) = 138.3576
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.47GB

[LAV DEBUG] Processing pair (1,0): N=93, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -22.488653
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.292969
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13200.332031
[LAV DEBUG]   Pair loss = -22.4887 + 0.01 * (2884.2930 + 13200.3320) = 138.3576
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.48GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 276.7152
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.48GB | Reserved: 1.55GB | Peak: 16.45GB
[MEM Before backward] Allocated: 1.48GB | Reserved: 1.55GB | Peak: 16.45GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.90GB | Peak: 16.45GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.90GB | Peak: 16.45GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.70GB | Peak: 16.45GB
[MEM After forward pass] Allocated: 1.69GB | Reserved: 1.90GB | Peak: 16.45GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([142, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.69GB, Reserved: 1.90GB

[LAV DEBUG] Processing pair (0,1): N=142, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.456451
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=142) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6722.216797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16725.123047
[LAV DEBUG]   Pair loss = -30.4565 + 0.01 * (6722.2168 + 16725.1230) = 204.0169
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.71GB

[LAV DEBUG] Processing pair (1,0): N=224, M=142
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.456451
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16725.123047
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=142) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6722.216797
[LAV DEBUG]   Pair loss = -30.4565 + 0.01 * (16725.1230 + 6722.2168) = 204.0169
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.72GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 408.0339
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.72GB | Reserved: 1.80GB | Peak: 16.45GB
[MEM Before backward] Allocated: 1.72GB | Reserved: 1.80GB | Peak: 16.45GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.17GB | Peak: 16.45GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.17GB | Peak: 16.45GB
[MEM Ba[2026-02-01 00:36:40,928 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Salad.cmu
[2026-02-01 00:36:41,054 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [253, 223]
[2026-02-01 00:36:43,726 - INFO - alignment_training_loop.py:323] - [BATCH 9] Loss value: 675.6284
[2026-02-01 00:36:47,147 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Cheeseburger.egtea
[2026-02-01 00:36:47,422 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [470, 670]
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.05 GiB (GPU 0; 22.16 GiB total capacity; 15.63 GiB already allocated; 972.12 MiB free; 16.64 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managem
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 13.58GB | Reserved: 14.58GB | Peak: 15.63GB
[MEM After preprocess] Allocated: 13.58GB | Reserved: 14.58GB | Peak: 15.63GB
[MEM After forward pass] Allocated: 3.20GB | Reserved: 17.45GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.20GB, Reserved: 17.45GB

[LAV DEBUG] Processing pair (0,1): N=329, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.415840
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36078.648438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91169.507812
[LAV DEBUG]   Pair loss = -71.4158 + 0.01 * (36078.6484 + 91169.5078) = 1201.0657
[LAV DEBUG]   Pair (0,1) completed in 0.59s
[LAV DEBUG]   GPU Memory after pair: 3.28GB

[LAV DEBUG] Processing pair (1,0): N=523, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -71.415840
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91169.507812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36078.648438
[LAV DEBUG]   Pair loss = -71.4158 + 0.01 * (91169.5078 + 36078.6484) = 1201.0657
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.36GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2402.1313
[LAV DEBUG] Total time: 0.88s
[LAV DEBUG] Avg time per pair: 0.44s
============================================================

[MEM After loss computation] Allocated: 3.36GB | Reserved: 5.27GB | Peak: 16.25GB
[MEM Before backward] Allocated: 3.36GB | Reserved: 5.27GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.27GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.27GB | Peak: 16.25GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 10.30GB | Reserved: 11.07GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([826, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2332, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.30GB, Reserved: 11.07GB

[LAV DEBUG] Processing pair (0,1): N=826, M=2332
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -225.801102
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=826) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 227407.453125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2332) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1812576.375000
[LAV DEBUG]   Pair loss = -225.8011 + 0.01 * (227407.4531 + 1812576.3750) = 20174.0371
[LAV DEBUG]   Pair (0,1) completed in 0.21s
[LAV DEBUG]   GPU Memory after pair: 11.23GB

[LAV DEBUG] Processing pair (1,0): N=2332, M=826
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -225.801102
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2332) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1812576.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=826) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 227407.453125
[LAV DEBUG]   Pair loss = -225.8011 + 0.01 * (1812576.3750 + 227407.4531) = 20174.0371
[LAV DEBUG]   Pair (1,0) completed in 0.20s
[LAV DEBUG]   GPU Memory after pair: 12.17GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 40348.0742
[LAV DEBUG] Total time: 0.69s
[LAV DEBUG] Avg time per pair: 0.34s
============================================================

[MEM After loss computation] Allocated: 12.17GB | Reserved: 12.93GB | Peak: 16.25GB
[MEM Before backward] Allocated: 12.17GB | Reserved: 12.93GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 15.71GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 15.71GB | Peak: 16.25GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 2.03GB | Reserved: 2.28GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([253, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.03GB, Reserved: 2.28GB

[LAV DEBUG] Processing pair (0,1): N=253, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.313786
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=253) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21336.195312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16576.603516
[LAV DEBUG]   Pair loss = -41.3138 + 0.01 * (21336.1953 + 16576.6035) = 337.8142
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.06GB

[LAV DEBUG] Processing pair (1,0): N=223, M=253
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.313786
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16576.603516
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=253) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21336.195312
[LAV DEBUG]   Pair loss = -41.3138 + 0.01 * (16576.6035 + 21336.1953) = 337.8142
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.09GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 675.6284
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.09GB | Reserved: 2.19GB | Peak: 16.25GB
[MEM Before backward] Allocated: 2.09GB | Reserved: 2.19GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.60GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.60GB | Peak: 16.25GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 4.08GB | Reserved: 4.48GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([470, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([670, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.08GB, Reserved: 4.48GB

[LAV DEBUG] Processing pair (0,1): N=470, M=670
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.436821
[2026-02-01 00:36:53,418 - INFO - alignment_training_loop.py:323] - [BATCH 10] Loss value: 4270.1763
[2026-02-01 00:37:01,597 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: Pizza.cmu
[2026-02-01 00:37:01,757 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [381, 236]
[2026-02-01 00:37:05,124 - INFO - alignment_training_loop.py:323] - [BATCH 11] Loss value: 1236.1433
[2026-02-01 00:37:09,554 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Salad.cmu
[2026-02-01 00:37:09,711 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [346, 273]
[2026-02-01 00:37:13,131 - INFO - alignment_training_loop.py:323] - [BATCH 12] Loss value: 1188.0911
[2026-02-01 00:37:17,578 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Pizza.cmu
[2026-02-01 00:37:17,783 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [298, 531]
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=470) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73629.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=670) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 149623.296875
[LAV DEBUG]   Pair loss = -97.4368 + 0.01 * (73629.2031 + 149623.2969) = 2135.0881
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.23GB

[LAV DEBUG] Processing pair (1,0): N=670, M=470
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.436821
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=670) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 149623.296875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=470) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73629.203125
[LAV DEBUG]   Pair loss = -97.4368 + 0.01 * (149623.2969 + 73629.2031) = 2135.0881
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.38GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4270.1763
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.38GB | Reserved: 4.67GB | Peak: 16.25GB
[MEM Before backward] Allocated: 4.38GB | Reserved: 4.67GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.12GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.12GB | Peak: 16.25GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 2.47GB | Reserved: 2.74GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([381, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.47GB, Reserved: 2.74GB

[LAV DEBUG] Processing pair (0,1): N=381, M=236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.435875
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=381) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 48385.128906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18565.625000
[LAV DEBUG]   Pair loss = -51.4359 + 0.01 * (48385.1289 + 18565.6250) = 618.0717
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.51GB

[LAV DEBUG] Processing pair (1,0): N=236, M=381
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.435875
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18565.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=381) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48385.128906
[LAV DEBUG]   Pair loss = -51.4359 + 0.01 * (18565.6250 + 48385.1289) = 618.0717
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1236.1433
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.55GB | Reserved: 2.72GB | Peak: 16.25GB
[MEM Before backward] Allocated: 2.55GB | Reserved: 2.72GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.17GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.17GB | Peak: 16.25GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 2.47GB | Reserved: 2.75GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.47GB, Reserved: 2.75GB

[LAV DEBUG] Processing pair (0,1): N=346, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.427582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39904.339844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24842.972656
[LAV DEBUG]   Pair loss = -53.4276 + 0.01 * (39904.3398 + 24842.9727) = 594.0455
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.52GB

[LAV DEBUG] Processing pair (1,0): N=273, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -53.427582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24842.972656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39904.339844
[LAV DEBUG]   Pair loss = -53.4276 + 0.01 * (24842.9727 + 39904.3398) = 594.0455
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.56GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1188.0911
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.56GB | Reserved: 2.74GB | Peak: 16.25GB
[MEM Before backward] Allocated: 2.56GB | Reserved: 2.74GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.20GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.20GB | Peak: 16.25GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 3.12GB | Reserved: 3.48GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([298, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([531, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.12GB, Reserved: 3.48GB

[LAV DEBUG] Processing pair (0,1): N=298, M=531
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.862091
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=298) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29601.117188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=531) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93982.687500
[LAV DEBUG]   Pair loss = -67.8621 + 0.01 * (29601.1172 + 93982.6875) = 1167.9760
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.20GB

[LAV DEBUG] Processing pair (1,0): N=531, M=298
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.862091
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=531) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93982.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=298) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29601.117188
[LAV DEBUG]   Pair loss = -67.8621 + 0.01 * (93982.6875 + 29601.1172) = 1167.9760
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.28GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2335.9519
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[2026-02-01 00:37:22,237 - INFO - alignment_training_loop.py:323] - [BATCH 13] Loss value: 2335.9519
[2026-02-01 00:37:28,208 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: pc_assembly
[2026-02-01 00:37:28,512 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [555, 757]
[2026-02-01 00:37:35,531 - INFO - alignment_training_loop.py:323] - [BATCH 14] Loss value: 5647.7798
[2026-02-01 00:37:45,007 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Pizza.cmu
[2026-02-01 00:37:45,292 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [421, 756]
[2026-02-01 00:37:51,581 - INFO - alignment_training_loop.py:323] - [BATCH 15] Loss value: 4798.8496
[2026-02-01 00:38:00,078 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Eggs.cmu
[2026-02-01 00:38:00,192 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [229, 202]
[2026-02-01 00:38:02,668 - INFO - alignment_training_loop.py:323] - [BATCH 16] Loss value: 546.9288
[2026-02-01 00:38:05,771 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-02-01 00:38:05,991 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [383, 506]
[MEM After loss computation] Allocated: 3.28GB | Reserved: 3.53GB | Peak: 16.25GB
[MEM Before backward] Allocated: 3.28GB | Reserved: 3.53GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.97GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.97GB | Peak: 16.25GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 4.61GB | Reserved: 5.01GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([555, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([757, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.61GB, Reserved: 5.01GB

[LAV DEBUG] Processing pair (0,1): N=555, M=757
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -112.874107
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=555) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 102670.289062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=757) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 191006.125000
[LAV DEBUG]   Pair loss = -112.8741 + 0.01 * (102670.2891 + 191006.1250) = 2823.8899
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.82GB

[LAV DEBUG] Processing pair (1,0): N=757, M=555
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -112.874107
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=757) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 191006.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=555) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 102670.289062
[LAV DEBUG]   Pair loss = -112.8741 + 0.01 * (191006.1250 + 102670.2891) = 2823.8899
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5647.7798
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.02GB | Reserved: 5.41GB | Peak: 16.25GB
[MEM Before backward] Allocated: 5.02GB | Reserved: 5.41GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.02GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.02GB | Peak: 16.25GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 4.19GB | Reserved: 4.57GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([421, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([756, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.19GB, Reserved: 4.57GB

[LAV DEBUG] Processing pair (0,1): N=421, M=756
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.388702
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=421) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59078.488281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=756) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 190502.859375
[LAV DEBUG]   Pair loss = -96.3887 + 0.01 * (59078.4883 + 190502.8594) = 2399.4248
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.35GB

[LAV DEBUG] Processing pair (1,0): N=756, M=421
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.388702
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=756) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 190502.859375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=421) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59078.488281
[LAV DEBUG]   Pair loss = -96.3887 + 0.01 * (190502.8594 + 59078.4883) = 2399.4248
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.50GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4798.8496
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.50GB | Reserved: 4.87GB | Peak: 16.25GB
[MEM Before backward] Allocated: 4.50GB | Reserved: 4.87GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.33GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.33GB | Peak: 16.25GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 1.89GB | Reserved: 2.16GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.89GB, Reserved: 2.16GB

[LAV DEBUG] Processing pair (0,1): N=229, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.366695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17480.939453
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.168945
[LAV DEBUG]   Pair loss = -37.3667 + 0.01 * (17480.9395 + 13602.1689) = 273.4644
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.92GB

[LAV DEBUG] Processing pair (1,0): N=202, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.366695
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.168945
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17480.939453
[LAV DEBUG]   Pair loss = -37.3667 + 0.01 * (13602.1689 + 17480.9395) = 273.4644
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 546.9288
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 1.94GB | Reserved: 2.05GB | Peak: 16.25GB
[MEM Before backward] Allocated: 1.94GB | Reserved: 2.05GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.36GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.36GB | Peak: 16.25GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 3.30GB | Reserved: 3.65GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([383, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([506, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.30GB, Reserved: 3.65GB

[LAV DEBUG] Processing pair (0,1): N=383, M=506
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -76.610191
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=383) [no_grad]...
[2026-02-01 00:38:10,766 - INFO - alignment_training_loop.py:323] - [BATCH 17] Loss value: 2531.5266
[2026-02-01 00:38:17,209 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Brownie.cmu
[2026-02-01 00:38:17,399 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [313, 431]
[2026-02-01 00:38:21,439 - INFO - alignment_training_loop.py:323] - [BATCH 18] Loss value: 1764.0646
[2026-02-01 00:38:26,804 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: tent
[2026-02-01 00:38:27,163 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [721, 768]
[2026-02-01 00:38:35,060 - INFO - alignment_training_loop.py:323] - [BATCH 19] Loss value: 7136.3369
[2026-02-01 00:38:45,855 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: Sandwich.cmu
[2026-02-01 00:38:45,962 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [256, 145]
[LAV DEBUG]   IntraContrast v1 result: 48895.222656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=506) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85342.140625
[LAV DEBUG]   Pair loss = -76.6102 + 0.01 * (48895.2227 + 85342.1406) = 1265.7633
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.40GB

[LAV DEBUG] Processing pair (1,0): N=506, M=383
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -76.610191
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=506) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85342.140625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=383) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48895.222656
[LAV DEBUG]   Pair loss = -76.6102 + 0.01 * (85342.1406 + 48895.2227) = 1265.7633
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.49GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2531.5266
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.49GB | Reserved: 3.73GB | Peak: 16.25GB
[MEM Before backward] Allocated: 3.49GB | Reserved: 3.73GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.23GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.23GB | Peak: 16.25GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 2.86GB | Reserved: 3.18GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([313, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([431, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.86GB, Reserved: 3.18GB

[LAV DEBUG] Processing pair (0,1): N=313, M=431
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.717739
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=313) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32656.214844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=431) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61918.781250
[LAV DEBUG]   Pair loss = -63.7177 + 0.01 * (32656.2148 + 61918.7812) = 882.0323
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.92GB

[LAV DEBUG] Processing pair (1,0): N=431, M=313
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.717739
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=431) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61918.781250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=313) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32656.214844
[LAV DEBUG]   Pair loss = -63.7177 + 0.01 * (61918.7812 + 32656.2148) = 882.0323
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.99GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1764.0646
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.99GB | Reserved: 3.20GB | Peak: 16.25GB
[MEM Before backward] Allocated: 2.99GB | Reserved: 3.20GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.60GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.60GB | Peak: 16.25GB
[MEM Batch 19 START - Task tent] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 5.15GB | Reserved: 5.55GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([721, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([768, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.15GB, Reserved: 5.55GB

[LAV DEBUG] Processing pair (0,1): N=721, M=768
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.568924
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=721) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 173273.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=768) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 196600.218750
[LAV DEBUG]   Pair loss = -130.5689 + 0.01 * (173273.5312 + 196600.2188) = 3568.1685
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.42GB

[LAV DEBUG] Processing pair (1,0): N=768, M=721
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.568924
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=768) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 196600.218750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=721) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 173273.531250
[LAV DEBUG]   Pair loss = -130.5689 + 0.01 * (196600.2188 + 173273.5312) = 3568.1685
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.69GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7136.3369
[LAV DEBUG] Total time: 0.38s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 5.69GB | Reserved: 6.08GB | Peak: 16.25GB
[MEM Before backward] Allocated: 5.69GB | Reserved: 6.08GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.88GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.88GB | Peak: 16.25GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 1.80GB | Reserved: 2.09GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.80GB, Reserved: 2.09GB

[LAV DEBUG] Processing pair (0,1): N=256, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.651539
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21846.003906
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.660645
[LAV DEBUG]   Pair loss = -32.6515 + 0.01 * (21846.0039 + 7009.6606) = 255.9051
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.82GB

[LAV DEBUG] Processing pair (1,0): N=145, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.651539
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.660645
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21846.003906
[LAV DEBUG]   Pair loss = -32.6515 + 0.01 * (7009.6606 + 21846.0039) = 255.9051
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.84GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 511.8102
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[2026-02-01 00:38:48,295 - INFO - alignment_training_loop.py:323] - [BATCH 20] Loss value: 511.8102
[2026-02-01 00:38:51,188 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Pizza.cmu
[2026-02-01 00:38:51,516 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [839, 529]
[2026-02-01 00:38:58,780 - INFO - alignment_training_loop.py:323] - [BATCH 21] Loss value: 6328.1704
[2026-02-01 00:39:08,664 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Salad.cmu
[2026-02-01 00:39:08,823 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [529, 130]
[2026-02-01 00:39:12,435 - INFO - alignment_training_loop.py:323] - [BATCH 22] Loss value: 1898.7373
[2026-02-01 00:39:17,173 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-02-01 00:39:17,376 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [327, 502]
[2026-02-01 00:39:21,879 - INFO - alignment_training_loop.py:323] - [BATCH 23] Loss value: 2253.0413
[2026-02-01 00:39:27,870 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: PastaSalad.egtea
[2026-02-01 00:39:28,806 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [2489, 1497]
[MEM After loss computation] Allocated: 1.84GB | Reserved: 1.98GB | Peak: 16.25GB
[MEM Before backward] Allocated: 1.84GB | Reserved: 1.98GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.25GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.25GB | Peak: 16.25GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 4.79GB | Reserved: 5.14GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.79GB, Reserved: 5.14GB

[LAV DEBUG] Processing pair (0,1): N=839, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.019249
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234632.234375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93278.226562
[LAV DEBUG]   Pair loss = -115.0192 + 0.01 * (234632.2344 + 93278.2266) = 3164.0852
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.00GB

[LAV DEBUG] Processing pair (1,0): N=529, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.019249
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93278.226562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234632.234375
[LAV DEBUG]   Pair loss = -115.0192 + 0.01 * (93278.2266 + 234632.2344) = 3164.0852
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.22GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6328.1704
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.22GB | Reserved: 5.56GB | Peak: 16.25GB
[MEM Before backward] Allocated: 5.22GB | Reserved: 5.56GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.21GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.21GB | Peak: 16.25GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 2.60GB | Reserved: 2.85GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.60GB, Reserved: 2.85GB

[LAV DEBUG] Processing pair (0,1): N=529, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.761108
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93278.242188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.733398
[LAV DEBUG]   Pair loss = -39.7611 + 0.01 * (93278.2422 + 5634.7334) = 949.3687
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.63GB

[LAV DEBUG] Processing pair (1,0): N=130, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -39.761108
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.733398
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93278.242188
[LAV DEBUG]   Pair loss = -39.7611 + 0.01 * (5634.7334 + 93278.2422) = 949.3687
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1898.7373
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.67GB | Reserved: 2.84GB | Peak: 16.25GB
[MEM Before backward] Allocated: 2.66GB | Reserved: 2.84GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.12GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.12GB | Peak: 16.25GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 3.12GB | Reserved: 3.50GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([327, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([502, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.12GB, Reserved: 3.50GB

[LAV DEBUG] Processing pair (0,1): N=327, M=502
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.906097
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=327) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35643.171875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=502) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 83999.507812
[LAV DEBUG]   Pair loss = -69.9061 + 0.01 * (35643.1719 + 83999.5078) = 1126.5206
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.20GB

[LAV DEBUG] Processing pair (1,0): N=502, M=327
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.906097
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=502) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 83999.507812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=327) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35643.171875
[LAV DEBUG]   Pair loss = -69.9061 + 0.01 * (83999.5078 + 35643.1719) = 1126.5206
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.28GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2253.0413
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.28GB | Reserved: 3.47GB | Peak: 16.25GB
[MEM Before backward] Allocated: 3.28GB | Reserved: 3.47GB | Peak: 16.25GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.93GB | Peak: 16.25GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.93GB | Peak: 16.25GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.67GB | Peak: 16.25GB
[MEM After forward pass] Allocated: 12.86GB | Reserved: 13.85GB | Peak: 16.25GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2489, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 12.86GB, Reserved: 13.85GB

[LAV DEBUG] Processing pair (0,1): N=2489, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -333.146515
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2489) [no_grad]...
[2026-02-01 00:39:50,073 - INFO - alignment_training_loop.py:323] - [BATCH 24] Loss value: 55572.2305
[2026-02-01 00:39:50,510 - ERROR - alignment_training_loop.py:334] - [OOM in BACKWARD] Task: PastaSalad.egtea, Loss value: 55572.2305
[2026-02-01 00:39:50,632 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: PastaSalad.egtea
[2026-02-01 00:39:51,274 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [906, 1796]
[LAV DEBUG]   IntraContrast v1 result: 2064950.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 746975.625000
[LAV DEBUG]   Pair loss = -333.1465 + 0.01 * (2064950.6250 + 746975.6250) = 27786.1152
[LAV DEBUG]   Pair (0,1) completed in 0.33s
[LAV DEBUG]   GPU Memory after pair: 14.67GB

[LAV DEBUG] Processing pair (1,0): N=1497, M=2489
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -333.146515
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 746975.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2064950.625000
[LAV DEBUG]   Pair loss = -333.1465 + 0.01 * (746975.6250 + 2064950.6250) = 27786.1152
[LAV DEBUG]   Pair (1,0) completed in 0.33s
[LAV DEBUG]   GPU Memory after pair: 16.47GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 55572.2305
[LAV DEBUG] Total time: 0.91s
[LAV DEBUG] Avg time per pair: 0.46s
============================================================

[MEM After loss computation] Allocated: 16.47GB | Reserved: 19.16GB | Peak: 18.24GB
[MEM Before backward] Allocated: 16.47GB | Reserved: 19.16GB | Peak: 18.24GB
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 16.44GB | Reserved: 19.16GB | Peak: 18.24GB
[MEM After preprocess] Allocated: 16.44GB | Reserved: 19.16GB | Peak: 18.24GB
Traceback (most recent call last):
  File "multitask_train.py", line 150, in <module>
    alignment_training_loop(
  File "/vision/anishn/GTCC_CVPR2024/models/alignment_training_loop.py", line 288, in alignment_training_loop
    output_dict = model(inputs)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_multiprong.py", line 180, in forward
    general_features = self.base_model(videos)['outputs']
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_singleprong.py", line 65, in forward
    base_output = torch.cat((zero_arrays, base_output), dim=0)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.35 GiB (GPU 0; 22.16 GiB total capacity; 20.51 GiB already allocated; 240.12 MiB free; 21.70 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
