[2026-02-01 00:02:06,453 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-02-01 00:02:06,453 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,493 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-02-01 00:02:06,493 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,526 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-02-01 00:02:06,526 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,547 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-02-01 00:02:06,547 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,564 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-02-01 00:02:06,565 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,583 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-02-01 00:02:06,584 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,596 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-02-01 00:02:06,596 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,636 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-02-01 00:02:06,636 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,650 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-02-01 00:02:06,650 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,687 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-02-01 00:02:06,687 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,702 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-02-01 00:02:06,702 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,717 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-02-01 00:02:06,717 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,734 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-02-01 00:02:06,734 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,773 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-02-01 00:02:06,773 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,783 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-02-01 00:02:06,783 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:06,818 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-02-01 00:02:06,819 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 00:02:08,188 - INFO - alignment_training_loop.py:210] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-02-01 00:02:10,054 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: Salad.cmu
[2026-02-01 00:02:10,283 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [529, 408]
[2026-02-01 00:02:16,787 - INFO - alignment_training_loop.py:323] - [BATCH 0] Loss value: 2812.9404
[2026-02-01 00:02:24,075 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 00:02:25,152 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [2492, 2196]
[2026-02-01 00:02:47,010 - WARNING - alignment_training_loop.py:302] - Skipping batch in task PastaSalad.egtea due to: CUDA out of memory. Tried to allocate 2.61 GiB (GPU 0; 22.16 GiB total capacity; 17.67 GiB already allocated; 586.12 MiB free; 21.36 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2026-02-01 00:02:47,010 - ERROR - alignment_training_loop.py:305] - [OOM] Task: PastaSalad.egtea, Sequences: 2, Lengths: [2492, 2196]
[2026-02-01 00:02:47,129 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: Sandwich.cmu
[2026-02-01 00:02:47,224 - INFO - alignment_training_loop.py:286] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [160, 156]
[2026-02-01 00:02:49,607 - INFO - alignment_training_loop.py:323] - [BATCH 2] Loss value: 278.1955
[2026-02-01 00:02:51,768 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Sandwich.cmu
[2026-02-01 00:02:51,860 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [189, 175]
[2026-02-01 00:02:53,720 - INFO - alignment_training_loop.py:323] - [BATCH 3] Loss value: 379.2121
[2026-02-01 00:02:56,184 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: Sandwich.cmu
[2026-02-01 00:02:56,306 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [256, 224]
[2026-02-01 00:02:58,668 - INFO - alignment_training_loop.py:323] - [BATCH 4] Loss value: 688.0929
[2026-02-01 00:03:01,912 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: Pizza.cmu
[2026-02-01 00:03:02,175 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [439, 593]
[2026-02-01 00:03:07,007 - INFO - alignment_training_loop.py:323] - [BATCH 5] Loss value: 3451.2339
[2026-02-01 00:03:13,939 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: PastaSalad.egtea
[2026-02-01 00:03:14,569 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [989, 1728]
[2026-02-01 00:03:27,130 - INFO - alignment_training_loop.py:323] - [BATCH 6] Loss value: 25975.6035
[2026-02-01 00:03:45,602 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Brownie.cmu
[2026-02-01 00:03:45,800 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [494, 329]
[2026-02-01 00:03:49,834 - INFO - alignment_training_loop.py:323] - [BATCH 7] Loss value: 2209.0452
[2026-02-01 00:03:55,391 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-02-01 00:03:55,762 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [718, 839]
[2026-02-01 00:04:03,097 - INFO - alignment_training_loop.py:323] - [BATCH 8] Loss value: 7856.9390
[2026-02-01 00:04:13,597 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Salad.cmu
[2026-02-01 00:04:13,761 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [346, 300]
[2026-02-01 00:04:16,941 - INFO - alignment_training_loop.py:323] - [BATCH 9] Loss value: 1285.6777
[2026-02-01 00:04:21,297 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Cheeseburger.egtea
[2026-02-01 00:04:21,754 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [1138, 844]
[2026-02-01 00:04:31,233 - INFO - alignment_training_loop.py:323] - [BATCH 10] Loss value: 13039.3184
[2026-02-01 00:04:44,739 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: Pizza.cmu
[2026-02-01 00:04:44,883 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [126, 471]
[2026-02-01 00:04:47,903 - INFO - alignment_training_loop.py:323] - [BATCH 11] Loss value: 1509.7770
[2026-02-01 00:04:51,936 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Salad.cmu
[2026-02-01 00:04:52,095 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [379, 272]
[2026-02-01 00:04:55,311 - INFO - alignment_training_loop.py:323] - [BATCH 12] Loss value: 1339.5697
[2026-02-01 00:04:59,728 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Pizza.cmu
[2026-02-01 00:04:59,976 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [507, 529]
[2026-02-01 00:05:04,989 - INFO - alignment_training_loop.py:323] - [BATCH 13] Loss value: 3397.6016
[2026-02-01 00:05:11,993 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: pc_assembly
[2026-02-01 00:05:12,289 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [513, 757]
[2026-02-01 00:05:18,473 - INFO - alignment_training_loop.py:323] - [BATCH 14] Loss value: 5358.3511
[2026-02-01 00:05:27,068 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: Pizza.cmu
[2026-02-01 00:05:27,339 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [585, 596]
[2026-02-01 00:05:33,097 - INFO - alignment_training_loop.py:323] - [BATCH 15] Loss value: 4442.2959
[2026-02-01 00:05:41,108 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: Eggs.cmu
[2026-02-01 00:05:41,271 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [202, 466]
[2026-02-01 00:05:44,630 - INFO - alignment_training_loop.py:323] - [BATCH 16] Loss value: 1617.9810
[2026-02-01 00:05:49,143 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-02-01 00:05:49,456 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [875, 506]
[2026-02-01 00:05:56,191 - INFO - alignment_training_loop.py:323] - [BATCH 17] Loss value: 6582.3687
[2026-02-01 00:06:05,706 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Brownie.cmu
[2026-02-01 00:06:05,880 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [406, 330]
[2026-02-01 00:06:09,650 - INFO - alignment_training_loop.py:323] - [BATCH 18] Loss value: 1697.2898
[2026-02-01 00:06:14,769 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: tent
[2026-02-01 00:06:15,172 - INFO - alignment_training_loop.py:269] - [BATCH 20] Task: Sandwich.cmu
[2026-02-01 00:06:15,264 - INFO - alignment_training_loop.py:286] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [214, 133]
[2026-02-01 00:06:17,168 - INFO - alignment_training_loop.py:323] - [BATCH 20] Loss value: 365.7816
[2026-02-01 00:06:19,578 - INFO - alignment_training_loop.py:269] - [BATCH 21] Task: Pizza.cmu
[2026-02-01 00:06:19,881 - INFO - alignment_training_loop.py:286] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [458, 839]
[2026-02-01 00:06:26,434 - INFO - alignment_training_loop.py:323] - [BATCH 21] Loss value: 5879.4116
[2026-02-01 00:06:35,556 - INFO - alignment_training_loop.py:269] - [BATCH 22] Task: Salad.cmu
[2026-02-01 00:06:35,775 - INFO - alignment_training_loop.py:286] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [396, 523]
[2026-02-01 00:06:40,523 - INFO - alignment_training_loop.py:323] - [BATCH 22] Loss value: 2710.4507
[2026-02-01 00:06:47,014 - INFO - alignment_training_loop.py:269] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-02-01 00:06:47,340 - INFO - alignment_training_loop.py:286] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [327, 1109]
[2026-02-01 00:06:54,740 - INFO - alignment_training_loop.py:323] - [BATCH 23] Loss value: 8721.7598
[2026-02-01 00:07:04,982 - INFO - alignment_training_loop.py:269] - [BATCH 24] Task: PastaSalad.egtea
[2026-02-01 00:07:05,680 - INFO - alignment_training_loop.py:286] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [543, 2489]
[2026-02-01 00:07:21,487 - INFO - alignment_training_loop.py:323] - [BATCH 24] Loss value: 42916.0664
[2026-02-01 00:07:43,351 - INFO - alignment_training_loop.py:269] - [BATCH 25] Task: PastaSalad.egtea
[2026-02-01 00:07:43,894 - INFO - alignment_training_loop.py:286] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [906, 1438]
[2026-02-01 00:07:56,051 - INFO - alignment_training_loop.py:323] - [BATCH 25] Loss value: 18862.2246
[2026-02-01 00:08:13,073 - INFO - alignment_training_loop.py:269] - [BATCH 26] Task: tent
[2026-02-01 00:08:13,436 - INFO - alignment_training_loop.py:269] - [BATCH 27] Task: Pizza.cmu
[2026-02-01 00:08:13,617 - INFO - alignment_training_loop.py:286] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [346, 421]
[2026-02-01 00:08:17,737 - INFO - alignment_training_loop.py:323] - [BATCH 27] Loss value: 1846.5886
[2026-02-01 00:08:23,206 - INFO - alignment_training_loop.py:269] - [BATCH 28] Task: Sandwich.cmu
[2026-02-01 00:08:23,284 - INFO - alignment_training_loop.py:286] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [145, 141]
[2026-02-01 00:08:24,972 - INFO - alignment_training_loop.py:323] - [BATCH 28] Loss value: 223.3135
[2026-02-01 00:08:27,017 - INFO - alignment_training_loop.py:269] - [BATCH 29] Task: Pizza.egtea
[2026-02-01 00:08:27,315 - INFO - alignment_training_loop.py:286] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [632, 693]
[2026-02-01 00:08:34,265 - INFO - alignment_training_loop.py:323] - [BATCH 29] Loss value: 5632.2744
[2026-02-01 00:08:43,806 - INFO - alignment_training_loop.py:269] - [BATCH 30] Task: Brownie.cmu
[2026-02-01 00:08:44,063 - INFO - alignment_training_loop.py:286] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [689, 431]
[2026-02-01 00:08:49,998 - INFO - alignment_training_loop.py:323] - [BATCH 30] Loss value: 4215.2476
[2026-02-01 00:08:58,021 - INFO - alignment_training_loop.py:269] - [BATCH 31] Task: Pizza.cmu
[2026-02-01 00:08:58,264 - INFO - alignment_training_loop.py:286] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [780, 298]
[2026-02-01 00:09:03,975 - INFO - alignment_training_loop.py:323] - [BATCH 31] Loss value: 4490.1016
[2026-02-01 00:09:11,752 - INFO - alignment_training_loop.py:269] - [BATCH 32] Task: tent
[2026-02-01 00:09:11,761 - INFO - alignment_training_loop.py:269] - [BATCH 33] Task: meccano
[2026-02-01 00:09:12,261 - INFO - alignment_training_loop.py:286] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [694, 1598]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 3.08GB | Reserved: 3.41GB | Peak: 3.11GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([408, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.08GB, Reserved: 3.41GB

[LAV DEBUG] Processing pair (0,1): N=529, M=408
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.937218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93262.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=408) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 55478.121094
[LAV DEBUG]   Pair loss = -80.9372 + 0.01 * (93262.6250 + 55478.1211) = 1406.4702
[LAV DEBUG]   Pair (0,1) completed in 1.19s
[LAV DEBUG]   GPU Memory after pair: 3.19GB

[LAV DEBUG] Processing pair (1,0): N=408, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.937218
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=408) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 55478.121094
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93262.625000
[LAV DEBUG]   Pair loss = -80.9372 + 0.01 * (55478.1211 + 93262.6250) = 1406.4702
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.29GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2812.9404
[LAV DEBUG] Total time: 1.45s
[LAV DEBUG] Avg time per pair: 0.73s
============================================================

[MEM After loss computation] Allocated: 3.29GB | Reserved: 3.52GB | Peak: 3.39GB
[MEM Before backward] Allocated: 3.29GB | Reserved: 3.52GB | Peak: 3.39GB
[MEM After backward] Allocated: 0.38GB | Reserved: 4.04GB | Peak: 3.60GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.04GB | Peak: 3.60GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 3.60GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 3.60GB
[MEM After forward pass] Allocated: 15.02GB | Reserved: 16.15GB | Peak: 15.09GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2492, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 15.02GB, Reserved: 16.15GB

[LAV DEBUG] Processing pair (0,1): N=2492, M=2196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -411.245544
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2492) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2069701.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1607223.125000
[LAV DEBUG]   Pair loss = -411.2455 + 0.01 * (2069701.2500 + 1607223.1250) = 36358.0000
[LAV DEBUG]   Pair (0,1) completed in 0.49s
[LAV DEBUG]   GPU Memory after pair: 17.67GB

[LAV DEBUG] Processing pair (1,0): N=2196, M=2492
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.61 GiB (GPU 0; 22.16 GiB total capacity; 17.67 GiB already allocated; 586.12 MiB free; 21.36 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managem
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 15.02GB | Reserved: 21.36GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 15.02GB | Reserved: 16.12GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.54GB | Reserved: 17.34GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([160, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([156, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.54GB, Reserved: 17.34GB

[LAV DEBUG] Processing pair (0,1): N=160, M=156
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.362898
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=160) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8533.669922
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=156) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8112.395020
[LAV DEBUG]   Pair loss = -27.3629 + 0.01 * (8533.6699 + 8112.3950) = 139.0977
[LAV DEBUG]   Pair (0,1) completed in 0.61s
[LAV DEBUG]   GPU Memory after pair: 1.55GB

[LAV DEBUG] Processing pair (1,0): N=156, M=160
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -27.362898
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=156) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8112.395020
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=160) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8533.669922
[LAV DEBUG]   Pair loss = -27.3629 + 0.01 * (8112.3950 + 8533.6699) = 139.0977
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.56GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 278.1955
[LAV DEBUG] Total time: 0.86s
[LAV DEBUG] Avg time per pair: 0.43s
============================================================

[MEM After loss computation] Allocated: 1.56GB | Reserved: 2.76GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.56GB | Reserved: 2.76GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.76GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.76GB | Peak: 20.26GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.69GB | Reserved: 1.89GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([189, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.69GB, Reserved: 1.89GB

[LAV DEBUG] Processing pair (0,1): N=189, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.551764
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=189) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11907.100586
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10208.678711
[LAV DEBUG]   Pair loss = -31.5518 + 0.01 * (11907.1006 + 10208.6787) = 189.6060
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 1.70GB

[LAV DEBUG] Processing pair (1,0): N=175, M=189
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.551764
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10208.678711
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=189) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11907.100586
[LAV DEBUG]   Pair loss = -31.5518 + 0.01 * (10208.6787 + 11907.1006) = 189.6060
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.72GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 379.2121
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.72GB | Reserved: 1.79GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.72GB | Reserved: 1.79GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.17GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.17GB | Peak: 20.26GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.04GB | Reserved: 2.29GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.04GB, Reserved: 2.29GB

[LAV DEBUG] Processing pair (0,1): N=256, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.648705
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21844.466797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16725.048828
[LAV DEBUG]   Pair loss = -41.6487 + 0.01 * (21844.4668 + 16725.0488) = 344.0464
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.07GB

[LAV DEBUG] Processing pair (1,0): N=224, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.648705
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16725.048828
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21844.466797
[LAV DEBUG]   Pair loss = -41.6487 + 0.01 * (16725.0488 + 21844.4668) = 344.0464
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.10GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 688.0929
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.10GB | Reserved: 2.21GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.10GB | Reserved: 2.21GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.61GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.61GB | Peak: 20.26GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.75GB | Reserved: 4.11GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([439, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([593, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.75GB, Reserved: 4.11GB

[LAV DEBUG] Processing pair (0,1): N=439, M=593
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -88.783325
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=439) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 64234.859375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=593) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 117205.179688
[LAV DEBUG]   Pair loss = -88.7833 + 0.01 * (64234.8594 + 117205.1797) = 1725.6169
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 3.87GB

[LAV DEBUG] Processing pair (1,0): N=593, M=439
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -88.783325
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=593) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 117205.179688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=439) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 64234.859375
[LAV DEBUG]   Pair loss = -88.7833 + 0.01 * (117205.1797 + 64234.8594) = 1725.6169
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.00GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3451.2339
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.00GB | Reserved: 4.25GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.00GB | Reserved: 4.25GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.63GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.63GB | Peak: 20.26GB
[MEM Batch 6 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 8.94GB | Reserved: 9.64GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([989, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1728, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 8.94GB, Reserved: 9.64GB

[LAV DEBUG] Processing pair (0,1): N=989, M=1728
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -224.564133
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=989) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 326008.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1728) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 995228.062500
[LAV DEBUG]   Pair loss = -224.5641 + 0.01 * (326008.5938 + 995228.0625) = 12987.8018
[LAV DEBUG]   Pair (0,1) completed in 0.15s
[LAV DEBUG]   GPU Memory after pair: 9.76GB

[LAV DEBUG] Processing pair (1,0): N=1728, M=989
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -224.564133
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1728) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 995228.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=989) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 326008.593750
[LAV DEBUG]   Pair loss = -224.5641 + 0.01 * (995228.0625 + 326008.5938) = 12987.8018
[LAV DEBUG]   Pair (1,0) completed in 0.14s
[LAV DEBUG]   GPU Memory after pair: 10.59GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 25975.6035
[LAV DEBUG] Total time: 0.56s
[LAV DEBUG] Avg time per pair: 0.28s
============================================================

[MEM After loss computation] Allocated: 10.59GB | Reserved: 12.08GB | Peak: 20.26GB
[MEM Before backward] Allocated: 10.59GB | Reserved: 12.08GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.53GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.53GB | Peak: 20.26GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.10GB | Reserved: 3.49GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([494, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.10GB, Reserved: 3.49GB

[LAV DEBUG] Processing pair (0,1): N=494, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.653084
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=494) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 81339.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36078.480469
[LAV DEBUG]   Pair loss = -69.6531 + 0.01 * (81339.0781 + 36078.4805) = 1104.5226
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.18GB

[LAV DEBUG] Processing pair (1,0): N=329, M=494
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.653084
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36078.480469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=494) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 81339.078125
[LAV DEBUG]   Pair loss = -69.6531 + 0.01 * (36078.4805 + 81339.0781) = 1104.5226
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.26GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2209.0452
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.26GB | Reserved: 3.46GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.26GB | Reserved: 3.46GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.91GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.91GB | Peak: 20.26GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 5.37GB | Reserved: 5.83GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([718, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.37GB, Reserved: 5.83GB

[LAV DEBUG] Processing pair (0,1): N=718, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -135.999191
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=718) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 171826.796875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234620.078125
[LAV DEBUG]   Pair loss = -135.9992 + 0.01 * (171826.7969 + 234620.0781) = 3928.4695
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 5.66GB

[LAV DEBUG] Processing pair (1,0): N=839, M=718
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -135.999191
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234620.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=718) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 171826.796875
[LAV DEBUG]   Pair loss = -135.9992 + 0.01 * (234620.0781 + 171826.7969) = 3928.4695
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7856.9390
[LAV DEBUG] Total time: 0.37s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 5.95GB | Reserved: 6.41GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.95GB | Reserved: 6.41GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.28GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 7.28GB | Peak: 20.26GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.55GB | Reserved: 2.82GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([300, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.55GB, Reserved: 2.82GB

[LAV DEBUG] Processing pair (0,1): N=346, M=300
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.183746
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39903.371094
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=300) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29998.884766
[LAV DEBUG]   Pair loss = -56.1837 + 0.01 * (39903.3711 + 29998.8848) = 642.8389
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.61GB

[LAV DEBUG] Processing pair (1,0): N=300, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.183746
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=300) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29998.884766
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39903.371094
[LAV DEBUG]   Pair loss = -56.1837 + 0.01 * (29998.8848 + 39903.3711) = 642.8389
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1285.6777
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.66GB | Reserved: 2.81GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.66GB | Reserved: 2.81GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 6.68GB | Reserved: 7.21GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1138, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([844, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 6.68GB, Reserved: 7.21GB

[LAV DEBUG] Processing pair (0,1): N=1138, M=844
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -171.019730
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1138) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 431640.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=844) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 237427.796875
[LAV DEBUG]   Pair loss = -171.0197 + 0.01 * (431640.0938 + 237427.7969) = 6519.6592
[LAV DEBUG]   Pair (0,1) completed in 0.09s
[LAV DEBUG]   GPU Memory after pair: 7.15GB

[LAV DEBUG] Processing pair (1,0): N=844, M=1138
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -171.019730
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=844) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 237427.796875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1138) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 431640.093750
[LAV DEBUG]   Pair loss = -171.0197 + 0.01 * (237427.7969 + 431640.0938) = 6519.6592
[LAV DEBUG]   Pair (1,0) completed in 0.08s
[LAV DEBUG]   GPU Memory after pair: 7.61GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 13039.3184
[LAV DEBUG] Total time: 0.39s
[LAV DEBUG] Avg time per pair: 0.20s
============================================================

[MEM After loss computation] Allocated: 7.61GB | Reserved: 8.12GB | Peak: 20.26GB
[MEM Before backward] Allocated: 7.61GB | Reserved: 8.12GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 9.50GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 9.50GB | Peak: 20.26GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.40GB | Reserved: 2.70GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([126, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([471, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.40GB, Reserved: 2.70GB

[LAV DEBUG] Processing pair (0,1): N=126, M=471
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.471027
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=126) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5293.208496
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=471) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73942.742188
[LAV DEBUG]   Pair loss = -37.4710 + 0.01 * (5293.2085 + 73942.7422) = 754.8885
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.43GB

[LAV DEBUG] Processing pair (1,0): N=471, M=126
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -37.471027
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=471) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73942.742188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=126) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5293.208496
[LAV DEBUG]   Pair loss = -37.4710 + 0.01 * (73942.7422 + 5293.2085) = 754.8885
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1509.7770
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.46GB | Reserved: 2.62GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.46GB | Reserved: 2.62GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.97GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.97GB | Peak: 20.26GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.57GB | Reserved: 2.85GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([379, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.57GB, Reserved: 2.85GB

[LAV DEBUG] Processing pair (0,1): N=379, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.607227
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=379) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47878.140625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24661.070312
[LAV DEBUG]   Pair loss = -55.6072 + 0.01 * (47878.1406 + 24661.0703) = 669.7849
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.62GB

[LAV DEBUG] Processing pair (1,0): N=272, M=379
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.607227
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24661.070312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=379) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47878.140625
[LAV DEBUG]   Pair loss = -55.6072 + 0.01 * (24661.0703 + 47878.1406) = 669.7849
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1339.5697
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.67GB | Reserved: 2.84GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.67GB | Reserved: 2.84GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.31GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.31GB | Peak: 20.26GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.76GB | Reserved: 4.12GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([507, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.76GB, Reserved: 4.12GB

[LAV DEBUG] Processing pair (0,1): N=507, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.732780
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=507) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85678.242188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93275.117188
[LAV DEBUG]   Pair loss = -90.7328 + 0.01 * (85678.2422 + 93275.1172) = 1698.8008
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.89GB

[LAV DEBUG] Processing pair (1,0): N=529, M=507
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.732780
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93275.117188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=507) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85678.242188
[LAV DEBUG]   Pair loss = -90.7328 + 0.01 * (93275.1172 + 85678.2422) = 1698.8008
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3397.6016
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.02GB | Reserved: 4.40GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.02GB | Reserved: 4.40GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.66GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.66GB | Peak: 20.26GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.48GB | Reserved: 4.90GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([513, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([757, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.48GB, Reserved: 4.90GB

[LAV DEBUG] Processing pair (0,1): N=513, M=757
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -108.050964
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=513) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 87718.367188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=757) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 191004.296875
[LAV DEBUG]   Pair loss = -108.0510 + 0.01 * (87718.3672 + 191004.2969) = 2679.1755
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.67GB

[LAV DEBUG] Processing pair (1,0): N=757, M=513
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -108.050964
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=757) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 191004.296875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=513) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 87718.367188
[LAV DEBUG]   Pair loss = -108.0510 + 0.01 * (191004.2969 + 87718.3672) = 2679.1755
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.86GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5358.3511
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 4.86GB | Reserved: 5.16GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.86GB | Reserved: 5.16GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.72GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.72GB | Peak: 20.26GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.21GB | Reserved: 4.57GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([585, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([596, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.21GB, Reserved: 4.57GB

[LAV DEBUG] Processing pair (0,1): N=585, M=596
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -103.531960
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=585) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 114068.867188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=596) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 118399.140625
[LAV DEBUG]   Pair loss = -103.5320 + 0.01 * (114068.8672 + 118399.1406) = 2221.1479
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.38GB

[LAV DEBUG] Processing pair (1,0): N=596, M=585
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -103.531960
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=596) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 118399.140625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=585) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 114068.867188
[LAV DEBUG]   Pair loss = -103.5320 + 0.01 * (118399.1406 + 114068.8672) = 2221.1479
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.54GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4442.2959
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 4.54GB | Reserved: 5.07GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.54GB | Reserved: 5.07GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.41GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.41GB | Peak: 20.26GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.62GB | Reserved: 2.87GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([466, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.62GB, Reserved: 2.87GB

[LAV DEBUG] Processing pair (0,1): N=202, M=466
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.853271
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.075195
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=466) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 72382.296875
[LAV DEBUG]   Pair loss = -50.8533 + 0.01 * (13602.0752 + 72382.2969) = 808.9905
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.67GB

[LAV DEBUG] Processing pair (1,0): N=466, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.853271
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=466) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 72382.296875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.075195
[LAV DEBUG]   Pair loss = -50.8533 + 0.01 * (72382.2969 + 13602.0752) = 808.9905
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.71GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1617.9810
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.71GB | Reserved: 2.87GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.71GB | Reserved: 2.87GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.22GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.22GB | Peak: 20.26GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.82GB | Reserved: 5.19GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([506, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.82GB, Reserved: 5.19GB

[LAV DEBUG] Processing pair (0,1): N=875, M=506
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -114.136581
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255190.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=506) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85341.476562
[LAV DEBUG]   Pair loss = -114.1366 + 0.01 * (255190.6250 + 85341.4766) = 3291.1843
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.03GB

[LAV DEBUG] Processing pair (1,0): N=506, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -114.136581
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=506) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85341.476562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255190.625000
[LAV DEBUG]   Pair loss = -114.1366 + 0.01 * (85341.4766 + 255190.6250) = 3291.1843
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.25GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6582.3687
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.25GB | Reserved: 5.83GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.25GB | Reserved: 5.83GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.26GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.26GB | Peak: 20.26GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.83GB | Reserved: 3.17GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([406, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([330, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.83GB, Reserved: 3.17GB

[LAV DEBUG] Processing pair (0,1): N=406, M=330
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.785332
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=406) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54943.675781
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=330) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36299.347656
[LAV DEBUG]   Pair loss = -63.7853 + 0.01 * (54943.6758 + 36299.3477) = 848.6449
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.90GB

[LAV DEBUG] Processing pair (1,0): N=330, M=406
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.785332
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=330) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36299.347656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=406) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54943.675781
[LAV DEBUG]   Pair loss = -63.7853 + 0.01 * (36299.3477 + 54943.6758) = 848.6449
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.96GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1697.2898
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.96GB | Reserved: 3.19GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.96GB | Reserved: 3.19GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.59GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.59GB | Peak: 20.26GB
[MEM Batch 19 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.64GB | Reserved: 1.85GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.64GB, Reserved: 1.85GB

[LAV DEBUG] Processing pair (0,1): N=214, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.745510
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15266.025391
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.604980
[LAV DEBUG]   Pair loss = -28.7455 + 0.01 * (15266.0254 + 5897.6050) = 182.8908
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.65GB

[LAV DEBUG] Processing pair (1,0): N=133, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.745510
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.604980
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15266.025391
[LAV DEBUG]   Pair loss = -28.7455 + 0.01 * (5897.6050 + 15266.0254) = 182.8908
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 1.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 365.7816
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.66GB | Reserved: 1.74GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.66GB | Reserved: 1.74GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.11GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.11GB | Peak: 20.26GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.56GB | Reserved: 4.98GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([458, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.56GB, Reserved: 4.98GB

[LAV DEBUG] Processing pair (0,1): N=458, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -105.775696
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=458) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 69919.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234629.062500
[LAV DEBUG]   Pair loss = -105.7757 + 0.01 * (69919.0938 + 234629.0625) = 2939.7058
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.75GB

[LAV DEBUG] Processing pair (1,0): N=839, M=458
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -105.775696
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234629.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=458) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 69919.093750
[LAV DEBUG]   Pair loss = -105.7757 + 0.01 * (234629.0625 + 69919.0938) = 2939.7058
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.93GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5879.4116
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 4.93GB | Reserved: 5.24GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.93GB | Reserved: 5.24GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.79GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.79GB | Peak: 20.26GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.40GB | Reserved: 3.72GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([396, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.40GB, Reserved: 3.72GB

[LAV DEBUG] Processing pair (0,1): N=396, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.214943
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=396) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52270.902344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91173.125000
[LAV DEBUG]   Pair loss = -79.2149 + 0.01 * (52270.9023 + 91173.1250) = 1355.2253
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.50GB

[LAV DEBUG] Processing pair (1,0): N=523, M=396
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.214943
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91173.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=396) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52270.902344
[LAV DEBUG]   Pair loss = -79.2149 + 0.01 * (91173.1250 + 52270.9023) = 1355.2253
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.60GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2710.4507
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.60GB | Reserved: 3.81GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.60GB | Reserved: 3.81GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.33GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.33GB | Peak: 20.26GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.99GB | Reserved: 5.43GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([327, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1109, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.99GB, Reserved: 5.43GB

[LAV DEBUG] Processing pair (0,1): N=327, M=1109
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.942863
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=327) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35642.820312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 409939.468750
[LAV DEBUG]   Pair loss = -94.9429 + 0.01 * (35642.8203 + 409939.4688) = 4360.8799
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.17GB

[LAV DEBUG] Processing pair (1,0): N=1109, M=327
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.942863
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 409939.468750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=327) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35642.820312
[LAV DEBUG]   Pair loss = -94.9429 + 0.01 * (409939.4688 + 35642.8203) = 4360.8799
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 5.34GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 8721.7598
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.34GB | Reserved: 5.78GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.34GB | Reserved: 5.78GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.30GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.30GB | Peak: 20.26GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 9.91GB | Reserved: 10.65GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2489, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.91GB, Reserved: 10.65GB

[LAV DEBUG] Processing pair (0,1): N=543, M=2489
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -174.183319
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 98279.796875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2064942.000000
[LAV DEBUG]   Pair loss = -174.1833 + 0.01 * (98279.7969 + 2064942.0000) = 21458.0332
[LAV DEBUG]   Pair (0,1) completed in 0.14s
[LAV DEBUG]   GPU Memory after pair: 10.56GB

[LAV DEBUG] Processing pair (1,0): N=2489, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -174.183319
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2064942.000000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 98279.796875
[LAV DEBUG]   Pair loss = -174.1833 + 0.01 * (2064942.0000 + 98279.7969) = 21458.0332
[LAV DEBUG]   Pair (1,0) completed in 0.12s
[LAV DEBUG]   GPU Memory after pair: 11.22GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 42916.0664
[LAV DEBUG] Total time: 0.54s
[LAV DEBUG] Avg time per pair: 0.27s
============================================================

[MEM After loss computation] Allocated: 11.22GB | Reserved: 12.56GB | Peak: 20.26GB
[MEM Before backward] Allocated: 11.22GB | Reserved: 12.56GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.50GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.50GB | Peak: 20.26GB
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 7.79GB | Reserved: 8.39GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([906, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.79GB, Reserved: 8.39GB

[LAV DEBUG] Processing pair (0,1): N=906, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -197.427826
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=906) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 273601.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 689252.812500
[LAV DEBUG]   Pair loss = -197.4278 + 0.01 * (273601.2500 + 689252.8125) = 9431.1123
[LAV DEBUG]   Pair (0,1) completed in 0.12s
[LAV DEBUG]   GPU Memory after pair: 8.42GB

[LAV DEBUG] Processing pair (1,0): N=1438, M=906
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -197.427826
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 689252.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=906) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 273601.250000
[LAV DEBUG]   Pair loss = -197.4278 + 0.01 * (689252.8125 + 273601.2500) = 9431.1123
[LAV DEBUG]   Pair (1,0) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 9.05GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 18862.2246
[LAV DEBUG] Total time: 0.46s
[LAV DEBUG] Avg time per pair: 0.23s
============================================================

[MEM After loss computation] Allocated: 9.05GB | Reserved: 9.64GB | Peak: 20.26GB
[MEM Before backward] Allocated: 9.05GB | Reserved: 9.64GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 11.51GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 11.51GB | Peak: 20.26GB
[MEM Batch 26 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM Batch 27 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.93GB | Reserved: 3.24GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([421, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.93GB, Reserved: 3.24GB

[LAV DEBUG] Processing pair (0,1): N=346, M=421
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.552063
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39905.230469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=421) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59079.410156
[LAV DEBUG]   Pair loss = -66.5521 + 0.01 * (39905.2305 + 59079.4102) = 923.2943
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.00GB

[LAV DEBUG] Processing pair (1,0): N=421, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.552063
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=421) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59079.410156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39905.230469
[LAV DEBUG]   Pair loss = -66.5521 + 0.01 * (59079.4102 + 39905.2305) = 923.2943
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1846.5886
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.07GB | Reserved: 3.27GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.07GB | Reserved: 3.27GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.70GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.70GB | Peak: 20.26GB
[MEM Batch 28 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.45GB | Reserved: 1.70GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([141, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.45GB, Reserved: 1.70GB

[LAV DEBUG] Processing pair (0,1): N=145, M=141
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.723417
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.674805
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=141) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6628.345215
[LAV DEBUG]   Pair loss = -24.7234 + 0.01 * (7009.6748 + 6628.3452) = 111.6568
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.46GB

[LAV DEBUG] Processing pair (1,0): N=141, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.723417
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=141) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6628.345215
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.674805
[LAV DEBUG]   Pair loss = -24.7234 + 0.01 * (6628.3452 + 7009.6748) = 111.6568
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.47GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 223.3135
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.47GB | Reserved: 1.59GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.47GB | Reserved: 1.59GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.86GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.86GB | Peak: 20.26GB
[MEM Batch 29 START - Task Pizza.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.65GB | Reserved: 5.03GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([632, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([693, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.65GB, Reserved: 5.03GB

[LAV DEBUG] Processing pair (0,1): N=632, M=693
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -116.026421
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=632) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 133137.921875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=693) [no_grad]...
[2026-02-01 00:09:24,277 - INFO - alignment_training_loop.py:323] - [BATCH 33] Loss value: 19882.6504
[2026-02-01 00:09:40,884 - INFO - alignment_training_loop.py:269] - [BATCH 34] Task: Brownie.cmu
[2026-02-01 00:09:41,072 - INFO - alignment_training_loop.py:286] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [369, 403]
[2026-02-01 00:09:45,225 - INFO - alignment_training_loop.py:323] - [BATCH 34] Loss value: 1855.6573
[2026-02-01 00:09:50,797 - INFO - alignment_training_loop.py:269] - [BATCH 35] Task: pc_disassembly
[2026-02-01 00:09:50,962 - INFO - alignment_training_loop.py:286] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [295, 340]
[2026-02-01 00:09:54,431 - INFO - alignment_training_loop.py:323] - [BATCH 35] Loss value: 1240.4147
[2026-02-01 00:09:59,005 - INFO - alignment_training_loop.py:269] - [BATCH 36] Task: Salad.cmu
[2026-02-01 00:09:59,147 - INFO - alignment_training_loop.py:286] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [224, 306]
[2026-02-01 00:10:02,078 - INFO - alignment_training_loop.py:323] - [BATCH 36] Loss value: 868.1849
[2026-02-01 00:10:05,895 - INFO - alignment_training_loop.py:269] - [BATCH 37] Task: meccano
[2026-02-01 00:10:06,493 - INFO - alignment_training_loop.py:286] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [875, 1833]
[2026-02-01 00:10:20,800 - INFO - alignment_training_loop.py:323] - [BATCH 37] Loss value: 27075.0840
[2026-02-01 00:10:40,614 - INFO - alignment_training_loop.py:269] - [BATCH 38] Task: Salad.cmu
[2026-02-01 00:10:40,729 - INFO - alignment_training_loop.py:286] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [130, 329]
[2026-02-01 00:10:43,333 - INFO - alignment_training_loop.py:323] - [BATCH 38] Loss value: 766.8712
[2026-02-01 00:10:46,638 - INFO - alignment_training_loop.py:269] - [BATCH 39] Task: Eggs.cmu
[2026-02-01 00:10:46,827 - INFO - alignment_training_loop.py:286] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [341, 428]
[2026-02-01 00:10:50,979 - INFO - alignment_training_loop.py:323] - [BATCH 39] Loss value: 1863.3508
[2026-02-01 00:10:56,506 - INFO - alignment_training_loop.py:269] - [BATCH 40] Task: PastaSalad.egtea
[2026-02-01 00:10:57,296 - INFO - alignment_training_loop.py:286] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [2192, 1401]
[2026-02-01 00:11:16,333 - INFO - alignment_training_loop.py:323] - [BATCH 40] Loss value: 44508.4883
[2026-02-01 00:11:42,897 - INFO - alignment_training_loop.py:269] - [BATCH 41] Task: Pizza.cmu
[2026-02-01 00:11:43,207 - INFO - alignment_training_loop.py:286] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [756, 575]
[2026-02-01 00:11:50,276 - INFO - alignment_training_loop.py:323] - [BATCH 41] Loss value: 5784.3110
[2026-02-01 00:11:59,918 - INFO - alignment_training_loop.py:269] - [BATCH 42] Task: TurkeySandwich.egtea
[2026-02-01 00:12:00,140 - INFO - alignment_training_loop.py:286] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [429, 502]
[2026-02-01 00:12:05,153 - INFO - alignment_training_loop.py:323] - [BATCH 42] Loss value: 2744.7407
[2026-02-01 00:12:11,854 - INFO - alignment_training_loop.py:269] - [BATCH 43] Task: Brownie.cmu
[2026-02-01 00:12:11,984 - INFO - alignment_training_loop.py:286] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [224, 294]
[2026-02-01 00:12:14,887 - INFO - alignment_training_loop.py:323] - [BATCH 43] Loss value: 821.8466
[2026-02-01 00:12:18,595 - INFO - alignment_training_loop.py:269] - [BATCH 44] Task: meccano
[2026-02-01 00:12:19,098 - INFO - alignment_training_loop.py:286] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [1438, 759]
[2026-02-01 00:12:30,615 - INFO - alignment_training_loop.py:323] - [BATCH 44] Loss value: 17269.6797
[2026-02-01 00:12:46,573 - INFO - alignment_training_loop.py:269] - [BATCH 45] Task: Salad.cmu
[2026-02-01 00:12:46,689 - INFO - alignment_training_loop.py:286] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [253, 173]
[2026-02-01 00:12:49,077 - INFO - alignment_training_loop.py:323] - [BATCH 45] Loss value: 554.3506
[2026-02-01 00:12:52,148 - INFO - alignment_training_loop.py:269] - [BATCH 46] Task: Eggs.cmu
[2026-02-01 00:12:52,265 - INFO - alignment_training_loop.py:286] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [271, 181]
[2026-02-01 00:12:54,805 - INFO - alignment_training_loop.py:323] - [BATCH 46] Loss value: 631.9464
[2026-02-01 00:12:58,046 - INFO - alignment_training_loop.py:269] - [BATCH 47] Task: PastaSalad.egtea
[2026-02-01 00:12:58,826 - INFO - alignment_training_loop.py:286] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [1796, 1497]
[2026-02-01 00:13:16,215 - INFO - alignment_training_loop.py:323] - [BATCH 47] Loss value: 35868.0469
[2026-02-01 00:13:40,501 - INFO - alignment_training_loop.py:269] - [BATCH 48] Task: GreekSalad.egtea
[2026-02-01 00:13:40,744 - INFO - alignment_training_loop.py:286] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [364, 658]
[2026-02-01 00:13:46,189 - INFO - alignment_training_loop.py:323] - [BATCH 48] Loss value: 3602.7212
[2026-02-01 00:13:53,541 - INFO - alignment_training_loop.py:269] - [BATCH 49] Task: Sandwich.cmu
[2026-02-01 00:13:53,645 - INFO - alignment_training_loop.py:286] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [199, 213]
[2026-02-01 00:13:55,951 - INFO - alignment_training_loop.py:323] - [BATCH 49] Loss value: 494.9622
[2026-02-01 00:13:58,922 - INFO - alignment_training_loop.py:269] - [BATCH 50] Task: ContinentalBreakfast.egtea
[2026-02-01 00:13:59,136 - INFO - alignment_training_loop.py:286] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [436, 469]
[2026-02-01 00:14:04,021 - INFO - alignment_training_loop.py:323] - [BATCH 50] Loss value: 2575.4429
[2026-02-01 00:14:10,540 - INFO - alignment_training_loop.py:269] - [BATCH 51] Task: Salad.cmu
[2026-02-01 00:14:10,757 - INFO - alignment_training_loop.py:286] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [423, 430]
[2026-02-01 00:14:15,405 - INFO - alignment_training_loop.py:323] - [BATCH 51] Loss value: 2276.2632
[2026-02-01 00:14:21,528 - INFO - alignment_training_loop.py:269] - [BATCH 52] Task: Brownie.cmu
[2026-02-01 00:14:21,698 - INFO - alignment_training_loop.py:286] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [373, 313]
[2026-02-01 00:14:25,404 - INFO - alignment_training_loop.py:323] - [BATCH 52] Loss value: 1461.5554
[2026-02-01 00:14:30,342 - INFO - alignment_training_loop.py:269] - [BATCH 53] Task: Sandwich.cmu
[2026-02-01 00:14:30,434 - INFO - alignment_training_loop.py:286] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [184, 168]
[2026-02-01 00:14:32,495 - INFO - alignment_training_loop.py:323] - [BATCH 53] Loss value: 352.9615
[2026-02-01 00:14:35,017 - INFO - alignment_training_loop.py:269] - [BATCH 54] Task: Sandwich.cmu
[2026-02-01 00:14:35,096 - INFO - alignment_training_loop.py:286] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [179, 93]
[2026-02-01 00:14:36,698 - INFO - alignment_training_loop.py:323] - [BATCH 54] Loss value: 228.2357
[2026-02-01 00:14:38,658 - INFO - alignment_training_loop.py:269] - [BATCH 55] Task: Salad.cmu
[2026-02-01 00:14:38,823 - INFO - alignment_training_loop.py:286] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [305, 390]
[2026-02-01 00:14:42,558 - INFO - alignment_training_loop.py:323] - [BATCH 55] Loss value: 1514.2144
[2026-02-01 00:14:47,558 - INFO - alignment_training_loop.py:269] - [BATCH 56] Task: Cheeseburger.egtea
[2026-02-01 00:14:47,790 - INFO - alignment_training_loop.py:286] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [447, 470]
[2026-02-01 00:14:52,678 - INFO - alignment_training_loop.py:323] - [BATCH 56] Loss value: 2644.2546
[2026-02-01 00:14:59,274 - INFO - alignment_training_loop.py:269] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 00:14:59,413 - INFO - alignment_training_loop.py:286] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [229, 339]
[2026-02-01 00:15:02,533 - INFO - alignment_training_loop.py:323] - [BATCH 57] Loss value: 1019.7285
[2026-02-01 00:15:06,619 - INFO - alignment_training_loop.py:269] - [BATCH 58] Task: Pizza.cmu
[2026-02-01 00:15:06,781 - INFO - alignment_training_loop.py:286] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [236, 381]
[2026-02-01 00:15:10,142 - INFO - alignment_training_loop.py:323] - [BATCH 58] Loss value: 1236.2181
[2026-02-01 00:15:14,569 - INFO - alignment_training_loop.py:269] - [BATCH 59] Task: Brownie.cmu
[2026-02-01 00:15:14,785 - INFO - alignment_training_loop.py:286] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [528, 397]
[2026-02-01 00:15:19,720 - INFO - alignment_training_loop.py:323] - [BATCH 59] Loss value: 2749.9575
[2026-02-01 00:15:26,383 - INFO - alignment_training_loop.py:269] - [BATCH 60] Task: Eggs.cmu
[2026-02-01 00:15:26,533 - INFO - alignment_training_loop.py:286] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [325, 282]
[2026-02-01 00:15:29,848 - INFO - alignment_training_loop.py:323] - [BATCH 60] Loss value: 1128.8431
[2026-02-01 00:15:34,162 - INFO - alignment_training_loop.py:269] - [BATCH 61] Task: tent
[2026-02-01 00:15:34,515 - INFO - alignment_training_loop.py:286] - [BATCH 61] After preprocessing - Num sequences: 2, Lengths: [768, 721]
[2026-02-01 00:15:42,347 - INFO - alignment_training_loop.py:323] - [BATCH 61] Loss value: 7136.5610
[LAV DEBUG]   IntraContrast v2 result: 160078.453125
[LAV DEBUG]   Pair loss = -116.0264 + 0.01 * (133137.9219 + 160078.4531) = 2816.1372
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.86GB

[LAV DEBUG] Processing pair (1,0): N=693, M=632
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -116.026421
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=693) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160078.453125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=632) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 133137.921875
[LAV DEBUG]   Pair loss = -116.0264 + 0.01 * (160078.4531 + 133137.9219) = 2816.1372
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5632.2744
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.07GB | Reserved: 5.45GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.07GB | Reserved: 5.45GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.08GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.08GB | Peak: 20.26GB
[MEM Batch 30 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.02GB | Reserved: 4.43GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([689, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([431, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.02GB, Reserved: 4.43GB

[LAV DEBUG] Processing pair (0,1): N=689, M=431
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -93.938614
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=689) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 158236.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=431) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61919.804688
[LAV DEBUG]   Pair loss = -93.9386 + 0.01 * (158236.4375 + 61919.8047) = 2107.6238
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.16GB

[LAV DEBUG] Processing pair (1,0): N=431, M=689
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -93.938614
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=431) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61919.804688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=689) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 158236.437500
[LAV DEBUG]   Pair loss = -93.9386 + 0.01 * (61919.8047 + 158236.4375) = 2107.6238
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.30GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4215.2476
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.30GB | Reserved: 4.61GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.30GB | Reserved: 4.61GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.04GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.04GB | Peak: 20.26GB
[MEM Batch 31 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.89GB | Reserved: 4.21GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([780, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([298, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.89GB, Reserved: 4.21GB

[LAV DEBUG] Processing pair (0,1): N=780, M=298
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.914528
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=780) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 202794.640625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=298) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29601.892578
[LAV DEBUG]   Pair loss = -78.9145 + 0.01 * (202794.6406 + 29601.8926) = 2245.0508
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.00GB

[LAV DEBUG] Processing pair (1,0): N=298, M=780
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.914528
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=298) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29601.892578
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=780) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 202794.640625
[LAV DEBUG]   Pair loss = -78.9145 + 0.01 * (29601.8926 + 202794.6406) = 2245.0508
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 4.11GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4490.1016
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.11GB | Reserved: 4.44GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.11GB | Reserved: 4.44GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.78GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.78GB | Peak: 20.26GB
[MEM Batch 32 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM Batch 33 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 7.63GB | Reserved: 8.20GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([694, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1598, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.63GB, Reserved: 8.20GB

[LAV DEBUG] Processing pair (0,1): N=694, M=1598
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -175.834869
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=694) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160541.609375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1598) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 851174.375000
[LAV DEBUG]   Pair loss = -175.8349 + 0.01 * (160541.6094 + 851174.3750) = 9941.3252
[LAV DEBUG]   Pair (0,1) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 8.17GB

[LAV DEBUG] Processing pair (1,0): N=1598, M=694
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -175.834869
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1598) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 851174.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=694) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 160541.609375
[LAV DEBUG]   Pair loss = -175.8349 + 0.01 * (851174.3750 + 160541.6094) = 9941.3252
[LAV DEBUG]   Pair (1,0) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 8.70GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 19882.6504
[LAV DEBUG] Total time: 0.49s
[LAV DEBUG] Avg time per pair: 0.24s
============================================================

[MEM After loss computation] Allocated: 8.70GB | Reserved: 9.26GB | Peak: 20.26GB
[MEM Before backward] Allocated: 8.70GB | Reserved: 9.26GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 10.87GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 10.87GB | Peak: 20.26GB
[MEM Batch 34 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.94GB | Reserved: 3.26GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([369, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([403, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.94GB, Reserved: 3.26GB

[LAV DEBUG] Processing pair (0,1): N=369, M=403
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.406242
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=369) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 45387.234375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=403) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54136.257812
[LAV DEBUG]   Pair loss = -67.4062 + 0.01 * (45387.2344 + 54136.2578) = 927.8287
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.02GB

[LAV DEBUG] Processing pair (1,0): N=403, M=369
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.406242
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=403) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54136.257812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=369) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 45387.234375
[LAV DEBUG]   Pair loss = -67.4062 + 0.01 * (54136.2578 + 45387.2344) = 927.8287
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.09GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1855.6573
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.09GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.09GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.72GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.72GB | Peak: 20.26GB
[MEM Batch 35 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.52GB | Reserved: 2.79GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([295, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([340, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.52GB, Reserved: 2.79GB

[LAV DEBUG] Processing pair (0,1): N=295, M=340
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.221230
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=295) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29009.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=340) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38533.765625
[LAV DEBUG]   Pair loss = -55.2212 + 0.01 * (29009.0938 + 38533.7656) = 620.2073
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.57GB

[LAV DEBUG] Processing pair (1,0): N=340, M=295
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.221230
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=340) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38533.765625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=295) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29009.093750
[LAV DEBUG]   Pair loss = -55.2212 + 0.01 * (38533.7656 + 29009.0938) = 620.2073
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.62GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1240.4147
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.62GB | Reserved: 2.78GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.62GB | Reserved: 2.78GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.25GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.25GB | Peak: 20.26GB
[MEM Batch 36 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.20GB | Reserved: 2.42GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([306, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.20GB, Reserved: 2.42GB

[LAV DEBUG] Processing pair (0,1): N=224, M=306
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.300728
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.527344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=306) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31212.791016
[LAV DEBUG]   Pair loss = -45.3007 + 0.01 * (16726.5273 + 31212.7910) = 434.0925
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.23GB

[LAV DEBUG] Processing pair (1,0): N=306, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.300728
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=306) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31212.791016
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.527344
[LAV DEBUG]   Pair loss = -45.3007 + 0.01 * (31212.7910 + 16726.5273) = 434.0925
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.26GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 868.1849
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.26GB | Reserved: 2.41GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.26GB | Reserved: 2.41GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.69GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.69GB | Peak: 20.26GB
[MEM Batch 37 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 8.91GB | Reserved: 9.59GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1833, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 8.91GB, Reserved: 9.59GB

[LAV DEBUG] Processing pair (0,1): N=875, M=1833
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -213.833984
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255203.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1833) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1119934.500000
[LAV DEBUG]   Pair loss = -213.8340 + 0.01 * (255203.0938 + 1119934.5000) = 13537.5420
[LAV DEBUG]   Pair (0,1) completed in 0.14s
[LAV DEBUG]   GPU Memory after pair: 9.69GB

[LAV DEBUG] Processing pair (1,0): N=1833, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -213.833984
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1833) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1119934.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255203.093750
[LAV DEBUG]   Pair loss = -213.8340 + 0.01 * (1119934.5000 + 255203.0938) = 13537.5420
[LAV DEBUG]   Pair (1,0) completed in 0.13s
[LAV DEBUG]   GPU Memory after pair: 10.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 27075.0840
[LAV DEBUG] Total time: 0.51s
[LAV DEBUG] Avg time per pair: 0.25s
============================================================

[MEM After loss computation] Allocated: 10.46GB | Reserved: 11.87GB | Peak: 20.26GB
[MEM Before backward] Allocated: 10.46GB | Reserved: 11.87GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.17GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.17GB | Peak: 20.26GB
[MEM Batch 38 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.98GB | Reserved: 2.24GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.98GB, Reserved: 2.24GB

[LAV DEBUG] Processing pair (0,1): N=130, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -33.723186
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.816406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36081.058594
[LAV DEBUG]   Pair loss = -33.7232 + 0.01 * (5634.8164 + 36081.0586) = 383.4356
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.00GB

[LAV DEBUG] Processing pair (1,0): N=329, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -33.723186
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36081.058594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.816406
[LAV DEBUG]   Pair loss = -33.7232 + 0.01 * (36081.0586 + 5634.8164) = 383.4356
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 766.8712
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.02GB | Reserved: 2.13GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.02GB | Reserved: 2.13GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.46GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.46GB | Peak: 20.26GB
[MEM Batch 39 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.93GB | Reserved: 3.25GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([428, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.93GB, Reserved: 3.25GB

[LAV DEBUG] Processing pair (0,1): N=341, M=428
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.550156
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38761.027344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=428) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61061.531250
[LAV DEBUG]   Pair loss = -66.5502 + 0.01 * (38761.0273 + 61061.5312) = 931.6754
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.01GB

[LAV DEBUG] Processing pair (1,0): N=428, M=341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -66.550156
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=428) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61061.531250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38761.027344
[LAV DEBUG]   Pair loss = -66.5502 + 0.01 * (61061.5312 + 38761.0273) = 931.6754
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.08GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1863.3508
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.08GB | Reserved: 3.28GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.08GB | Reserved: 3.28GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.70GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.70GB | Peak: 20.26GB
[MEM Batch 40 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 11.65GB | Reserved: 12.54GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2192, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1401, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.65GB, Reserved: 12.54GB

[LAV DEBUG] Processing pair (0,1): N=2192, M=1401
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -303.701263
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2192) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1601555.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 654238.875000
[LAV DEBUG]   Pair loss = -303.7013 + 0.01 * (1601555.7500 + 654238.8750) = 22254.2441
[LAV DEBUG]   Pair (0,1) completed in 0.25s
[LAV DEBUG]   GPU Memory after pair: 13.13GB

[LAV DEBUG] Processing pair (1,0): N=1401, M=2192
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -303.701263
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 654238.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2192) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1601555.750000
[LAV DEBUG]   Pair loss = -303.7013 + 0.01 * (654238.8750 + 1601555.7500) = 22254.2441
[LAV DEBUG]   Pair (1,0) completed in 0.25s
[LAV DEBUG]   GPU Memory after pair: 14.62GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 44508.4883
[LAV DEBUG] Total time: 0.73s
[LAV DEBUG] Avg time per pair: 0.36s
============================================================

[MEM After loss computation] Allocated: 14.62GB | Reserved: 16.92GB | Peak: 20.26GB
[MEM Before backward] Allocated: 14.62GB | Reserved: 16.92GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 21.32GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 21.32GB | Peak: 20.26GB
[MEM Batch 41 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.67GB | Reserved: 5.05GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([756, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([575, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.67GB, Reserved: 5.05GB

[LAV DEBUG] Processing pair (0,1): N=756, M=575
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.008888
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=756) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 190509.093750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=575) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 110207.328125
[LAV DEBUG]   Pair loss = -115.0089 + 0.01 * (190509.0938 + 110207.3281) = 2892.1555
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.88GB

[LAV DEBUG] Processing pair (1,0): N=575, M=756
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.008888
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=575) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 110207.328125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=756) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 190509.093750
[LAV DEBUG]   Pair loss = -115.0089 + 0.01 * (110207.3281 + 190509.0938) = 2892.1555
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.09GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5784.3110
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 5.09GB | Reserved: 5.68GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.09GB | Reserved: 5.68GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.10GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.10GB | Peak: 20.26GB
[MEM Batch 42 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.43GB | Reserved: 3.76GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([429, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([502, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.43GB, Reserved: 3.76GB

[LAV DEBUG] Processing pair (0,1): N=429, M=502
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.111252
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=429) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61347.148438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=502) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 84001.000000
[LAV DEBUG]   Pair loss = -81.1113 + 0.01 * (61347.1484 + 84001.0000) = 1372.3704
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.54GB

[LAV DEBUG] Processing pair (1,0): N=502, M=429
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.111252
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=502) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 84001.000000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=429) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61347.148438
[LAV DEBUG]   Pair loss = -81.1113 + 0.01 * (84001.0000 + 61347.1484) = 1372.3704
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.64GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2744.7407
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 3.64GB | Reserved: 3.86GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.64GB | Reserved: 3.86GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.38GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.38GB | Peak: 20.26GB
[MEM Batch 43 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.16GB | Reserved: 2.39GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([294, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.16GB, Reserved: 2.39GB

[LAV DEBUG] Processing pair (0,1): N=224, M=294
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.473770
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.681641
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=294) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28813.025391
[LAV DEBUG]   Pair loss = -44.4738 + 0.01 * (16726.6816 + 28813.0254) = 410.9233
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.19GB

[LAV DEBUG] Processing pair (1,0): N=294, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.473770
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=294) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28813.025391
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.681641
[LAV DEBUG]   Pair loss = -44.4738 + 0.01 * (28813.0254 + 16726.6816) = 410.9233
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.23GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 821.8466
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.23GB | Reserved: 2.34GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.23GB | Reserved: 2.34GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.77GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.77GB | Peak: 20.26GB
[MEM Batch 44 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 7.33GB | Reserved: 7.92GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([759, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.33GB, Reserved: 7.92GB

[LAV DEBUG] Processing pair (0,1): N=1438, M=759
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -178.081543
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 689267.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=759) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 192024.406250
[LAV DEBUG]   Pair loss = -178.0815 + 0.01 * (689267.8125 + 192024.4062) = 8634.8398
[LAV DEBUG]   Pair (0,1) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 7.86GB

[LAV DEBUG] Processing pair (1,0): N=759, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -178.081543
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=759) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 192024.406250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 689267.812500
[LAV DEBUG]   Pair loss = -178.0815 + 0.01 * (192024.4062 + 689267.8125) = 8634.8398
[LAV DEBUG]   Pair (1,0) completed in 0.09s
[LAV DEBUG]   GPU Memory after pair: 8.39GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 17269.6797
[LAV DEBUG] Total time: 0.42s
[LAV DEBUG] Avg time per pair: 0.21s
============================================================

[MEM After loss computation] Allocated: 8.39GB | Reserved: 8.95GB | Peak: 20.26GB
[MEM Before backward] Allocated: 8.39GB | Reserved: 8.95GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 10.54GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 10.54GB | Peak: 20.26GB
[MEM Batch 45 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.88GB | Reserved: 2.15GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([253, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([173, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.88GB, Reserved: 2.15GB

[LAV DEBUG] Processing pair (0,1): N=253, M=173
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.977699
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=253) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21337.542969
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=173) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9977.756836
[LAV DEBUG]   Pair loss = -35.9777 + 0.01 * (21337.5430 + 9977.7568) = 277.1753
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.90GB

[LAV DEBUG] Processing pair (1,0): N=173, M=253
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.977699
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=173) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9977.756836
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=253) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21337.542969
[LAV DEBUG]   Pair loss = -35.9777 + 0.01 * (9977.7568 + 21337.5430) = 277.1753
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.92GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 554.3506
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.11s
============================================================

[MEM After loss computation] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.36GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.36GB | Peak: 20.26GB
[MEM Batch 46 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.96GB | Reserved: 2.22GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([271, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([181, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.96GB, Reserved: 2.22GB

[LAV DEBUG] Processing pair (0,1): N=271, M=181
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.059929
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=271) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24481.535156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=181) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10921.777344
[LAV DEBUG]   Pair loss = -38.0599 + 0.01 * (24481.5352 + 10921.7773) = 315.9732
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.98GB

[LAV DEBUG] Processing pair (1,0): N=181, M=271
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.059929
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=181) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10921.777344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=271) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24481.535156
[LAV DEBUG]   Pair loss = -38.0599 + 0.01 * (10921.7773 + 24481.5352) = 315.9732
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 631.9464
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.01GB | Reserved: 2.12GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.01GB | Reserved: 2.12GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.45GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.45GB | Peak: 20.26GB
[MEM Batch 47 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 10.71GB | Reserved: 11.56GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1796, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 10.71GB, Reserved: 11.56GB

[LAV DEBUG] Processing pair (0,1): N=1796, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -287.712189
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1075183.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 746989.875000
[LAV DEBUG]   Pair loss = -287.7122 + 0.01 * (1075183.7500 + 746989.8750) = 17934.0234
[LAV DEBUG]   Pair (0,1) completed in 0.22s
[LAV DEBUG]   GPU Memory after pair: 12.02GB

[LAV DEBUG] Processing pair (1,0): N=1497, M=1796
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -287.712189
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 746989.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1075183.750000
[LAV DEBUG]   Pair loss = -287.7122 + 0.01 * (746989.8750 + 1075183.7500) = 17934.0234
[LAV DEBUG]   Pair (1,0) completed in 0.22s
[LAV DEBUG]   GPU Memory after pair: 13.32GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 35868.0469
[LAV DEBUG] Total time: 0.70s
[LAV DEBUG] Avg time per pair: 0.35s
============================================================

[MEM After loss computation] Allocated: 13.32GB | Reserved: 15.39GB | Peak: 20.26GB
[MEM Before backward] Allocated: 13.32GB | Reserved: 15.39GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 19.24GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 19.24GB | Peak: 20.26GB
[MEM Batch 48 START - Task GreekSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.71GB | Reserved: 4.08GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([364, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([658, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.71GB, Reserved: 4.08GB

[LAV DEBUG] Processing pair (0,1): N=364, M=658
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -83.500549
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=364) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 44166.148438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=658) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 144319.968750
[LAV DEBUG]   Pair loss = -83.5005 + 0.01 * (44166.1484 + 144319.9688) = 1801.3606
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.83GB

[LAV DEBUG] Processing pair (1,0): N=658, M=364
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -83.500549
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=658) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 144319.968750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=364) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 44166.148438
[LAV DEBUG]   Pair loss = -83.5005 + 0.01 * (144319.9688 + 44166.1484) = 1801.3606
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3602.7212
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.95GB | Reserved: 4.21GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.94GB | Reserved: 4.21GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.56GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.56GB | Peak: 20.26GB
[MEM Batch 49 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.83GB | Reserved: 2.11GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([213, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.83GB, Reserved: 2.11GB

[LAV DEBUG] Processing pair (0,1): N=199, M=213
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.780613
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13201.748047
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=213) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15124.421875
[LAV DEBUG]   Pair loss = -35.7806 + 0.01 * (13201.7480 + 15124.4219) = 247.4811
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.85GB

[LAV DEBUG] Processing pair (1,0): N=213, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.780613
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=213) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15124.421875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13201.748047
[LAV DEBUG]   Pair loss = -35.7806 + 0.01 * (15124.4219 + 13201.7480) = 247.4811
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.87GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 494.9622
[LAV DEBUG] Total time: 0.22s
[LAV DEBUG] Avg time per pair: 0.11s
============================================================

[MEM After loss computation] Allocated: 1.87GB | Reserved: 2.01GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.87GB | Reserved: 2.01GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.29GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.29GB | Peak: 20.26GB
[MEM Batch 50 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.35GB | Reserved: 3.69GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([436, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([469, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.35GB, Reserved: 3.69GB

[LAV DEBUG] Processing pair (0,1): N=436, M=469
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.141411
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=436) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 63365.734375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=469) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73320.539062
[LAV DEBUG]   Pair loss = -79.1414 + 0.01 * (63365.7344 + 73320.5391) = 1287.7214
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.45GB

[LAV DEBUG] Processing pair (1,0): N=469, M=436
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.141411
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=469) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73320.539062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=436) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 63365.734375
[LAV DEBUG]   Pair loss = -79.1414 + 0.01 * (73320.5391 + 63365.7344) = 1287.7214
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2575.4429
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.55GB | Reserved: 3.78GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.55GB | Reserved: 3.78GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.28GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.28GB | Peak: 20.26GB
[MEM Batch 51 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.19GB | Reserved: 3.56GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([423, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([430, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.19GB, Reserved: 3.56GB

[LAV DEBUG] Processing pair (0,1): N=423, M=430
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -74.642387
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=423) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59643.546875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=430) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61633.847656
[LAV DEBUG]   Pair loss = -74.6424 + 0.01 * (59643.5469 + 61633.8477) = 1138.1316
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.28GB

[LAV DEBUG] Processing pair (1,0): N=430, M=423
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -74.642387
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=430) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61633.847656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=423) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59643.546875
[LAV DEBUG]   Pair loss = -74.6424 + 0.01 * (61633.8477 + 59643.5469) = 1138.1316
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.37GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2276.2632
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.37GB | Reserved: 3.63GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.37GB | Reserved: 3.63GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.11GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.11GB | Peak: 20.26GB
[MEM Batch 52 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.68GB | Reserved: 3.03GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([373, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([313, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.68GB, Reserved: 3.03GB

[LAV DEBUG] Processing pair (0,1): N=373, M=313
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.566387
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=373) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 46377.070312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=313) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32657.343750
[LAV DEBUG]   Pair loss = -59.5664 + 0.01 * (46377.0703 + 32657.3438) = 730.7777
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.74GB

[LAV DEBUG] Processing pair (1,0): N=313, M=373
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.566387
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=313) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32657.343750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=373) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 46377.070312
[LAV DEBUG]   Pair loss = -59.5664 + 0.01 * (32657.3438 + 46377.0703) = 730.7777
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.79GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1461.5554
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.79GB | Reserved: 2.98GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.79GB | Reserved: 2.98GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.36GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.36GB | Peak: 20.26GB
[MEM Batch 53 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.65GB | Reserved: 1.86GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([184, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.65GB, Reserved: 1.86GB

[LAV DEBUG] Processing pair (0,1): N=184, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.482393
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=184) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11286.803711
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.513672
[LAV DEBUG]   Pair loss = -30.4824 + 0.01 * (11286.8037 + 9409.5137) = 176.4808
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.66GB

[LAV DEBUG] Processing pair (1,0): N=168, M=184
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.482393
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.513672
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=184) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11286.803711
[LAV DEBUG]   Pair loss = -30.4824 + 0.01 * (9409.5137 + 11286.8037) = 176.4808
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.68GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 352.9615
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.68GB | Reserved: 1.75GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.68GB | Reserved: 1.75GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.12GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.12GB | Peak: 20.26GB
[MEM Batch 54 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.40GB | Reserved: 1.59GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.40GB, Reserved: 1.59GB

[LAV DEBUG] Processing pair (0,1): N=179, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -21.546408
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10681.808594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.618652
[LAV DEBUG]   Pair loss = -21.5464 + 0.01 * (10681.8086 + 2884.6187) = 114.1179
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.41GB

[LAV DEBUG] Processing pair (1,0): N=93, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -21.546408
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.618652
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10681.808594
[LAV DEBUG]   Pair loss = -21.5464 + 0.01 * (2884.6187 + 10681.8086) = 114.1179
[LAV DEBUG]   Pair (1,0) completed in 0.00s
[LAV DEBUG]   GPU Memory after pair: 1.42GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 228.2357
[LAV DEBUG] Total time: 0.23s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.42GB | Reserved: 1.48GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.42GB | Reserved: 1.48GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.84GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.84GB | Peak: 20.26GB
[MEM Batch 55 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.71GB | Reserved: 3.06GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([305, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([390, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.71GB, Reserved: 3.06GB

[LAV DEBUG] Processing pair (0,1): N=305, M=390
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.993572
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=305) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31009.367188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=390) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 50700.707031
[LAV DEBUG]   Pair loss = -59.9936 + 0.01 * (31009.3672 + 50700.7070) = 757.1072
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.76GB

[LAV DEBUG] Processing pair (1,0): N=390, M=305
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -59.993572
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=390) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 50700.707031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=305) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31009.367188
[LAV DEBUG]   Pair loss = -59.9936 + 0.01 * (50700.7070 + 31009.3672) = 757.1072
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.82GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1514.2144
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.82GB | Reserved: 3.01GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.82GB | Reserved: 3.01GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.39GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.39GB | Peak: 20.26GB
[MEM Batch 56 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.39GB | Reserved: 3.72GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([447, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([470, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.39GB, Reserved: 3.72GB

[LAV DEBUG] Processing pair (0,1): N=447, M=470
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.242775
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=447) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 66603.421875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=470) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73633.593750
[LAV DEBUG]   Pair loss = -80.2428 + 0.01 * (66603.4219 + 73633.5938) = 1322.1273
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.49GB

[LAV DEBUG] Processing pair (1,0): N=470, M=447
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.242775
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=470) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73633.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=447) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 66603.421875
[LAV DEBUG]   Pair loss = -80.2428 + 0.01 * (73633.5938 + 66603.4219) = 1322.1273
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.59GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2644.2546
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.59GB | Reserved: 3.82GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.59GB | Reserved: 3.82GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.33GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.33GB | Peak: 20.26GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.31GB | Reserved: 2.62GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([229, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([339, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.31GB, Reserved: 2.62GB

[LAV DEBUG] Processing pair (0,1): N=229, M=339
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.032913
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=229) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 17481.763672
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=339) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38307.957031
[LAV DEBUG]   Pair loss = -48.0329 + 0.01 * (17481.7637 + 38307.9570) = 509.8643
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.35GB

[LAV DEBUG] Processing pair (1,0): N=339, M=229
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.032913
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=339) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38307.957031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=229) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 17481.763672
[LAV DEBUG]   Pair loss = -48.0329 + 0.01 * (38307.9570 + 17481.7637) = 509.8643
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.39GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1019.7285
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.39GB | Reserved: 2.54GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.39GB | Reserved: 2.54GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.92GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.92GB | Peak: 20.26GB
[MEM Batch 58 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.47GB | Reserved: 2.74GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([381, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.47GB, Reserved: 2.74GB

[LAV DEBUG] Processing pair (0,1): N=236, M=381
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.435875
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18566.708984
[2026-02-01 00:15:53,051 - INFO - alignment_training_loop.py:269] - [BATCH 62] Task: ContinentalBreakfast.egtea
[2026-02-01 00:15:53,301 - INFO - alignment_training_loop.py:286] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [491, 543]
[2026-02-01 00:15:58,809 - INFO - alignment_training_loop.py:323] - [BATCH 62] Loss value: 3392.0591
[2026-02-01 00:16:06,255 - INFO - alignment_training_loop.py:269] - [BATCH 63] Task: Eggs.cmu
[2026-02-01 00:16:06,400 - INFO - alignment_training_loop.py:286] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [378, 196]
[2026-02-01 00:16:09,561 - INFO - alignment_training_loop.py:323] - [BATCH 63] Loss value: 1116.8151
[2026-02-01 00:16:13,688 - INFO - alignment_training_loop.py:269] - [BATCH 64] Task: pc_assembly
[2026-02-01 00:16:13,952 - INFO - alignment_training_loop.py:286] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [555, 574]
[2026-02-01 00:16:19,972 - INFO - alignment_training_loop.py:323] - [BATCH 64] Loss value: 4052.1208
[2026-02-01 00:16:28,069 - INFO - alignment_training_loop.py:269] - [BATCH 65] Task: pc_assembly
[2026-02-01 00:16:28,325 - INFO - alignment_training_loop.py:286] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [581, 555]
[2026-02-01 00:16:34,358 - INFO - alignment_training_loop.py:323] - [BATCH 65] Loss value: 4104.8271
[2026-02-01 00:16:42,514 - INFO - alignment_training_loop.py:269] - [BATCH 66] Task: Salad.cmu
[2026-02-01 00:16:42,657 - INFO - alignment_training_loop.py:286] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [279, 273]
[2026-02-01 00:16:45,689 - INFO - alignment_training_loop.py:323] - [BATCH 66] Loss value: 919.5850
[2026-02-01 00:16:49,650 - INFO - alignment_training_loop.py:269] - [BATCH 67] Task: Pizza.egtea
[2026-02-01 00:16:50,105 - INFO - alignment_training_loop.py:286] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [1236, 747]
[2026-02-01 00:17:00,624 - INFO - alignment_training_loop.py:323] - [BATCH 67] Loss value: 13573.2715
[2026-02-01 00:17:15,029 - INFO - alignment_training_loop.py:269] - [BATCH 68] Task: ContinentalBreakfast.egtea
[2026-02-01 00:17:15,446 - INFO - alignment_training_loop.py:286] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [474, 1343]
[2026-02-01 00:17:24,990 - INFO - alignment_training_loop.py:323] - [BATCH 68] Loss value: 13262.9297
[2026-02-01 00:17:38,107 - INFO - alignment_training_loop.py:269] - [BATCH 69] Task: Eggs.cmu
[2026-02-01 00:17:38,270 - INFO - alignment_training_loop.py:286] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [355, 292]
[2026-02-01 00:17:41,816 - INFO - alignment_training_loop.py:323] - [BATCH 69] Loss value: 1296.4990
[2026-02-01 00:17:46,454 - INFO - alignment_training_loop.py:269] - [BATCH 70] Task: meccano
[2026-02-01 00:17:47,078 - INFO - alignment_training_loop.py:286] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [1341, 1410]
[2026-02-01 00:18:01,641 - INFO - alignment_training_loop.py:323] - [BATCH 70] Loss value: 24758.6895
[2026-02-01 00:18:21,911 - INFO - alignment_training_loop.py:269] - [BATCH 71] Task: TurkeySandwich.egtea
[2026-02-01 00:18:22,152 - INFO - alignment_training_loop.py:286] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [582, 383]
[2026-02-01 00:18:27,227 - INFO - alignment_training_loop.py:323] - [BATCH 71] Loss value: 3072.9033
[2026-02-01 00:18:34,132 - INFO - alignment_training_loop.py:269] - [BATCH 72] Task: Brownie.cmu
[2026-02-01 00:18:34,304 - INFO - alignment_training_loop.py:286] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [297, 416]
[2026-02-01 00:18:38,152 - INFO - alignment_training_loop.py:323] - [BATCH 72] Loss value: 1619.9924
[2026-02-01 00:18:43,247 - INFO - alignment_training_loop.py:269] - [BATCH 73] Task: Eggs.cmu
[2026-02-01 00:18:43,376 - INFO - alignment_training_loop.py:286] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [237, 264]
[2026-02-01 00:18:46,162 - INFO - alignment_training_loop.py:323] - [BATCH 73] Loss value: 752.0655
[2026-02-01 00:18:49,763 - INFO - alignment_training_loop.py:269] - [BATCH 74] Task: pc_disassembly
[2026-02-01 00:18:49,922 - INFO - alignment_training_loop.py:286] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [317, 314]
[2026-02-01 00:18:53,359 - INFO - alignment_training_loop.py:323] - [BATCH 74] Loss value: 1217.0890
[2026-02-01 00:18:57,922 - INFO - alignment_training_loop.py:269] - [BATCH 75] Task: GreekSalad.egtea
[2026-02-01 00:18:58,224 - INFO - alignment_training_loop.py:286] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [850, 467]
[2026-02-01 00:19:05,224 - INFO - alignment_training_loop.py:323] - [BATCH 75] Loss value: 6055.3906
[2026-02-01 00:19:14,711 - INFO - alignment_training_loop.py:269] - [BATCH 76] Task: BaconAndEggs.egtea
[2026-02-01 00:19:15,622 - INFO - alignment_training_loop.py:286] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [2332, 1825]
[2026-02-01 00:19:37,241 - WARNING - alignment_training_loop.py:302] - Skipping batch in task BaconAndEggs.egtea due to: CUDA out of memory. Tried to allocate 2.03 GiB (GPU 0; 22.16 GiB total capacity; 17.47 GiB already allocated; 1.45 GiB free; 20.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2026-02-01 00:19:37,241 - ERROR - alignment_training_loop.py:305] - [OOM] Task: BaconAndEggs.egtea, Sequences: 2, Lengths: [2332, 1825]
[2026-02-01 00:19:37,352 - INFO - alignment_training_loop.py:269] - [BATCH 77] Task: pc_assembly
[2026-02-01 00:19:37,665 - INFO - alignment_training_loop.py:286] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [656, 656]
[2026-02-01 00:19:45,154 - INFO - alignment_training_loop.py:323] - [BATCH 77] Loss value: 5507.6353
[2026-02-01 00:19:54,636 - INFO - alignment_training_loop.py:269] - [BATCH 78] Task: Brownie.cmu
[2026-02-01 00:19:54,796 - INFO - alignment_training_loop.py:286] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [335, 359]
[2026-02-01 00:19:58,541 - INFO - alignment_training_loop.py:323] - [BATCH 78] Loss value: 1486.2463
[2026-02-01 00:20:03,537 - INFO - alignment_training_loop.py:269] - [BATCH 79] Task: BaconAndEggs.egtea
[2026-02-01 00:20:04,170 - INFO - alignment_training_loop.py:286] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [1070, 1727]
[2026-02-01 00:20:18,860 - INFO - alignment_training_loop.py:323] - [BATCH 79] Loss value: 27045.8867
[2026-02-01 00:20:39,319 - INFO - alignment_training_loop.py:269] - [BATCH 80] Task: Pizza.cmu
[2026-02-01 00:20:39,629 - INFO - alignment_training_loop.py:286] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [531, 762]
[2026-02-01 00:20:46,446 - INFO - alignment_training_loop.py:323] - [BATCH 80] Loss value: 5529.7271
[2026-02-01 00:20:55,697 - INFO - alignment_training_loop.py:269] - [BATCH 81] Task: Salad.cmu
[2026-02-01 00:20:55,822 - INFO - alignment_training_loop.py:286] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [223, 272]
[2026-02-01 00:20:58,600 - INFO - alignment_training_loop.py:323] - [BATCH 81] Loss value: 739.2595
[2026-02-01 00:21:02,164 - INFO - alignment_training_loop.py:269] - [BATCH 82] Task: Sandwich.cmu
[2026-02-01 00:21:02,271 - INFO - alignment_training_loop.py:286] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [238, 188]
[2026-02-01 00:21:04,686 - INFO - alignment_training_loop.py:323] - [BATCH 82] Loss value: 540.0541
[2026-02-01 00:21:07,726 - INFO - alignment_training_loop.py:269] - [BATCH 83] Task: Brownie.cmu
[2026-02-01 00:21:07,946 - INFO - alignment_training_loop.py:286] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [418, 491]
[2026-02-01 00:21:12,796 - INFO - alignment_training_loop.py:323] - [BATCH 83] Loss value: 2613.7344
[2026-02-01 00:21:19,338 - INFO - alignment_training_loop.py:269] - [BATCH 84] Task: meccano
[2026-02-01 00:21:19,855 - INFO - alignment_training_loop.py:286] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [838, 1474]
[2026-02-01 00:21:32,038 - INFO - alignment_training_loop.py:323] - [BATCH 84] Loss value: 18784.4316
[2026-02-01 00:21:48,804 - INFO - alignment_training_loop.py:269] - [BATCH 85] Task: Cheeseburger.egtea
[2026-02-01 00:21:49,130 - INFO - alignment_training_loop.py:286] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [670, 680]
[2026-02-01 00:21:56,332 - INFO - alignment_training_loop.py:323] - [BATCH 85] Loss value: 5838.4546
[2026-02-01 00:22:06,048 - INFO - alignment_training_loop.py:269] - [BATCH 86] Task: Eggs.cmu
[2026-02-01 00:22:06,217 - INFO - alignment_training_loop.py:286] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [349, 347]
[2026-02-01 00:22:10,027 - INFO - alignment_training_loop.py:323] - [BATCH 86] Loss value: 1493.1329
[2026-02-01 00:22:15,037 - INFO - alignment_training_loop.py:269] - [BATCH 87] Task: BaconAndEggs.egtea
[2026-02-01 00:22:15,420 - INFO - alignment_training_loop.py:286] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [856, 826]
[2026-02-01 00:22:24,287 - INFO - alignment_training_loop.py:323] - [BATCH 87] Loss value: 9138.0244
[2026-02-01 00:22:36,461 - INFO - alignment_training_loop.py:269] - [BATCH 88] Task: Brownie.cmu
[2026-02-01 00:22:36,733 - INFO - alignment_training_loop.py:286] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [621, 523]
[2026-02-01 00:22:42,875 - INFO - alignment_training_loop.py:323] - [BATCH 88] Loss value: 4195.0825
[2026-02-01 00:22:51,067 - INFO - alignment_training_loop.py:269] - [BATCH 89] Task: Eggs.cmu
[2026-02-01 00:22:51,218 - INFO - alignment_training_loop.py:286] - [BATCH 89] After preprocessing - Num sequences: 2, Lengths: [246, 368]
[2026-02-01 00:22:54,589 - INFO - alignment_training_loop.py:323] - [BATCH 89] Loss value: 1202.5641
[2026-02-01 00:22:58,997 - INFO - alignment_training_loop.py:269] - [BATCH 90] Task: GreekSalad.egtea
[2026-02-01 00:22:59,303 - INFO - alignment_training_loop.py:286] - [BATCH 90] After preprocessing - Num sequences: 2, Lengths: [808, 484]
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=381) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48387.781250
[LAV DEBUG]   Pair loss = -51.4359 + 0.01 * (18566.7090 + 48387.7812) = 618.1091
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.51GB

[LAV DEBUG] Processing pair (1,0): N=381, M=236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.435875
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=381) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 48387.781250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18566.708984
[LAV DEBUG]   Pair loss = -51.4359 + 0.01 * (48387.7812 + 18566.7090) = 618.1091
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.55GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1236.2181
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.55GB | Reserved: 2.72GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.55GB | Reserved: 2.72GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.17GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.17GB | Peak: 20.26GB
[MEM Batch 59 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.42GB | Reserved: 3.73GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([528, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([397, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.42GB, Reserved: 3.73GB

[LAV DEBUG] Processing pair (0,1): N=528, M=397
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.672287
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=528) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 92928.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=397) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52537.035156
[LAV DEBUG]   Pair loss = -79.6723 + 0.01 * (92928.0781 + 52537.0352) = 1374.9788
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.52GB

[LAV DEBUG] Processing pair (1,0): N=397, M=528
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.672287
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=397) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52537.035156
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=528) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 92928.078125
[LAV DEBUG]   Pair loss = -79.6723 + 0.01 * (52537.0352 + 92928.0781) = 1374.9788
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.62GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2749.9575
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.62GB | Reserved: 3.93GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.62GB | Reserved: 3.93GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.45GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.45GB | Peak: 20.26GB
[MEM Batch 60 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.43GB | Reserved: 2.72GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([325, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([282, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.43GB, Reserved: 2.72GB

[LAV DEBUG] Processing pair (0,1): N=325, M=282
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.765751
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=325) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35209.417969
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=282) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 26509.314453
[LAV DEBUG]   Pair loss = -52.7658 + 0.01 * (35209.4180 + 26509.3145) = 564.4216
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.48GB

[LAV DEBUG] Processing pair (1,0): N=282, M=325
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.765751
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=282) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 26509.314453
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=325) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35209.417969
[LAV DEBUG]   Pair loss = -52.7658 + 0.01 * (26509.3145 + 35209.4180) = 564.4216
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.52GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1128.8431
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.52GB | Reserved: 2.71GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.52GB | Reserved: 2.71GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.16GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.16GB | Peak: 20.26GB
[MEM Batch 61 START - Task tent] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 5.15GB | Reserved: 5.55GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([768, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([721, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.15GB, Reserved: 5.55GB

[LAV DEBUG] Processing pair (0,1): N=768, M=721
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.568924
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=768) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 196606.140625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=721) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 173278.781250
[LAV DEBUG]   Pair loss = -130.5689 + 0.01 * (196606.1406 + 173278.7812) = 3568.2805
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.42GB

[LAV DEBUG] Processing pair (1,0): N=721, M=768
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -130.568924
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=721) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 173278.781250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=768) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 196606.140625
[LAV DEBUG]   Pair loss = -130.5689 + 0.01 * (173278.7812 + 196606.1406) = 3568.2805
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.69GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7136.5610
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.69GB | Reserved: 6.09GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.69GB | Reserved: 6.09GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.88GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.88GB | Peak: 20.26GB
[MEM Batch 62 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.75GB | Reserved: 4.11GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([491, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.75GB, Reserved: 4.11GB

[LAV DEBUG] Processing pair (0,1): N=491, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.404488
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=491) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 80360.476562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 98282.937500
[LAV DEBUG]   Pair loss = -90.4045 + 0.01 * (80360.4766 + 98282.9375) = 1696.0295
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.88GB

[LAV DEBUG] Processing pair (1,0): N=543, M=491
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.404488
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 98282.937500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=491) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 80360.476562
[LAV DEBUG]   Pair loss = -90.4045 + 0.01 * (98282.9375 + 80360.4766) = 1696.0295
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3392.0591
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.01GB | Reserved: 4.39GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.01GB | Reserved: 4.39GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.65GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.65GB | Peak: 20.26GB
[MEM Batch 63 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.33GB | Reserved: 2.64GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([378, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.33GB, Reserved: 2.64GB

[LAV DEBUG] Processing pair (0,1): N=378, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.949051
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=378) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47628.820312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.836914
[LAV DEBUG]   Pair loss = -45.9491 + 0.01 * (47628.8203 + 12806.8369) = 558.4075
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.37GB

[LAV DEBUG] Processing pair (1,0): N=196, M=378
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -45.949051
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.836914
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=378) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47628.820312
[LAV DEBUG]   Pair loss = -45.9491 + 0.01 * (12806.8369 + 47628.8203) = 558.4075
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.40GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1116.8151
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.40GB | Reserved: 2.57GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.40GB | Reserved: 2.57GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.95GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.95GB | Peak: 20.26GB
[MEM Batch 64 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.04GB | Reserved: 4.44GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([555, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([574, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.04GB, Reserved: 4.44GB

[LAV DEBUG] Processing pair (0,1): N=555, M=574
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.935692
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=555) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 102674.648438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=574) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 109824.960938
[LAV DEBUG]   Pair loss = -98.9357 + 0.01 * (102674.6484 + 109824.9609) = 2026.0604
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.20GB

[LAV DEBUG] Processing pair (1,0): N=574, M=555
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.935692
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=574) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 109824.960938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=555) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 102674.648438
[LAV DEBUG]   Pair loss = -98.9357 + 0.01 * (109824.9609 + 102674.6484) = 2026.0604
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.36GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4052.1208
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 4.36GB | Reserved: 4.64GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.35GB | Reserved: 4.64GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.10GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.10GB | Peak: 20.26GB
[MEM Batch 65 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.07GB | Reserved: 4.46GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([581, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([555, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.07GB, Reserved: 4.46GB

[LAV DEBUG] Processing pair (0,1): N=581, M=555
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -99.532852
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=581) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 112519.976562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=555) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 102674.679688
[LAV DEBUG]   Pair loss = -99.5329 + 0.01 * (112519.9766 + 102674.6797) = 2052.4136
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.22GB

[LAV DEBUG] Processing pair (1,0): N=555, M=581
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -99.532852
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=555) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 102674.679688
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=581) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 112519.976562
[LAV DEBUG]   Pair loss = -99.5329 + 0.01 * (102674.6797 + 112519.9766) = 2052.4136
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.38GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4104.8271
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 4.38GB | Reserved: 4.66GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.38GB | Reserved: 4.66GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.13GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.13GB | Peak: 20.26GB
[MEM Batch 66 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.27GB | Reserved: 2.59GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([279, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.27GB, Reserved: 2.59GB

[LAV DEBUG] Processing pair (0,1): N=279, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.134300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=279) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 25948.328125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24844.355469
[LAV DEBUG]   Pair loss = -48.1343 + 0.01 * (25948.3281 + 24844.3555) = 459.7925
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.30GB

[LAV DEBUG] Processing pair (1,0): N=273, M=279
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -48.134300
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24844.355469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=279) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 25948.328125
[LAV DEBUG]   Pair loss = -48.1343 + 0.01 * (24844.3555 + 25948.3281) = 459.7925
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.34GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 919.5850
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.34GB | Reserved: 2.48GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.86GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.86GB | Peak: 20.26GB
[MEM Batch 67 START - Task Pizza.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 6.69GB | Reserved: 7.21GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([747, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 6.69GB, Reserved: 7.21GB

[LAV DEBUG] Processing pair (0,1): N=1236, M=747
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -165.621826
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 509224.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=747) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 186001.281250
[LAV DEBUG]   Pair loss = -165.6218 + 0.01 * (509224.5000 + 186001.2812) = 6786.6357
[LAV DEBUG]   Pair (0,1) completed in 0.08s
[LAV DEBUG]   GPU Memory after pair: 7.13GB

[LAV DEBUG] Processing pair (1,0): N=747, M=1236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -165.621826
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=747) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 186001.281250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 509224.500000
[LAV DEBUG]   Pair loss = -165.6218 + 0.01 * (186001.2812 + 509224.5000) = 6786.6357
[LAV DEBUG]   Pair (1,0) completed in 0.08s
[LAV DEBUG]   GPU Memory after pair: 7.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 13573.2715
[LAV DEBUG] Total time: 0.38s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 7.58GB | Reserved: 8.09GB | Peak: 20.26GB
[MEM Before backward] Allocated: 7.58GB | Reserved: 8.09GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 9.42GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 9.42GB | Peak: 20.26GB
[MEM Batch 68 START - Task ContinentalBreakfast.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 6.16GB | Reserved: 6.71GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([474, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1343, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 6.16GB, Reserved: 6.71GB

[LAV DEBUG] Processing pair (0,1): N=474, M=1343
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -129.503876
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=474) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 74892.460938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1343) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 601204.437500
[LAV DEBUG]   Pair loss = -129.5039 + 0.01 * (74892.4609 + 601204.4375) = 6631.4648
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 6.47GB

[LAV DEBUG] Processing pair (1,0): N=1343, M=474
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -129.503876
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1343) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 601204.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=474) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 74892.460938
[LAV DEBUG]   Pair loss = -129.5039 + 0.01 * (601204.4375 + 74892.4609) = 6631.4648
[LAV DEBUG]   Pair (1,0) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 6.78GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 13262.9297
[LAV DEBUG] Total time: 0.34s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 6.78GB | Reserved: 7.32GB | Peak: 20.26GB
[MEM Before backward] Allocated: 6.78GB | Reserved: 7.32GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.23GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 8.23GB | Peak: 20.26GB
[MEM Batch 69 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.56GB | Reserved: 2.82GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([355, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([292, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.56GB, Reserved: 2.82GB

[LAV DEBUG] Processing pair (0,1): N=355, M=292
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.068985
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=355) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 42009.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=292) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28422.539062
[LAV DEBUG]   Pair loss = -56.0690 + 0.01 * (42009.3125 + 28422.5391) = 648.2495
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.61GB

[LAV DEBUG] Processing pair (1,0): N=292, M=355
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -56.068985
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=292) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28422.539062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=355) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 42009.312500
[LAV DEBUG]   Pair loss = -56.0690 + 0.01 * (28422.5391 + 42009.3125) = 648.2495
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.66GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1296.4990
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.66GB | Reserved: 2.82GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.66GB | Reserved: 2.82GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.29GB | Peak: 20.26GB
[MEM Batch 70 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 9.04GB | Reserved: 9.75GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1410, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.04GB, Reserved: 9.75GB

[LAV DEBUG] Processing pair (0,1): N=1341, M=1410
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -241.750122
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 599418.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1410) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 662690.812500
[LAV DEBUG]   Pair loss = -241.7501 + 0.01 * (599418.6250 + 662690.8125) = 12379.3447
[LAV DEBUG]   Pair (0,1) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 9.96GB

[LAV DEBUG] Processing pair (1,0): N=1410, M=1341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -241.750122
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1410) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 662690.812500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 599418.625000
[LAV DEBUG]   Pair loss = -241.7501 + 0.01 * (662690.8125 + 599418.6250) = 12379.3447
[LAV DEBUG]   Pair (1,0) completed in 0.16s
[LAV DEBUG]   GPU Memory after pair: 10.87GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 24758.6895
[LAV DEBUG] Total time: 0.57s
[LAV DEBUG] Avg time per pair: 0.28s
============================================================

[MEM After loss computation] Allocated: 10.87GB | Reserved: 11.57GB | Peak: 20.26GB
[MEM Before backward] Allocated: 10.87GB | Reserved: 11.57GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.29GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.29GB | Peak: 20.26GB
[MEM Batch 71 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.54GB | Reserved: 3.94GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([582, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([383, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.54GB, Reserved: 3.94GB

[LAV DEBUG] Processing pair (0,1): N=582, M=383
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.595207
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=582) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 112907.539062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=383) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 48897.148438
[LAV DEBUG]   Pair loss = -81.5952 + 0.01 * (112907.5391 + 48897.1484) = 1536.4517
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.65GB

[LAV DEBUG] Processing pair (1,0): N=383, M=582
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.595207
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=383) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 48897.148438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=582) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 112907.539062
[LAV DEBUG]   Pair loss = -81.5952 + 0.01 * (48897.1484 + 112907.5391) = 1536.4517
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.75GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3072.9033
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.75GB | Reserved: 4.04GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.75GB | Reserved: 4.04GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.37GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.37GB | Peak: 20.26GB
[MEM Batch 72 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.76GB | Reserved: 3.10GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([297, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([416, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.76GB, Reserved: 3.10GB

[LAV DEBUG] Processing pair (0,1): N=297, M=416
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.905815
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=297) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29404.136719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=416) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 57686.070312
[LAV DEBUG]   Pair loss = -60.9058 + 0.01 * (29404.1367 + 57686.0703) = 809.9962
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.82GB

[LAV DEBUG] Processing pair (1,0): N=416, M=297
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.905815
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=416) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 57686.070312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=297) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29404.136719
[LAV DEBUG]   Pair loss = -60.9058 + 0.01 * (57686.0703 + 29404.1367) = 809.9962
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.88GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1619.9924
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.88GB | Reserved: 3.05GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.88GB | Reserved: 3.05GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.45GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.45GB | Peak: 20.26GB
[MEM Batch 73 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.11GB | Reserved: 2.34GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([237, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.11GB, Reserved: 2.34GB

[LAV DEBUG] Processing pair (0,1): N=237, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -43.545586
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=237) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18724.447266
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 23233.386719
[LAV DEBUG]   Pair loss = -43.5456 + 0.01 * (18724.4473 + 23233.3867) = 376.0327
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.14GB

[LAV DEBUG] Processing pair (1,0): N=264, M=237
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -43.545586
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 23233.386719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=237) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18724.447266
[LAV DEBUG]   Pair loss = -43.5456 + 0.01 * (23233.3867 + 18724.4473) = 376.0327
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.17GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 752.0655
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.17GB | Reserved: 2.30GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.17GB | Reserved: 2.30GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.71GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.71GB | Peak: 20.26GB
[MEM Batch 74 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.51GB | Reserved: 2.79GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([317, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([314, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.51GB, Reserved: 2.79GB

[LAV DEBUG] Processing pair (0,1): N=317, M=314
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.094059
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=317) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 33497.421875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=314) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32866.441406
[LAV DEBUG]   Pair loss = -55.0941 + 0.01 * (33497.4219 + 32866.4414) = 608.5445
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.56GB

[LAV DEBUG] Processing pair (1,0): N=314, M=317
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.094059
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=314) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32866.441406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=317) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 33497.421875
[LAV DEBUG]   Pair loss = -55.0941 + 0.01 * (32866.4414 + 33497.4219) = 608.5445
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.60GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1217.0890
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.60GB | Reserved: 2.77GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.60GB | Reserved: 2.77GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.24GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.24GB | Peak: 20.26GB
[MEM Batch 75 START - Task GreekSalad.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.62GB | Reserved: 5.03GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([850, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([467, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.62GB, Reserved: 5.03GB

[LAV DEBUG] Processing pair (0,1): N=850, M=467
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -107.577553
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=850) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 240830.671875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=467) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 72696.625000
[LAV DEBUG]   Pair loss = -107.5776 + 0.01 * (240830.6719 + 72696.6250) = 3027.6953
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.81GB

[LAV DEBUG] Processing pair (1,0): N=467, M=850
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -107.577553
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=467) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 72696.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=850) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 240830.671875
[LAV DEBUG]   Pair loss = -107.5776 + 0.01 * (72696.6250 + 240830.6719) = 3027.6953
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6055.3906
[LAV DEBUG] Total time: 0.34s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 5.01GB | Reserved: 5.41GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.01GB | Reserved: 5.41GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.97GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.97GB | Peak: 20.26GB
[MEM Batch 76 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 13.38GB | Reserved: 14.40GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2332, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1825, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 13.38GB, Reserved: 14.40GB

[LAV DEBUG] Processing pair (0,1): N=2332, M=1825
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -361.393738
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2332) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1812714.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1825) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1110191.750000
[LAV DEBUG]   Pair loss = -361.3937 + 0.01 * (1812714.6250 + 1110191.7500) = 28867.6699
[LAV DEBUG]   Pair (0,1) completed in 0.34s
[LAV DEBUG]   GPU Memory after pair: 15.44GB

[LAV DEBUG] Processing pair (1,0): N=1825, M=2332
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.03 GiB (GPU 0; 22.16 GiB total capacity; 17.47 GiB already allocated; 1.45 GiB free; 20.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managemen
[MEM Batch 77 START - Task pc_assembly] Allocated: 13.38GB | Reserved: 18.45GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 13.38GB | Reserved: 14.37GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.61GB | Reserved: 18.80GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([656, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([656, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.61GB, Reserved: 18.80GB

[LAV DEBUG] Processing pair (0,1): N=656, M=656
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.079948
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=656) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 143444.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=656) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 143444.875000
[LAV DEBUG]   Pair loss = -115.0799 + 0.01 * (143444.8750 + 143444.8750) = 2753.8176
[LAV DEBUG]   Pair (0,1) completed in 0.54s
[LAV DEBUG]   GPU Memory after pair: 4.82GB

[LAV DEBUG] Processing pair (1,0): N=656, M=656
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -115.079948
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=656) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 143444.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=656) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 143444.875000
[LAV DEBUG]   Pair loss = -115.0799 + 0.01 * (143444.8750 + 143444.8750) = 2753.8176
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.03GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5507.6353
[LAV DEBUG] Total time: 0.79s
[LAV DEBUG] Avg time per pair: 0.40s
============================================================

[MEM After loss computation] Allocated: 5.03GB | Reserved: 7.46GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.03GB | Reserved: 7.46GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.09GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 8.09GB | Peak: 20.26GB
[MEM Batch 78 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.70GB | Reserved: 3.06GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([335, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([359, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.70GB, Reserved: 3.06GB

[LAV DEBUG] Processing pair (0,1): N=335, M=359
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.584145
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=335) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 37409.363281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=359) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 42961.367188
[LAV DEBUG]   Pair loss = -60.5841 + 0.01 * (37409.3633 + 42961.3672) = 743.1232
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.76GB

[LAV DEBUG] Processing pair (1,0): N=359, M=335
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.584145
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=359) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 42961.367188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=335) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 37409.363281
[LAV DEBUG]   Pair loss = -60.5841 + 0.01 * (42961.3672 + 37409.3633) = 743.1232
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.82GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1486.2463
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.82GB | Reserved: 3.01GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.82GB | Reserved: 3.01GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.40GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.40GB | Peak: 20.26GB
[MEM Batch 79 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 9.19GB | Reserved: 9.89GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1070, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1727, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.19GB, Reserved: 9.89GB

[LAV DEBUG] Processing pair (0,1): N=1070, M=1727
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -234.956116
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 381628.968750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1727) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 994161.062500
[LAV DEBUG]   Pair loss = -234.9561 + 0.01 * (381628.9688 + 994161.0625) = 13522.9434
[LAV DEBUG]   Pair (0,1) completed in 0.14s
[LAV DEBUG]   GPU Memory after pair: 10.08GB

[LAV DEBUG] Processing pair (1,0): N=1727, M=1070
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -234.956116
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1727) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 994161.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 381628.968750
[LAV DEBUG]   Pair loss = -234.9561 + 0.01 * (994161.0625 + 381628.9688) = 13522.9434
[LAV DEBUG]   Pair (1,0) completed in 0.15s
[LAV DEBUG]   GPU Memory after pair: 10.98GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 27045.8867
[LAV DEBUG] Total time: 0.52s
[LAV DEBUG] Avg time per pair: 0.26s
============================================================

[MEM After loss computation] Allocated: 10.98GB | Reserved: 12.53GB | Peak: 20.26GB
[MEM Before backward] Allocated: 10.98GB | Reserved: 12.53GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 15.18GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 15.18GB | Peak: 20.26GB
[MEM Batch 80 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.55GB | Reserved: 4.96GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([531, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([762, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.55GB, Reserved: 4.96GB

[LAV DEBUG] Processing pair (0,1): N=531, M=762
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -110.476898
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=531) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93987.320312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=762) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 193546.718750
[LAV DEBUG]   Pair loss = -110.4769 + 0.01 * (93987.3203 + 193546.7188) = 2764.8635
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 4.75GB

[LAV DEBUG] Processing pair (1,0): N=762, M=531
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -110.476898
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=762) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 193546.718750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=531) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93987.320312
[LAV DEBUG]   Pair loss = -110.4769 + 0.01 * (193546.7188 + 93987.3203) = 2764.8635
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5529.7271
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.95GB | Reserved: 5.24GB | Peak: 20.26GB
[MEM Before backward] Allocated: 4.95GB | Reserved: 5.24GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.84GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.84GB | Peak: 20.26GB
[MEM Batch 81 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.09GB | Reserved: 2.33GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([223, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.09GB, Reserved: 2.33GB

[LAV DEBUG] Processing pair (0,1): N=223, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.776356
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=223) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16577.833984
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24662.779297
[LAV DEBUG]   Pair loss = -42.7764 + 0.01 * (16577.8340 + 24662.7793) = 369.6298
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.12GB

[LAV DEBUG] Processing pair (1,0): N=272, M=223
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.776356
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24662.779297
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=223) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16577.833984
[LAV DEBUG]   Pair loss = -42.7764 + 0.01 * (24662.7793 + 16577.8340) = 369.6298
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.15GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 739.2595
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.15GB | Reserved: 2.28GB | Peak: 20.26GB
[MEM Before backward] Allocated: 2.15GB | Reserved: 2.28GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.69GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.69GB | Peak: 20.26GB
[MEM Batch 82 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 1.88GB | Reserved: 2.15GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([238, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.88GB, Reserved: 2.15GB

[LAV DEBUG] Processing pair (0,1): N=238, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.629841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=238) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18882.808594
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.882812
[LAV DEBUG]   Pair loss = -36.6298 + 0.01 * (18882.8086 + 11782.8828) = 270.0271
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.90GB

[LAV DEBUG] Processing pair (1,0): N=188, M=238
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -36.629841
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.882812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=238) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18882.808594
[LAV DEBUG]   Pair loss = -36.6298 + 0.01 * (11782.8828 + 18882.8086) = 270.0271
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.92GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 540.0541
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 20.26GB
[MEM Before backward] Allocated: 1.92GB | Reserved: 2.04GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.35GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.35GB | Peak: 20.26GB
[MEM Batch 83 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 3.37GB | Reserved: 3.71GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([418, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([491, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.37GB, Reserved: 3.71GB

[LAV DEBUG] Processing pair (0,1): N=418, M=491
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.163582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=418) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 58242.207031
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=491) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 80360.875000
[LAV DEBUG]   Pair loss = -79.1636 + 0.01 * (58242.2070 + 80360.8750) = 1306.8672
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.47GB

[LAV DEBUG] Processing pair (1,0): N=491, M=418
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -79.163582
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=491) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 80360.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=418) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 58242.207031
[LAV DEBUG]   Pair loss = -79.1636 + 0.01 * (80360.8750 + 58242.2070) = 1306.8672
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.56GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2613.7344
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.56GB | Reserved: 3.80GB | Peak: 20.26GB
[MEM Before backward] Allocated: 3.56GB | Reserved: 3.80GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.31GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.31GB | Peak: 20.26GB
[MEM Batch 84 START - Task meccano] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 7.69GB | Reserved: 8.29GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([838, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1474, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.69GB, Reserved: 8.29GB

[LAV DEBUG] Processing pair (0,1): N=838, M=1474
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -190.728210
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=838) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234078.953125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1474) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 724215.562500
[LAV DEBUG]   Pair loss = -190.7282 + 0.01 * (234078.9531 + 724215.5625) = 9392.2158
[LAV DEBUG]   Pair (0,1) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 8.29GB

[LAV DEBUG] Processing pair (1,0): N=1474, M=838
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -190.728210
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1474) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 724215.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=838) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234078.953125
[LAV DEBUG]   Pair loss = -190.7282 + 0.01 * (724215.5625 + 234078.9531) = 9392.2158
[LAV DEBUG]   Pair (1,0) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 8.89GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 18784.4316
[LAV DEBUG] Total time: 0.45s
[LAV DEBUG] Avg time per pair: 0.22s
============================================================

[MEM After loss computation] Allocated: 8.89GB | Reserved: 9.47GB | Peak: 20.26GB
[MEM Before backward] Allocated: 8.88GB | Reserved: 9.47GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 11.24GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 11.24GB | Peak: 20.26GB
[MEM Batch 85 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 4.72GB | Reserved: 5.10GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([670, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([680, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.72GB, Reserved: 5.10GB

[LAV DEBUG] Processing pair (0,1): N=670, M=680
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.422493
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=670) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 149632.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=680) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 154132.453125
[LAV DEBUG]   Pair loss = -118.4225 + 0.01 * (149632.5625 + 154132.4531) = 2919.2273
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 4.94GB

[LAV DEBUG] Processing pair (1,0): N=680, M=670
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -118.422493
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=680) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 154132.453125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=670) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 149632.562500
[LAV DEBUG]   Pair loss = -118.4225 + 0.01 * (154132.4531 + 149632.5625) = 2919.2273
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.16GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5838.4546
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.16GB | Reserved: 5.53GB | Peak: 20.26GB
[MEM Before backward] Allocated: 5.16GB | Reserved: 5.53GB | Peak: 20.26GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.19GB | Peak: 20.26GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.19GB | Peak: 20.26GB
[MEM Batch 86 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.69GB | Peak: 20.26GB
[MEM After forward pass] Allocated: 2.71GB | Reserved: 3.06GB | Peak: 20.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([349, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([347, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.71GB, Reserved: 3.06GB

[LAV DEBUG] Processing pair (0,1): N=349, M=347
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.818676
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=349) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 40601.269531
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=347) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 40137.242188
[LAV DEBUG]   Pair loss = -60.8187 + 0.01 * (40601.2695 + 40137.2422) = 746.5665
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 2.77GB

[LAV DEBUG] Processing pair (1,0): N=347, M=349
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -60.818676
[2026-02-01 00:23:06,164 - INFO - alignment_training_loop.py:323] - [BATCH 90] Loss value: 5699.0420
[2026-02-01 00:23:15,486 - INFO - alignment_training_loop.py:269] - [BATCH 91] Task: BaconAndEggs.egtea
[2026-02-01 00:23:16,103 - INFO - alignment_training_loop.py:286] - [BATCH 91] After preprocessing - Num sequences: 2, Lengths: [776, 1835]
[2026-02-01 00:23:29,861 - INFO - alignment_training_loop.py:323] - [BATCH 91] Loss value: 26064.9824
[2026-02-01 00:23:48,815 - INFO - alignment_training_loop.py:269] - [BATCH 92] Task: ContinentalBreakfast.egtea
[2026-02-01 00:23:49,181 - INFO - alignment_training_loop.py:286] - [BATCH 92] After preprocessing - Num sequences: 2, Lengths: [445, 1167]
[2026-02-01 00:23:57,622 - INFO - alignment_training_loop.py:323] - [BATCH 92] Loss value: 10162.9395
[2026-02-01 00:24:09,212 - INFO - alignment_training_loop.py:269] - [BATCH 93] Task: Sandwich.cmu
[2026-02-01 00:24:09,288 - INFO - alignment_training_loop.py:286] - [BATCH 93] After preprocessing - Num sequences: 2, Lengths: [142, 127]
[2026-02-01 00:24:10,912 - INFO - alignment_training_loop.py:323] - [BATCH 93] Loss value: 195.6719
[2026-02-01 00:24:12,833 - INFO - alignment_training_loop.py:269] - [BATCH 94] Task: pc_disassembly
[2026-02-01 00:24:13,001 - INFO - alignment_training_loop.py:286] - [BATCH 94] After preprocessing - Num sequences: 2, Lengths: [361, 324]
[2026-02-01 00:24:16,769 - INFO - alignment_training_loop.py:323] - [BATCH 94] Loss value: 1449.2728
[2026-02-01 00:24:21,677 - INFO - alignment_training_loop.py:358] - Epoch 1 stats - Total: 95, Successful: 90, Skipped (length): 3, Skipped (exception): 2
[2026-02-01 00:24:21,969 - INFO - alignment_training_loop.py:369] - Epoch [1/10], Loss: 6409.1404 (1331.92s)
[2026-02-01 00:24:27,180 - INFO - alignment_training_loop.py:269] - [BATCH 0] Task: PastaSalad.egtea
[2026-02-01 00:24:27,976 - INFO - alignment_training_loop.py:286] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [989, 2492]
[2026-02-01 00:24:45,446 - INFO - alignment_training_loop.py:323] - [BATCH 0] Loss value: 47401.4609
[2026-02-01 00:25:10,688 - INFO - alignment_training_loop.py:269] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 00:25:11,407 - INFO - alignment_training_loop.py:286] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [1497, 1728]
[2026-02-01 00:25:28,389 - INFO - alignment_training_loop.py:323] - [BATCH 1] Loss value: 34281.1172
[2026-02-01 00:25:51,960 - INFO - alignment_training_loop.py:269] - [BATCH 2] Task: tent
[2026-02-01 00:25:52,260 - WARNING - alignment_training_loop.py:280] - Skipping task tent: Sequence length < 2 after preprocessing.
[2026-02-01 00:25:52,327 - INFO - alignment_training_loop.py:269] - [BATCH 3] Task: Cheeseburger.egtea
[2026-02-01 00:25:52,715 - INFO - alignment_training_loop.py:286] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [470, 1138]
[2026-02-01 00:26:01,123 - INFO - alignment_training_loop.py:323] - [BATCH 3] Loss value: 9863.8262
[2026-02-01 00:26:12,651 - INFO - alignment_training_loop.py:269] - [BATCH 4] Task: meccano
[2026-02-01 00:26:13,326 - INFO - alignment_training_loop.py:286] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [1474, 1410]
[2026-02-01 00:26:28,571 - INFO - alignment_training_loop.py:323] - [BATCH 4] Loss value: 27231.1953
[2026-02-01 00:26:49,643 - INFO - alignment_training_loop.py:269] - [BATCH 5] Task: meccano
[2026-02-01 00:26:49,990 - INFO - alignment_training_loop.py:286] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [694, 845]
[2026-02-01 00:26:58,119 - INFO - alignment_training_loop.py:323] - [BATCH 5] Loss value: 7702.9463
[2026-02-01 00:27:09,150 - INFO - alignment_training_loop.py:269] - [BATCH 6] Task: Eggs.cmu
[2026-02-01 00:27:09,268 - INFO - alignment_training_loop.py:286] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [229, 246]
[2026-02-01 00:27:11,923 - INFO - alignment_training_loop.py:323] - [BATCH 6] Loss value: 670.4721
[2026-02-01 00:27:15,323 - INFO - alignment_training_loop.py:269] - [BATCH 7] Task: Eggs.cmu
[2026-02-01 00:27:15,512 - INFO - alignment_training_loop.py:286] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [339, 466]
[2026-02-01 00:27:19,838 - INFO - alignment_training_loop.py:323] - [BATCH 7] Loss value: 2075.8875
[2026-02-01 00:27:25,608 - INFO - alignment_training_loop.py:269] - [BATCH 8] Task: Sandwich.cmu
[2026-02-01 00:27:25,706 - INFO - alignment_training_loop.py:286] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [156, 238]
[2026-02-01 00:27:27,954 - INFO - alignment_training_loop.py:323] - [BATCH 8] Loss value: 473.8988
[2026-02-01 00:27:30,757 - INFO - alignment_training_loop.py:269] - [BATCH 9] Task: Pizza.cmu
[2026-02-01 00:27:30,934 - INFO - alignment_training_loop.py:286] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [298, 458]
[2026-02-01 00:27:35,032 - INFO - alignment_training_loop.py:323] - [BATCH 9] Loss value: 1863.0977
[2026-02-01 00:27:40,412 - INFO - alignment_training_loop.py:269] - [BATCH 10] Task: Sandwich.cmu
[2026-02-01 00:27:40,495 - INFO - alignment_training_loop.py:286] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [188, 127]
[2026-02-01 00:27:42,363 - INFO - alignment_training_loop.py:323] - [BATCH 10] Loss value: 290.3428
[2026-02-01 00:27:44,612 - INFO - alignment_training_loop.py:269] - [BATCH 11] Task: PastaSalad.egtea
[2026-02-01 00:27:45,238 - INFO - alignment_training_loop.py:286] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [1401, 1438]
[2026-02-01 00:28:00,086 - INFO - alignment_training_loop.py:323] - [BATCH 11] Loss value: 26371.3848
[2026-02-01 00:28:20,979 - INFO - alignment_training_loop.py:269] - [BATCH 12] Task: Sandwich.cmu
[2026-02-01 00:28:21,047 - INFO - alignment_training_loop.py:286] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [179, 93]
[2026-02-01 00:28:22,615 - INFO - alignment_training_loop.py:323] - [BATCH 12] Loss value: 228.2376
[2026-02-01 00:28:24,545 - INFO - alignment_training_loop.py:269] - [BATCH 13] Task: Salad.cmu
[2026-02-01 00:28:24,708 - INFO - alignment_training_loop.py:286] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [305, 346]
[2026-02-01 00:28:28,263 - INFO - alignment_training_loop.py:323] - [BATCH 13] Loss value: 1304.9728
[2026-02-01 00:28:32,860 - INFO - alignment_training_loop.py:269] - [BATCH 14] Task: GreekSalad.egtea
[2026-02-01 00:28:33,208 - INFO - alignment_training_loop.py:286] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [808, 658]
[2026-02-01 00:28:40,874 - INFO - alignment_training_loop.py:323] - [BATCH 14] Loss value: 6983.6880
[2026-02-01 00:28:51,319 - INFO - alignment_training_loop.py:269] - [BATCH 15] Task: BaconAndEggs.egtea
[2026-02-01 00:28:51,688 - INFO - alignment_training_loop.py:286] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [776, 826]
[2026-02-01 00:29:00,108 - INFO - alignment_training_loop.py:323] - [BATCH 15] Loss value: 8281.9248
[2026-02-01 00:29:11,595 - INFO - alignment_training_loop.py:269] - [BATCH 16] Task: ContinentalBreakfast.egtea
[2026-02-01 00:29:11,958 - INFO - alignment_training_loop.py:286] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [445, 1167]
[2026-02-01 00:29:20,460 - INFO - alignment_training_loop.py:323] - [BATCH 16] Loss value: 10162.9736
[2026-02-01 00:29:31,986 - INFO - alignment_training_loop.py:269] - [BATCH 17] Task: ContinentalBreakfast.egtea
[2026-02-01 00:29:32,207 - INFO - alignment_training_loop.py:286] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [474, 436]
[2026-02-01 00:29:37,076 - INFO - alignment_training_loop.py:323] - [BATCH 17] Loss value: 2606.0642
[2026-02-01 00:29:43,599 - INFO - alignment_training_loop.py:269] - [BATCH 18] Task: Sandwich.cmu
[2026-02-01 00:29:43,693 - INFO - alignment_training_loop.py:286] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [184, 175]
[2026-02-01 00:29:45,780 - INFO - alignment_training_loop.py:323] - [BATCH 18] Loss value: 367.6676
[2026-02-01 00:29:48,318 - INFO - alignment_training_loop.py:269] - [BATCH 19] Task: TurkeySandwich.egtea
[2026-02-01 00:29:48,654 - INFO - alignment_training_loop.py:286] - [BATCH 19] After preprocessing - Num sequences: 2, Lengths: [383, 1109]
[2026-02-01 00:29:56,483 - INFO - alignment_training_loop.py:323] - [BATCH 19] Loss value: 8966.3252
