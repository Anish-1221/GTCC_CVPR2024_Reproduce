[2026-02-01 14:04:05,401 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-02-01 14:04:05,401 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,434 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-02-01 14:04:05,434 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,465 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-02-01 14:04:05,465 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,488 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-02-01 14:04:05,488 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,505 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-02-01 14:04:05,506 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,526 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-02-01 14:04:05,526 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,540 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-02-01 14:04:05,540 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,580 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-02-01 14:04:05,580 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,592 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-02-01 14:04:05,593 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,630 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-02-01 14:04:05,630 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,644 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-02-01 14:04:05,644 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,659 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-02-01 14:04:05,660 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,676 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-02-01 14:04:05,676 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,715 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-02-01 14:04:05,715 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,723 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-02-01 14:04:05,723 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:05,757 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-02-01 14:04:05,757 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-02-01 14:04:07,127 - INFO - alignment_training_loop.py:236] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-02-01 14:04:09,015 - INFO - alignment_training_loop.py:302] - [BATCH 0] Task: Salad.cmu
[2026-02-01 14:04:09,428 - INFO - alignment_training_loop.py:319] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [408, 529]
[2026-02-01 14:04:16,125 - INFO - alignment_training_loop.py:376] - [BATCH 0] Loss value: 2812.9180
[2026-02-01 14:04:23,474 - INFO - alignment_training_loop.py:302] - [BATCH 1] Task: PastaSalad.egtea
[2026-02-01 14:04:25,058 - INFO - alignment_training_loop.py:319] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [2196, 1401]
[2026-02-01 14:04:41,826 - INFO - alignment_training_loop.py:376] - [BATCH 1] Loss value: 44619.5117
[2026-02-01 14:05:06,708 - INFO - alignment_training_loop.py:302] - [BATCH 2] Task: Sandwich.cmu
[2026-02-01 14:05:06,769 - INFO - alignment_training_loop.py:319] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [93, 175]
CUDA_VISIBLE_DEVICES: not set
Available GPUs: 8
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 3.08GB | Reserved: 3.41GB | Peak: 3.11GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([408, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.08GB, Reserved: 3.41GB

[LAV DEBUG] Processing pair (0,1): N=408, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.937195
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=408) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 55477.675781
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93261.945312
[LAV DEBUG]   Pair loss = -80.9372 + 0.01 * (55477.6758 + 93261.9453) = 1406.4590
[LAV DEBUG]   Pair (0,1) completed in 1.22s
[LAV DEBUG]   GPU Memory after pair: 3.19GB

[LAV DEBUG] Processing pair (1,0): N=529, M=408
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -80.937195
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93261.945312
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=408) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 55477.675781
[LAV DEBUG]   Pair loss = -80.9372 + 0.01 * (93261.9453 + 55477.6758) = 1406.4590
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.29GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2812.9180
[LAV DEBUG] Total time: 1.50s
[LAV DEBUG] Avg time per pair: 0.75s
============================================================

[MEM After loss computation] Allocated: 3.29GB | Reserved: 3.51GB | Peak: 3.39GB
[MEM Before backward] Allocated: 3.29GB | Reserved: 3.51GB | Peak: 3.39GB
[MEM After backward] Allocated: 0.38GB | Reserved: 4.03GB | Peak: 3.60GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.03GB | Peak: 3.60GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 3.60GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 3.60GB
[MEM After forward pass] Allocated: 11.66GB | Reserved: 12.54GB | Peak: 11.72GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1401, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 11.66GB, Reserved: 12.54GB

[LAV DEBUG] Processing pair (0,1): N=2196, M=1401
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -303.941772
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1607209.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 654160.625000
[LAV DEBUG]   Pair loss = -303.9418 + 0.01 * (1607209.1250 + 654160.6250) = 22309.7559
[LAV DEBUG]   Pair (0,1) completed in 0.27s
[LAV DEBUG]   GPU Memory after pair: 13.15GB

[LAV DEBUG] Processing pair (1,0): N=1401, M=2196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -303.941772
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1401) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 654160.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1607209.125000
[LAV DEBUG]   Pair loss = -303.9418 + 0.01 * (654160.6250 + 1607209.1250) = 22309.7559
[LAV DEBUG]   Pair (1,0) completed in 0.25s
[LAV DEBUG]   GPU Memory after pair: 14.64GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 44619.5117
[LAV DEBUG] Total time: 0.84s
[LAV DEBUG] Avg time per pair: 0.42s
============================================================

[MEM After loss computation] Allocated: 14.64GB | Reserved: 16.93GB | Peak: 16.09GB
[MEM Before backward] Allocated: 14.64GB | Reserved: 16.93GB | Peak: 16.09GB
[MEM After backward] Allocated: 0.74GB | Reserved: 21.34GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 21.34GB | Peak: 19.03GB
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 1.39GB | Reserved: 1.58GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([93, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([175, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.39GB, Reserved: 1.58GB

[LAV DEBUG] Processing pair (0,1): N=93, M=175
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -21.346228
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=93) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2884.260742
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=175) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10208.598633
[LAV DEBUG]   Pair loss = -21.3462 + 0.01 * (2884.2607 + 10208.5986) = 109.5824
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.40GB

[LAV DEBUG] Processing pair (1,0): N=175, M=93
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -21.346228
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=175) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10208.598633
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=93) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2884.260742
[LAV DEBUG]   Pair loss = -21.3462 + 0.01 * (10208.5986 + 2884.2607) = 109.5824
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.40GB

[LAV DEBUG] === LAV_loss complete ===
[2026-02-01 14:05:08,350 - INFO - alignment_training_loop.py:376] - [BATCH 2] Loss value: 219.1647
[2026-02-01 14:05:10,175 - INFO - alignment_training_loop.py:302] - [BATCH 3] Task: Sandwich.cmu
[2026-02-01 14:05:10,269 - INFO - alignment_training_loop.py:319] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [199, 179]
[2026-02-01 14:05:12,225 - INFO - alignment_training_loop.py:376] - [BATCH 3] Loss value: 412.1257
[2026-02-01 14:05:14,783 - INFO - alignment_training_loop.py:302] - [BATCH 4] Task: Sandwich.cmu
[2026-02-01 14:05:14,868 - INFO - alignment_training_loop.py:319] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [142, 214]
[2026-02-01 14:05:16,740 - INFO - alignment_training_loop.py:376] - [BATCH 4] Loss value: 380.0495
[2026-02-01 14:05:19,153 - INFO - alignment_training_loop.py:302] - [BATCH 5] Task: Pizza.cmu
[2026-02-01 14:05:19,396 - INFO - alignment_training_loop.py:319] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [126, 507]
[2026-02-01 14:05:22,525 - INFO - alignment_training_loop.py:376] - [BATCH 5] Loss value: 1742.5918
[2026-02-01 14:05:26,788 - INFO - alignment_training_loop.py:302] - [BATCH 6] Task: PastaSalad.egtea
[2026-02-01 14:05:27,860 - INFO - alignment_training_loop.py:319] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [1497, 906]
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 219.1647
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 1.40GB | Reserved: 1.47GB | Peak: 19.03GB
[MEM Before backward] Allocated: 1.40GB | Reserved: 1.47GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.83GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.83GB | Peak: 19.03GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 1.73GB | Reserved: 1.92GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([199, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([179, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.73GB, Reserved: 1.92GB

[LAV DEBUG] Processing pair (0,1): N=199, M=179
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.746902
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=199) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13200.333008
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=179) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 10680.642578
[LAV DEBUG]   Pair loss = -32.7469 + 0.01 * (13200.3330 + 10680.6426) = 206.0629
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.75GB

[LAV DEBUG] Processing pair (1,0): N=179, M=199
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -32.746902
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=179) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 10680.642578
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=199) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13200.333008
[LAV DEBUG]   Pair loss = -32.7469 + 0.01 * (10680.6426 + 13200.3330) = 206.0629
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.76GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 412.1257
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 1.76GB | Reserved: 1.84GB | Peak: 19.03GB
[MEM Before backward] Allocated: 1.76GB | Reserved: 1.84GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.22GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.22GB | Peak: 19.03GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 1.66GB | Reserved: 1.86GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([142, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([214, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.66GB, Reserved: 1.86GB

[LAV DEBUG] Processing pair (0,1): N=142, M=214
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.848776
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=142) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6722.191406
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=214) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15265.161133
[LAV DEBUG]   Pair loss = -29.8488 + 0.01 * (6722.1914 + 15265.1611) = 190.0247
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.67GB

[LAV DEBUG] Processing pair (1,0): N=214, M=142
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.848776
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=214) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15265.161133
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=142) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6722.191406
[LAV DEBUG]   Pair loss = -29.8488 + 0.01 * (15265.1611 + 6722.1914) = 190.0247
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.69GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 380.0495
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 1.69GB | Reserved: 1.77GB | Peak: 19.03GB
[MEM Before backward] Allocated: 1.69GB | Reserved: 1.77GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.14GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.14GB | Peak: 19.03GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 2.51GB | Reserved: 2.80GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([126, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([507, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.51GB, Reserved: 2.80GB

[LAV DEBUG] Processing pair (0,1): N=126, M=507
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.382950
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=126) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5293.043945
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=507) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85674.835938
[LAV DEBUG]   Pair loss = -38.3829 + 0.01 * (5293.0439 + 85674.8359) = 871.2959
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.54GB

[LAV DEBUG] Processing pair (1,0): N=507, M=126
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -38.382950
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=507) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85674.835938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=126) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5293.043945
[LAV DEBUG]   Pair loss = -38.3829 + 0.01 * (85674.8359 + 5293.0439) = 871.2959
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1742.5918
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.58GB | Reserved: 2.72GB | Peak: 19.03GB
[MEM Before backward] Allocated: 2.58GB | Reserved: 2.72GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.14GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.14GB | Peak: 19.03GB
[MEM Batch 6 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 7.97GB | Reserved: 8.58GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1497, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([906, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.97GB, Reserved: 8.58GB
[2026-02-01 14:05:39,442 - INFO - alignment_training_loop.py:376] - [BATCH 6] Loss value: 20008.3848
[2026-02-01 14:05:55,788 - INFO - alignment_training_loop.py:302] - [BATCH 7] Task: Brownie.cmu
[2026-02-01 14:05:56,126 - INFO - alignment_training_loop.py:319] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [416, 523]
[2026-02-01 14:06:00,967 - INFO - alignment_training_loop.py:376] - [BATCH 7] Loss value: 2814.2776
[2026-02-01 14:06:07,341 - INFO - alignment_training_loop.py:302] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-02-01 14:06:08,764 - INFO - alignment_training_loop.py:319] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [1835, 1070]
[2026-02-01 14:06:23,275 - INFO - alignment_training_loop.py:376] - [BATCH 8] Loss value: 29595.6562
[2026-02-01 14:06:43,251 - INFO - alignment_training_loop.py:302] - [BATCH 9] Task: Salad.cmu
[2026-02-01 14:06:43,406 - INFO - alignment_training_loop.py:319] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [173, 423]

[LAV DEBUG] Processing pair (0,1): N=1497, M=906
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -200.869705
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 746922.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=906) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 273583.593750
[LAV DEBUG]   Pair loss = -200.8697 + 0.01 * (746922.6875 + 273583.5938) = 10004.1924
[LAV DEBUG]   Pair (0,1) completed in 0.12s
[LAV DEBUG]   GPU Memory after pair: 8.62GB

[LAV DEBUG] Processing pair (1,0): N=906, M=1497
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -200.869705
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=906) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 273583.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1497) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 746922.687500
[LAV DEBUG]   Pair loss = -200.8697 + 0.01 * (273583.5938 + 746922.6875) = 10004.1924
[LAV DEBUG]   Pair (1,0) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 9.28GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 20008.3848
[LAV DEBUG] Total time: 0.54s
[LAV DEBUG] Avg time per pair: 0.27s
============================================================

[MEM After loss computation] Allocated: 9.28GB | Reserved: 9.88GB | Peak: 19.03GB
[MEM Before backward] Allocated: 9.28GB | Reserved: 9.88GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 11.84GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 11.84GB | Peak: 19.03GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 3.46GB | Reserved: 3.76GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([416, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.46GB, Reserved: 3.76GB

[LAV DEBUG] Processing pair (0,1): N=416, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.357109
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=416) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 57681.125000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91168.476562
[LAV DEBUG]   Pair loss = -81.3571 + 0.01 * (57681.1250 + 91168.4766) = 1407.1388
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.56GB

[LAV DEBUG] Processing pair (1,0): N=523, M=416
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -81.357109
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91168.476562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=416) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 57681.125000
[LAV DEBUG]   Pair loss = -81.3571 + 0.01 * (91168.4766 + 57681.1250) = 1407.1388
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2814.2776
[LAV DEBUG] Total time: 0.35s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 3.67GB | Reserved: 3.97GB | Peak: 19.03GB
[MEM Before backward] Allocated: 3.67GB | Reserved: 3.97GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.29GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.29GB | Peak: 19.03GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 9.52GB | Reserved: 10.26GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1835, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1070, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 9.52GB, Reserved: 10.26GB

[LAV DEBUG] Processing pair (0,1): N=1835, M=1070
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -241.104904
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1835) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 1122295.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 381597.375000
[LAV DEBUG]   Pair loss = -241.1049 + 0.01 * (1122295.8750 + 381597.3750) = 14797.8281
[LAV DEBUG]   Pair (0,1) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 10.47GB

[LAV DEBUG] Processing pair (1,0): N=1070, M=1835
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -241.104904
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1070) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 381597.375000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1835) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1122295.875000
[LAV DEBUG]   Pair loss = -241.1049 + 0.01 * (381597.3750 + 1122295.8750) = 14797.8281
[LAV DEBUG]   Pair (1,0) completed in 0.17s
[LAV DEBUG]   GPU Memory after pair: 11.42GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 29595.6562
[LAV DEBUG] Total time: 0.77s
[LAV DEBUG] Avg time per pair: 0.38s
============================================================

[MEM After loss computation] Allocated: 11.42GB | Reserved: 12.13GB | Peak: 19.03GB
[MEM Before backward] Allocated: 11.42GB | Reserved: 12.13GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 14.97GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 14.97GB | Peak: 19.03GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 2.40GB | Reserved: 2.69GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([173, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([423, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.40GB, Reserved: 2.69GB

[LAV DEBUG] Processing pair (0,1): N=173, M=423
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.457714
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=173) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9976.990234
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=423) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59638.855469
[LAV DEBUG]   Pair loss = -44.4577 + 0.01 * (9976.9902 + 59638.8555) = 651.7007
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.44GB

[LAV DEBUG] Processing pair (1,0): N=423, M=173
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.457714
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=423) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59638.855469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=173) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9976.990234
[LAV DEBUG]   Pair loss = -44.4577 + 0.01 * (59638.8555 + 9976.9902) = 651.7007
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.47GB

[LAV DEBUG] === LAV_loss complete ===
[2026-02-01 14:06:46,744 - INFO - alignment_training_loop.py:376] - [BATCH 9] Loss value: 1303.4015
[2026-02-01 14:06:50,784 - INFO - alignment_training_loop.py:302] - [BATCH 10] Task: Cheeseburger.egtea
[2026-02-01 14:06:51,080 - INFO - alignment_training_loop.py:319] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [680, 470]
[2026-02-01 14:06:56,831 - INFO - alignment_training_loop.py:376] - [BATCH 10] Loss value: 4358.7998
[2026-02-01 14:07:04,648 - INFO - alignment_training_loop.py:302] - [BATCH 11] Task: Pizza.cmu
[2026-02-01 14:07:04,916 - INFO - alignment_training_loop.py:319] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [839, 236]
[2026-02-01 14:07:10,388 - INFO - alignment_training_loop.py:376] - [BATCH 11] Loss value: 4924.7993
[2026-02-01 14:07:17,854 - INFO - alignment_training_loop.py:302] - [BATCH 12] Task: Salad.cmu
[2026-02-01 14:07:18,021 - INFO - alignment_training_loop.py:319] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [273, 430]
[2026-02-01 14:07:21,748 - INFO - alignment_training_loop.py:376] - [BATCH 12] Loss value: 1611.5690
[2026-02-01 14:07:26,718 - INFO - alignment_training_loop.py:302] - [BATCH 13] Task: Pizza.cmu
[2026-02-01 14:07:26,947 - INFO - alignment_training_loop.py:319] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [346, 596]
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1303.4015
[LAV DEBUG] Total time: 0.44s
[LAV DEBUG] Avg time per pair: 0.22s
============================================================

[MEM After loss computation] Allocated: 2.47GB | Reserved: 2.61GB | Peak: 19.03GB
[MEM Before backward] Allocated: 2.47GB | Reserved: 2.61GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.99GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.99GB | Peak: 19.03GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 4.11GB | Reserved: 4.50GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([680, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([470, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.11GB, Reserved: 4.50GB

[LAV DEBUG] Processing pair (0,1): N=680, M=470
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.085770
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=680) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 154120.500000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=470) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 73628.062500
[LAV DEBUG]   Pair loss = -98.0858 + 0.01 * (154120.5000 + 73628.0625) = 2179.3999
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.26GB

[LAV DEBUG] Processing pair (1,0): N=470, M=680
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -98.085770
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=470) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 73628.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=680) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 154120.500000
[LAV DEBUG]   Pair loss = -98.0858 + 0.01 * (73628.0625 + 154120.5000) = 2179.3999
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.42GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4358.7998
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.42GB | Reserved: 4.70GB | Peak: 19.03GB
[MEM Before backward] Allocated: 4.42GB | Reserved: 4.70GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.17GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.17GB | Peak: 19.03GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 3.87GB | Reserved: 4.19GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([839, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([236, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.87GB, Reserved: 4.19GB

[LAV DEBUG] Processing pair (0,1): N=839, M=236
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.466980
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=839) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 234621.390625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=236) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18565.294922
[LAV DEBUG]   Pair loss = -69.4670 + 0.01 * (234621.3906 + 18565.2949) = 2462.3997
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.97GB

[LAV DEBUG] Processing pair (1,0): N=236, M=839
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -69.466980
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=236) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18565.294922
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=839) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 234621.390625
[LAV DEBUG]   Pair loss = -69.4670 + 0.01 * (18565.2949 + 234621.3906) = 2462.3997
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 4.07GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4924.7993
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.07GB | Reserved: 4.39GB | Peak: 19.03GB
[MEM Before backward] Allocated: 4.07GB | Reserved: 4.39GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.89GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.89GB | Peak: 19.03GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 2.73GB | Reserved: 3.07GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([273, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([430, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.73GB, Reserved: 3.07GB

[LAV DEBUG] Processing pair (0,1): N=273, M=430
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -58.940769
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=273) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24842.613281
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=430) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61629.917969
[LAV DEBUG]   Pair loss = -58.9408 + 0.01 * (24842.6133 + 61629.9180) = 805.7845
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.79GB

[LAV DEBUG] Processing pair (1,0): N=430, M=273
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -58.940769
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=430) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61629.917969
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=273) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24842.613281
[LAV DEBUG]   Pair loss = -58.9408 + 0.01 * (61629.9180 + 24842.6133) = 805.7845
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.84GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1611.5690
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.84GB | Reserved: 3.02GB | Peak: 19.03GB
[MEM Before backward] Allocated: 2.84GB | Reserved: 3.02GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.40GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.40GB | Peak: 19.03GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 3.47GB | Reserved: 3.76GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([596, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.47GB, Reserved: 3.76GB
[2026-02-01 14:07:31,931 - INFO - alignment_training_loop.py:376] - [BATCH 13] Loss value: 3010.5125
[2026-02-01 14:07:38,661 - INFO - alignment_training_loop.py:302] - [BATCH 14] Task: pc_assembly
[2026-02-01 14:07:38,944 - INFO - alignment_training_loop.py:319] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [581, 574]
[2026-02-01 14:07:45,093 - INFO - alignment_training_loop.py:376] - [BATCH 14] Loss value: 4244.1519
[2026-02-01 14:07:53,413 - INFO - alignment_training_loop.py:302] - [BATCH 15] Task: Pizza.cmu
[2026-02-01 14:07:53,699 - INFO - alignment_training_loop.py:319] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [780, 421]
[2026-02-01 14:08:00,182 - INFO - alignment_training_loop.py:376] - [BATCH 15] Loss value: 5042.0098
[2026-02-01 14:08:08,842 - INFO - alignment_training_loop.py:302] - [BATCH 16] Task: Eggs.cmu
[2026-02-01 14:08:08,972 - INFO - alignment_training_loop.py:319] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [264, 325]

[LAV DEBUG] Processing pair (0,1): N=346, M=596
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -77.758469
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39903.835938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=596) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 118397.640625
[LAV DEBUG]   Pair loss = -77.7585 + 0.01 * (39903.8359 + 118397.6406) = 1505.2562
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.57GB

[LAV DEBUG] Processing pair (1,0): N=596, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -77.758469
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=596) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 118397.640625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39903.835938
[LAV DEBUG]   Pair loss = -77.7585 + 0.01 * (118397.6406 + 39903.8359) = 1505.2562
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3010.5125
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.67GB | Reserved: 3.96GB | Peak: 19.03GB
[MEM Before backward] Allocated: 3.66GB | Reserved: 3.96GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.48GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.48GB | Peak: 19.03GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 4.12GB | Reserved: 4.50GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([581, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([574, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.12GB, Reserved: 4.50GB

[LAV DEBUG] Processing pair (0,1): N=581, M=574
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -101.245758
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=581) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 112513.468750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=574) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 109818.718750
[LAV DEBUG]   Pair loss = -101.2458 + 0.01 * (112513.4688 + 109818.7188) = 2122.0759
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.29GB

[LAV DEBUG] Processing pair (1,0): N=574, M=581
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -101.245758
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=574) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 109818.718750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=581) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 112513.468750
[LAV DEBUG]   Pair loss = -101.2458 + 0.01 * (109818.7188 + 112513.4688) = 2122.0759
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.45GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4244.1519
[LAV DEBUG] Total time: 0.35s
[LAV DEBUG] Avg time per pair: 0.18s
============================================================

[MEM After loss computation] Allocated: 4.45GB | Reserved: 4.71GB | Peak: 19.03GB
[MEM Before backward] Allocated: 4.45GB | Reserved: 4.71GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.20GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.20GB | Peak: 19.03GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 4.26GB | Reserved: 4.63GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([780, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([421, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.26GB, Reserved: 4.63GB

[LAV DEBUG] Processing pair (0,1): N=780, M=421
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.644287
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=780) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 202787.234375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=421) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 59077.687500
[LAV DEBUG]   Pair loss = -97.6443 + 0.01 * (202787.2344 + 59077.6875) = 2521.0049
[LAV DEBUG]   Pair (0,1) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.42GB

[LAV DEBUG] Processing pair (1,0): N=421, M=780
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.644287
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=421) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 59077.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=780) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 202787.234375
[LAV DEBUG]   Pair loss = -97.6443 + 0.01 * (59077.6875 + 202787.2344) = 2521.0049
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 4.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5042.0098
[LAV DEBUG] Total time: 0.35s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 4.58GB | Reserved: 4.94GB | Peak: 19.03GB
[MEM Before backward] Allocated: 4.58GB | Reserved: 4.94GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.42GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.42GB | Peak: 19.03GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 2.38GB | Reserved: 2.68GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([264, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([325, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.38GB, Reserved: 2.68GB

[LAV DEBUG] Processing pair (0,1): N=264, M=325
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.948605
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=264) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 23231.966797
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=325) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 35207.527344
[LAV DEBUG]   Pair loss = -50.9486 + 0.01 * (23231.9668 + 35207.5273) = 533.4463
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.42GB

[LAV DEBUG] Processing pair (1,0): N=325, M=264
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.948605
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=325) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 35207.527344
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=264) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 23231.966797
[LAV DEBUG]   Pair loss = -50.9486 + 0.01 * (35207.5273 + 23231.9668) = 533.4463
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.46GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[2026-02-01 14:08:12,240 - INFO - alignment_training_loop.py:376] - [BATCH 16] Loss value: 1066.8926
[2026-02-01 14:08:16,487 - INFO - alignment_training_loop.py:302] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-02-01 14:08:16,832 - INFO - alignment_training_loop.py:319] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [502, 875]
[2026-02-01 14:08:24,187 - INFO - alignment_training_loop.py:376] - [BATCH 17] Loss value: 6556.4033
[2026-02-01 14:08:34,167 - INFO - alignment_training_loop.py:302] - [BATCH 18] Task: Brownie.cmu
[2026-02-01 14:08:34,389 - INFO - alignment_training_loop.py:319] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [494, 406]
[2026-02-01 14:08:39,362 - INFO - alignment_training_loop.py:376] - [BATCH 18] Loss value: 2569.2698
[2026-02-01 14:08:45,890 - INFO - alignment_training_loop.py:302] - [BATCH 19] Task: tent
[2026-02-01 14:08:46,269 - INFO - alignment_training_loop.py:302] - [BATCH 20] Task: Sandwich.cmu
[2026-02-01 14:08:46,335 - INFO - alignment_training_loop.py:319] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [213, 141]
[2026-02-01 14:08:48,332 - INFO - alignment_training_loop.py:376] - [BATCH 20] Loss value: 375.7000
[2026-02-01 14:08:50,901 - INFO - alignment_training_loop.py:302] - [BATCH 21] Task: Pizza.cmu
[2026-02-01 14:08:51,281 - INFO - alignment_training_loop.py:319] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [756, 762]
[LAV DEBUG] Final loss: 1066.8926
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 2.46GB | Reserved: 2.61GB | Peak: 19.03GB
[MEM Before backward] Allocated: 2.46GB | Reserved: 2.61GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.00GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.00GB | Peak: 19.03GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 4.81GB | Reserved: 5.18GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([502, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.81GB, Reserved: 5.18GB

[LAV DEBUG] Processing pair (0,1): N=502, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -113.608932
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=502) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 83997.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255183.968750
[LAV DEBUG]   Pair loss = -113.6089 + 0.01 * (83997.0781 + 255183.9688) = 3278.2017
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.02GB

[LAV DEBUG] Processing pair (1,0): N=875, M=502
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -113.608932
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255183.968750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=502) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 83997.078125
[LAV DEBUG]   Pair loss = -113.6089 + 0.01 * (255183.9688 + 83997.0781) = 3278.2017
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.23GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 6556.4033
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.23GB | Reserved: 5.60GB | Peak: 19.03GB
[MEM Before backward] Allocated: 5.23GB | Reserved: 5.60GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.23GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.23GB | Peak: 19.03GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 3.33GB | Reserved: 3.68GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([494, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([406, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 3.33GB, Reserved: 3.68GB

[LAV DEBUG] Processing pair (0,1): N=494, M=406
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.176369
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=494) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 81338.039062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=406) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54943.085938
[LAV DEBUG]   Pair loss = -78.1764 + 0.01 * (81338.0391 + 54943.0859) = 1284.6349
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.43GB

[LAV DEBUG] Processing pair (1,0): N=406, M=494
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -78.176369
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=406) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54943.085938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=494) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 81338.039062
[LAV DEBUG]   Pair loss = -78.1764 + 0.01 * (54943.0859 + 81338.0391) = 1284.6349
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 3.53GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2569.2698
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.17s
============================================================

[MEM After loss computation] Allocated: 3.53GB | Reserved: 3.77GB | Peak: 19.03GB
[MEM Before backward] Allocated: 3.53GB | Reserved: 3.77GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.27GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 4.27GB | Peak: 19.03GB
[MEM Batch 19 START - Task tent] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 1.65GB | Reserved: 1.86GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([213, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([141, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.65GB, Reserved: 1.86GB

[LAV DEBUG] Processing pair (0,1): N=213, M=141
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.666862
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=213) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 15123.520508
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=141) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 6628.165527
[LAV DEBUG]   Pair loss = -29.6669 + 0.01 * (15123.5205 + 6628.1655) = 187.8500
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.67GB

[LAV DEBUG] Processing pair (1,0): N=141, M=213
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -29.666862
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=141) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 6628.165527
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=213) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 15123.520508
[LAV DEBUG]   Pair loss = -29.6669 + 0.01 * (6628.1655 + 15123.5205) = 187.8500
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.68GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 375.7000
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.68GB | Reserved: 1.77GB | Peak: 19.03GB
[MEM Before backward] Allocated: 1.68GB | Reserved: 1.77GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.13GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.13GB | Peak: 19.03GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 5.24GB | Reserved: 5.62GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([756, 128]), dtype=torch.float32, device=cuda:0
[2026-02-01 14:08:59,401 - INFO - alignment_training_loop.py:376] - [BATCH 21] Loss value: 7414.2700
[2026-02-01 14:09:10,530 - INFO - alignment_training_loop.py:302] - [BATCH 22] Task: Salad.cmu
[2026-02-01 14:09:10,691 - INFO - alignment_training_loop.py:319] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [390, 329]
[2026-02-01 14:09:14,732 - INFO - alignment_training_loop.py:376] - [BATCH 22] Loss value: 1610.6000
[2026-02-01 14:09:19,961 - INFO - alignment_training_loop.py:302] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-02-01 14:09:20,321 - INFO - alignment_training_loop.py:319] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [429, 1109]
[2026-02-01 14:09:28,543 - INFO - alignment_training_loop.py:376] - [BATCH 23] Loss value: 9198.9590
[2026-02-01 14:09:39,864 - INFO - alignment_training_loop.py:302] - [BATCH 24] Task: PastaSalad.egtea
[2026-02-01 14:09:40,220 - INFO - alignment_training_loop.py:319] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [543, 989]
[LAV DEBUG]   Seq 1: shape=torch.Size([762, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.24GB, Reserved: 5.62GB

[LAV DEBUG] Processing pair (0,1): N=756, M=762
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -133.227264
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=756) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 190500.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=762) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 193536.046875
[LAV DEBUG]   Pair loss = -133.2273 + 0.01 * (190500.2031 + 193536.0469) = 3707.1350
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.52GB

[LAV DEBUG] Processing pair (1,0): N=762, M=756
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -133.227264
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=762) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 193536.046875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=756) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 190500.203125
[LAV DEBUG]   Pair loss = -133.2273 + 0.01 * (193536.0469 + 190500.2031) = 3707.1350
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.80GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 7414.2700
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.80GB | Reserved: 6.17GB | Peak: 19.03GB
[MEM Before backward] Allocated: 5.80GB | Reserved: 6.17GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.00GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 7.00GB | Peak: 19.03GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 2.78GB | Reserved: 3.12GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([390, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([329, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.78GB, Reserved: 3.12GB

[LAV DEBUG] Processing pair (0,1): N=390, M=329
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -62.477757
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=390) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 50698.261719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=329) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 36079.523438
[LAV DEBUG]   Pair loss = -62.4778 + 0.01 * (50698.2617 + 36079.5234) = 805.3000
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.84GB

[LAV DEBUG] Processing pair (1,0): N=329, M=390
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -62.477757
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=329) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 36079.523438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=390) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 50698.261719
[LAV DEBUG]   Pair loss = -62.4778 + 0.01 * (36079.5234 + 50698.2617) = 805.3000
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.90GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1610.6000
[LAV DEBUG] Total time: 0.31s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 2.90GB | Reserved: 3.07GB | Peak: 19.03GB
[MEM Before backward] Allocated: 2.90GB | Reserved: 3.07GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.47GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.47GB | Peak: 19.03GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 5.30GB | Reserved: 5.79GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([429, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1109, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.30GB, Reserved: 5.79GB

[LAV DEBUG] Processing pair (0,1): N=429, M=1109
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -113.315163
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=429) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 61344.890625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 409934.562500
[LAV DEBUG]   Pair loss = -113.3152 + 0.01 * (61344.8906 + 409934.5625) = 4599.4795
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.53GB

[LAV DEBUG] Processing pair (1,0): N=1109, M=429
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -113.315163
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1109) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 409934.562500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=429) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 61344.890625
[LAV DEBUG]   Pair loss = -113.3152 + 0.01 * (409934.5625 + 61344.8906) = 4599.4795
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.76GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 9198.9590
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.76GB | Reserved: 6.14GB | Peak: 19.03GB
[MEM Before backward] Allocated: 5.76GB | Reserved: 6.14GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.82GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.82GB | Peak: 19.03GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 5.29GB | Reserved: 5.78GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([543, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([989, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.29GB, Reserved: 5.78GB

[LAV DEBUG] Processing pair (0,1): N=543, M=989
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -125.204292
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=543) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 98279.000000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=989) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 326023.312500
[LAV DEBUG]   Pair loss = -125.2043 + 0.01 * (98279.0000 + 326023.3125) = 4117.8188
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.55GB

[LAV DEBUG] Processing pair (1,0): N=989, M=543
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -125.204292
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=989) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 326023.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=543) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 98279.000000
[2026-02-01 14:09:48,518 - INFO - alignment_training_loop.py:376] - [BATCH 24] Loss value: 8235.6377
[2026-02-01 14:09:59,680 - INFO - alignment_training_loop.py:302] - [BATCH 25] Task: PastaSalad.egtea
[2026-02-01 14:10:00,604 - INFO - alignment_training_loop.py:319] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [1438, 2489]
[2026-02-01 14:10:22,020 - INFO - alignment_training_loop.py:376] - [BATCH 25] Loss value: 54432.4023
[2026-02-01 14:10:22,511 - ERROR - alignment_training_loop.py:387] - [OOM in BACKWARD] Task: PastaSalad.egtea, Loss value: 54432.4023
[2026-02-01 14:10:22,868 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.10GB
[2026-02-01 14:10:22,869 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.10GB at batch start, forcing cleanup
[2026-02-01 14:10:23,208 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.10GB
[2026-02-01 14:10:23,208 - INFO - alignment_training_loop.py:302] - [BATCH 26] Task: tent
[2026-02-01 14:10:23,565 - INFO - alignment_training_loop.py:319] - [BATCH 26] After preprocessing - Num sequences: 2, Lengths: [721, 768]
[2026-02-01 14:10:31,056 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: tent, Lengths: [721, 768]
[2026-02-01 14:10:31,638 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.68GB
[2026-02-01 14:10:31,803 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.10GB at batch start, forcing cleanup
[2026-02-01 14:10:32,324 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.10GB
[2026-02-01 14:10:32,324 - INFO - alignment_training_loop.py:302] - [BATCH 27] Task: Pizza.cmu
[2026-02-01 14:10:32,515 - INFO - alignment_training_loop.py:319] - [BATCH 27] After preprocessing - Num sequences: 2, Lengths: [439, 351]
[2026-02-01 14:10:39,533 - INFO - alignment_training_loop.py:376] - [BATCH 27] Loss value: 1969.2920
[2026-02-01 14:10:45,885 - INFO - alignment_training_loop.py:302] - [BATCH 28] Task: Sandwich.cmu
[2026-02-01 14:10:45,970 - INFO - alignment_training_loop.py:319] - [BATCH 28] After preprocessing - Num sequences: 2, Lengths: [133, 156]
[2026-02-01 14:10:48,660 - INFO - alignment_training_loop.py:376] - [BATCH 28] Loss value: 230.4946
[2026-02-01 14:10:50,757 - INFO - alignment_training_loop.py:302] - [BATCH 29] Task: Pizza.egtea
[2026-02-01 14:10:51,064 - INFO - alignment_training_loop.py:319] - [BATCH 29] After preprocessing - Num sequences: 2, Lengths: [632, 693]
[LAV DEBUG]   Pair loss = -125.2043 + 0.01 * (326023.3125 + 98279.0000) = 4117.8188
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 5.81GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 8235.6377
[LAV DEBUG] Total time: 0.37s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 5.81GB | Reserved: 6.18GB | Peak: 19.03GB
[MEM Before backward] Allocated: 5.81GB | Reserved: 6.18GB | Peak: 19.03GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.96GB | Peak: 19.03GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.96GB | Peak: 19.03GB
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 19.03GB
[MEM After forward pass] Allocated: 12.67GB | Reserved: 13.65GB | Peak: 19.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([1438, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([2489, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 12.67GB, Reserved: 13.65GB

[LAV DEBUG] Processing pair (0,1): N=1438, M=2489
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -325.482788
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 689240.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 2064927.625000
[LAV DEBUG]   Pair loss = -325.4828 + 0.01 * (689240.7500 + 2064927.6250) = 27216.2012
[LAV DEBUG]   Pair (0,1) completed in 0.28s
[LAV DEBUG]   GPU Memory after pair: 14.40GB

[LAV DEBUG] Processing pair (1,0): N=2489, M=1438
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -325.482788
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2489) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2064927.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1438) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 689240.750000
[LAV DEBUG]   Pair loss = -325.4828 + 0.01 * (2064927.6250 + 689240.7500) = 27216.2012
[LAV DEBUG]   Pair (1,0) completed in 0.32s
[LAV DEBUG]   GPU Memory after pair: 16.13GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 54432.4023
[LAV DEBUG] Total time: 0.89s
[LAV DEBUG] Avg time per pair: 0.44s
============================================================

[MEM After loss computation] Allocated: 16.13GB | Reserved: 18.75GB | Peak: 19.03GB
[MEM Before backward] Allocated: 16.13GB | Reserved: 18.75GB | Peak: 19.03GB
[MEM Batch 26 START - Task tent] Allocated: 16.10GB | Reserved: 18.75GB | Peak: 16.10GB
[MEM After preprocess] Allocated: 16.10GB | Reserved: 18.75GB | Peak: 16.10GB
[MEM Batch 27 START - Task Pizza.cmu] Allocated: 16.10GB | Reserved: 18.75GB | Peak: 16.10GB
[MEM After preprocess] Allocated: 16.10GB | Reserved: 18.75GB | Peak: 16.10GB
[MEM After forward pass] Allocated: 18.55GB | Reserved: 19.71GB | Peak: 18.56GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([439, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([351, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.55GB, Reserved: 19.71GB

[LAV DEBUG] Processing pair (0,1): N=439, M=351
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -68.402588
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=439) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 64238.472656
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=351) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 41066.386719
[LAV DEBUG]   Pair loss = -68.4026 + 0.01 * (64238.4727 + 41066.3867) = 984.6460
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 18.62GB

[LAV DEBUG] Processing pair (1,0): N=351, M=439
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -68.402588
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=351) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 41066.386719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=439) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 64238.472656
[LAV DEBUG]   Pair loss = -68.4026 + 0.01 * (41066.3867 + 64238.4727) = 984.6460
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 18.70GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1969.2920
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 3.15GB | Reserved: 19.80GB | Peak: 18.77GB
[MEM Before backward] Allocated: 3.15GB | Reserved: 19.80GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 19.80GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 19.80GB | Peak: 18.77GB
[MEM Batch 28 START - Task Sandwich.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 1.46GB | Reserved: 1.59GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([133, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([156, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.46GB, Reserved: 1.59GB

[LAV DEBUG] Processing pair (0,1): N=133, M=156
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.861168
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=133) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5897.653320
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=156) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8113.195801
[LAV DEBUG]   Pair loss = -24.8612 + 0.01 * (5897.6533 + 8113.1958) = 115.2473
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.47GB

[LAV DEBUG] Processing pair (1,0): N=156, M=133
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -24.861168
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=156) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8113.195801
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=133) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5897.653320
[LAV DEBUG]   Pair loss = -24.8612 + 0.01 * (8113.1958 + 5897.6533) = 115.2473
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.48GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 230.4946
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 1.48GB | Reserved: 1.53GB | Peak: 18.77GB
[MEM Before backward] Allocated: 1.48GB | Reserved: 1.53GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.89GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 1.89GB | Peak: 18.77GB
[MEM Batch 29 START - Task Pizza.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 4.66GB | Reserved: 4.98GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[2026-02-01 14:11:02,770 - INFO - alignment_training_loop.py:376] - [BATCH 29] Loss value: 5632.1836
[2026-02-01 14:11:12,537 - INFO - alignment_training_loop.py:302] - [BATCH 30] Task: Brownie.cmu
[2026-02-01 14:11:12,713 - INFO - alignment_training_loop.py:319] - [BATCH 30] After preprocessing - Num sequences: 2, Lengths: [369, 359]
[2026-02-01 14:11:19,268 - INFO - alignment_training_loop.py:376] - [BATCH 30] Loss value: 1639.6697
[2026-02-01 14:11:24,588 - INFO - alignment_training_loop.py:302] - [BATCH 31] Task: Pizza.cmu
[2026-02-01 14:11:24,856 - INFO - alignment_training_loop.py:319] - [BATCH 31] After preprocessing - Num sequences: 2, Lengths: [585, 529]
[2026-02-01 14:11:34,745 - INFO - alignment_training_loop.py:376] - [BATCH 31] Loss value: 3952.1047
[2026-02-01 14:11:42,904 - INFO - alignment_training_loop.py:302] - [BATCH 32] Task: tent
[2026-02-01 14:11:42,909 - INFO - alignment_training_loop.py:302] - [BATCH 33] Task: meccano
[2026-02-01 14:11:43,451 - INFO - alignment_training_loop.py:319] - [BATCH 33] After preprocessing - Num sequences: 2, Lengths: [759, 1598]
[LAV DEBUG]   Seq 0: shape=torch.Size([632, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([693, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.66GB, Reserved: 4.98GB

[LAV DEBUG] Processing pair (0,1): N=632, M=693
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -116.026421
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=632) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 133135.875000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=693) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 160075.921875
[LAV DEBUG]   Pair loss = -116.0264 + 0.01 * (133135.8750 + 160075.9219) = 2816.0918
[LAV DEBUG]   Pair (0,1) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 4.87GB

[LAV DEBUG] Processing pair (1,0): N=693, M=632
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -116.026421
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=693) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160075.921875
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=632) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 133135.875000
[LAV DEBUG]   Pair loss = -116.0264 + 0.01 * (160075.9219 + 133135.8750) = 2816.0918
[LAV DEBUG]   Pair (1,0) completed in 0.04s
[LAV DEBUG]   GPU Memory after pair: 5.08GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 5632.1836
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 5.08GB | Reserved: 5.58GB | Peak: 18.77GB
[MEM Before backward] Allocated: 5.08GB | Reserved: 5.58GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.21GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 6.21GB | Peak: 18.77GB
[MEM Batch 30 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 2.81GB | Reserved: 3.04GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([369, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([359, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.81GB, Reserved: 3.04GB

[LAV DEBUG] Processing pair (0,1): N=369, M=359
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.627495
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=369) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 45386.394531
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=359) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 42959.839844
[LAV DEBUG]   Pair loss = -63.6275 + 0.01 * (45386.3945 + 42959.8398) = 819.8348
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.88GB

[LAV DEBUG] Processing pair (1,0): N=359, M=369
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.627495
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=359) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 42959.839844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=369) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 45386.394531
[LAV DEBUG]   Pair loss = -63.6275 + 0.01 * (42959.8398 + 45386.3945) = 819.8348
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.94GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1639.6697
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.94GB | Reserved: 3.12GB | Peak: 18.77GB
[MEM Before backward] Allocated: 2.94GB | Reserved: 3.12GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.52GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.52GB | Peak: 18.77GB
[MEM Batch 31 START - Task Pizza.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 4.01GB | Reserved: 4.27GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([585, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([529, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 4.01GB, Reserved: 4.27GB

[LAV DEBUG] Processing pair (0,1): N=585, M=529
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.437599
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=585) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 114071.250000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=529) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93277.742188
[LAV DEBUG]   Pair loss = -97.4376 + 0.01 * (114071.2500 + 93277.7422) = 1976.0524
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.16GB

[LAV DEBUG] Processing pair (1,0): N=529, M=585
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -97.437599
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=529) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93277.742188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=585) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 114071.250000
[LAV DEBUG]   Pair loss = -97.4376 + 0.01 * (93277.7422 + 114071.2500) = 1976.0524
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 4.31GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3952.1047
[LAV DEBUG] Total time: 0.33s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 4.31GB | Reserved: 4.57GB | Peak: 18.77GB
[MEM Before backward] Allocated: 4.31GB | Reserved: 4.57GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 5.01GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 5.01GB | Peak: 18.77GB
[MEM Batch 32 START - Task tent] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM Batch 33 START - Task meccano] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 7.85GB | Reserved: 8.44GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([759, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1598, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 7.85GB, Reserved: 8.44GB

[LAV DEBUG] Processing pair (0,1): N=759, M=1598
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -185.780319
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=759) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 192020.109375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1598) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 851165.312500
[LAV DEBUG]   Pair loss = -185.7803 + 0.01 * (192020.1094 + 851165.3125) = 10246.0742
[LAV DEBUG]   Pair (0,1) completed in 0.11s
[LAV DEBUG]   GPU Memory after pair: 8.44GB

[LAV DEBUG] Processing pair (1,0): N=1598, M=759
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -185.780319
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=1598) [no_grad]...
[2026-02-01 14:12:04,496 - INFO - alignment_training_loop.py:376] - [BATCH 33] Loss value: 20492.1484
[2026-02-01 14:12:21,950 - INFO - alignment_training_loop.py:302] - [BATCH 34] Task: Brownie.cmu
[2026-02-01 14:12:22,130 - INFO - alignment_training_loop.py:319] - [BATCH 34] After preprocessing - Num sequences: 2, Lengths: [335, 397]
[2026-02-01 14:12:28,724 - INFO - alignment_training_loop.py:376] - [BATCH 34] Loss value: 1671.6498
[2026-02-01 14:12:34,086 - INFO - alignment_training_loop.py:302] - [BATCH 35] Task: pc_disassembly
[2026-02-01 14:12:34,248 - INFO - alignment_training_loop.py:319] - [BATCH 35] After preprocessing - Num sequences: 2, Lengths: [324, 314]
[2026-02-01 14:12:40,057 - INFO - alignment_training_loop.py:376] - [BATCH 35] Loss value: 1245.7555
[2026-02-01 14:12:44,722 - INFO - alignment_training_loop.py:302] - [BATCH 36] Task: Salad.cmu
[2026-02-01 14:12:44,910 - INFO - alignment_training_loop.py:319] - [BATCH 36] After preprocessing - Num sequences: 2, Lengths: [379, 396]
[2026-02-01 14:12:51,909 - INFO - alignment_training_loop.py:376] - [BATCH 36] Loss value: 1867.5347
[2026-02-01 14:12:57,568 - INFO - alignment_training_loop.py:302] - [BATCH 37] Task: meccano
[2026-02-01 14:12:57,940 - INFO - alignment_training_loop.py:319] - [BATCH 37] After preprocessing - Num sequences: 2, Lengths: [875, 694]
[LAV DEBUG]   IntraContrast v1 result: 851165.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=759) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 192020.109375
[LAV DEBUG]   Pair loss = -185.7803 + 0.01 * (851165.3125 + 192020.1094) = 10246.0742
[LAV DEBUG]   Pair (1,0) completed in 0.10s
[LAV DEBUG]   GPU Memory after pair: 9.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 20492.1484
[LAV DEBUG] Total time: 0.46s
[LAV DEBUG] Avg time per pair: 0.23s
============================================================

[MEM After loss computation] Allocated: 9.02GB | Reserved: 9.61GB | Peak: 18.77GB
[MEM Before backward] Allocated: 9.02GB | Reserved: 9.61GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 11.35GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 11.35GB | Peak: 18.77GB
[MEM Batch 34 START - Task Brownie.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 2.83GB | Reserved: 3.05GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([335, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([397, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.83GB, Reserved: 3.05GB

[LAV DEBUG] Processing pair (0,1): N=335, M=397
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.617264
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=335) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 37408.437500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=397) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52535.781250
[LAV DEBUG]   Pair loss = -63.6173 + 0.01 * (37408.4375 + 52535.7812) = 835.8249
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.89GB

[LAV DEBUG] Processing pair (1,0): N=397, M=335
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -63.617264
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=397) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52535.781250
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=335) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 37408.437500
[LAV DEBUG]   Pair loss = -63.6173 + 0.01 * (52535.7812 + 37408.4375) = 835.8249
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 2.95GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1671.6498
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 2.95GB | Reserved: 3.12GB | Peak: 18.77GB
[MEM Before backward] Allocated: 2.95GB | Reserved: 3.12GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.53GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.53GB | Peak: 18.77GB
[MEM Batch 35 START - Task pc_disassembly] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 2.53GB | Reserved: 2.75GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([324, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([314, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.53GB, Reserved: 2.75GB

[LAV DEBUG] Processing pair (0,1): N=324, M=314
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.700371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=324) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 34992.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=314) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32865.605469
[LAV DEBUG]   Pair loss = -55.7004 + 0.01 * (34992.2031 + 32865.6055) = 622.8777
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.58GB

[LAV DEBUG] Processing pair (1,0): N=314, M=324
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -55.700371
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=314) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32865.605469
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=324) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 34992.203125
[LAV DEBUG]   Pair loss = -55.7004 + 0.01 * (32865.6055 + 34992.2031) = 622.8777
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.63GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1245.7555
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 2.63GB | Reserved: 2.79GB | Peak: 18.77GB
[MEM Before backward] Allocated: 2.63GB | Reserved: 2.79GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.26GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.26GB | Peak: 18.77GB
[MEM Batch 36 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 2.96GB | Reserved: 3.21GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([379, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([396, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.96GB, Reserved: 3.21GB

[LAV DEBUG] Processing pair (0,1): N=379, M=396
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.750130
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=379) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47880.136719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=396) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 52271.617188
[LAV DEBUG]   Pair loss = -67.7501 + 0.01 * (47880.1367 + 52271.6172) = 933.7673
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.03GB

[LAV DEBUG] Processing pair (1,0): N=396, M=379
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -67.750130
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=396) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 52271.617188
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=379) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47880.136719
[LAV DEBUG]   Pair loss = -67.7501 + 0.01 * (52271.6172 + 47880.1367) = 933.7673
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 3.10GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1867.5347
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 3.10GB | Reserved: 3.30GB | Peak: 18.77GB
[MEM Before backward] Allocated: 3.10GB | Reserved: 3.30GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.73GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 3.73GB | Peak: 18.77GB
[MEM Batch 37 START - Task meccano] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.78GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 5.42GB | Reserved: 5.79GB | Peak: 18.77GB

============================================================
[2026-02-01 14:13:11,917 - INFO - alignment_training_loop.py:376] - [BATCH 37] Loss value: 8042.3306
[2026-02-01 14:13:23,433 - INFO - alignment_training_loop.py:302] - [BATCH 38] Task: Salad.cmu
[2026-02-01 14:13:23,532 - INFO - alignment_training_loop.py:319] - [BATCH 38] After preprocessing - Num sequences: 2, Lengths: [272, 130]
[2026-02-01 14:13:27,239 - INFO - alignment_training_loop.py:376] - [BATCH 38] Loss value: 543.2664
[2026-02-01 14:13:30,179 - INFO - alignment_training_loop.py:302] - [BATCH 39] Task: Eggs.cmu
[2026-02-01 14:13:30,317 - INFO - alignment_training_loop.py:319] - [BATCH 39] After preprocessing - Num sequences: 2, Lengths: [196, 341]
[2026-02-01 14:13:35,186 - INFO - alignment_training_loop.py:376] - [BATCH 39] Loss value: 943.2927
[2026-02-01 14:13:39,087 - INFO - alignment_training_loop.py:302] - [BATCH 40] Task: PastaSalad.egtea
[2026-02-01 14:13:40,110 - INFO - alignment_training_loop.py:319] - [BATCH 40] After preprocessing - Num sequences: 2, Lengths: [2492, 1796]
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([875, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([694, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 5.42GB, Reserved: 5.79GB

[LAV DEBUG] Processing pair (0,1): N=875, M=694
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -136.242920
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=875) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 255200.062500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=694) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 160540.765625
[LAV DEBUG]   Pair loss = -136.2429 + 0.01 * (255200.0625 + 160540.7656) = 4021.1653
[LAV DEBUG]   Pair (0,1) completed in 0.06s
[LAV DEBUG]   GPU Memory after pair: 5.71GB

[LAV DEBUG] Processing pair (1,0): N=694, M=875
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -136.242920
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=694) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 160540.765625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=875) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 255200.062500
[LAV DEBUG]   Pair loss = -136.2429 + 0.01 * (160540.7656 + 255200.0625) = 4021.1653
[LAV DEBUG]   Pair (1,0) completed in 0.05s
[LAV DEBUG]   GPU Memory after pair: 6.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 8042.3306
[LAV DEBUG] Total time: 0.38s
[LAV DEBUG] Avg time per pair: 0.19s
============================================================

[MEM After loss computation] Allocated: 6.01GB | Reserved: 6.37GB | Peak: 18.77GB
[MEM Before backward] Allocated: 6.01GB | Reserved: 6.37GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.24GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 7.24GB | Peak: 18.77GB
[MEM Batch 38 START - Task Salad.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 1.80GB | Reserved: 1.99GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([130, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 1.80GB, Reserved: 1.99GB

[LAV DEBUG] Processing pair (0,1): N=272, M=130
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.335058
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24662.072266
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=130) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 5634.754883
[LAV DEBUG]   Pair loss = -31.3351 + 0.01 * (24662.0723 + 5634.7549) = 271.6332
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.82GB

[LAV DEBUG] Processing pair (1,0): N=130, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -31.335058
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=130) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 5634.754883
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24662.072266
[LAV DEBUG]   Pair loss = -31.3351 + 0.01 * (5634.7549 + 24662.0723) = 271.6332
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 1.84GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 543.2664
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 1.84GB | Reserved: 1.94GB | Peak: 18.77GB
[MEM Before backward] Allocated: 1.84GB | Reserved: 1.94GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.31GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.31GB | Peak: 18.77GB
[MEM Batch 39 START - Task Eggs.cmu] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 2.22GB | Reserved: 2.38GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([196, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([341, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 2.22GB, Reserved: 2.38GB

[LAV DEBUG] Processing pair (0,1): N=196, M=341
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.024990
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=196) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 12806.494141
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=341) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 38760.640625
[LAV DEBUG]   Pair loss = -44.0250 + 0.01 * (12806.4941 + 38760.6406) = 471.6463
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.25GB

[LAV DEBUG] Processing pair (1,0): N=341, M=196
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.024990
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=341) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 38760.640625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=196) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 12806.494141
[LAV DEBUG]   Pair loss = -44.0250 + 0.01 * (38760.6406 + 12806.4941) = 471.6463
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 2.29GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 943.2927
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 2.29GB | Reserved: 2.41GB | Peak: 18.77GB
[MEM Before backward] Allocated: 2.29GB | Reserved: 2.41GB | Peak: 18.77GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.78GB | Peak: 18.77GB
[MEM After optimizer step] Allocated: 0.56GB | Reserved: 2.78GB | Peak: 18.77GB
[MEM Batch 40 START - Task PastaSalad.egtea] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After preprocess] Allocated: 0.56GB | Reserved: 0.79GB | Peak: 18.77GB
[MEM After forward pass] Allocated: 13.83GB | Reserved: 14.88GB | Peak: 18.77GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([2492, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([1796, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 13.83GB, Reserved: 14.88GB

[LAV DEBUG] Processing pair (0,1): N=2492, M=1796
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -369.308899
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=2492) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 2069948.625000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=1796) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 1075169.000000
[LAV DEBUG]   Pair loss = -369.3089 + 0.01 * (2069948.6250 + 1075169.0000) = 31081.8652
[LAV DEBUG]   Pair (0,1) completed in 0.36s
[LAV DEBUG]   GPU Memory after pair: 16.00GB

[LAV DEBUG] Processing pair (1,0): N=1796, M=2492
[LAV DEBUG]   Step 1: Computing SoftDTW...
[2026-02-01 14:14:17,974 - WARNING - alignment_training_loop.py:349] - Skipping batch in task PastaSalad.egtea due to: CUDA out of memory. Tried to allocate 2.13 GiB (GPU 0; 22.16 GiB total capacity; 18.13 GiB already allocated; 682.12 MiB free; 21.27 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2026-02-01 14:14:17,975 - ERROR - alignment_training_loop.py:352] - [OOM in LOSS] Task: PastaSalad.egtea, Sequences: 2, Lengths: [2492, 1796]
[2026-02-01 14:14:18,350 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:14:18,351 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:14:18,713 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:14:18,713 - INFO - alignment_training_loop.py:302] - [BATCH 41] Task: Pizza.cmu
[2026-02-01 14:14:18,971 - INFO - alignment_training_loop.py:319] - [BATCH 41] After preprocessing - Num sequences: 2, Lengths: [593, 458]
[2026-02-01 14:14:28,185 - INFO - alignment_training_loop.py:376] - [BATCH 41] Loss value: 3560.9836
[2026-02-01 14:14:35,792 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:14:36,129 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:14:36,129 - INFO - alignment_training_loop.py:302] - [BATCH 42] Task: TurkeySandwich.egtea
[2026-02-01 14:14:36,388 - INFO - alignment_training_loop.py:319] - [BATCH 42] After preprocessing - Num sequences: 2, Lengths: [582, 506]
[2026-02-01 14:14:46,271 - INFO - alignment_training_loop.py:376] - [BATCH 42] Loss value: 3775.0432
[2026-02-01 14:14:54,110 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:14:54,457 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:14:54,457 - INFO - alignment_training_loop.py:302] - [BATCH 43] Task: Brownie.cmu
[2026-02-01 14:14:54,618 - INFO - alignment_training_loop.py:319] - [BATCH 43] After preprocessing - Num sequences: 2, Lengths: [224, 403]
[2026-02-01 14:15:00,266 - INFO - alignment_training_loop.py:376] - [BATCH 43] Loss value: 1315.0656
[2026-02-01 14:15:04,774 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:15:05,149 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:15:05,149 - INFO - alignment_training_loop.py:302] - [BATCH 44] Task: meccano
[2026-02-01 14:15:05,531 - INFO - alignment_training_loop.py:319] - [BATCH 44] After preprocessing - Num sequences: 2, Lengths: [838, 845]
[2026-02-01 14:15:17,917 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: meccano, Lengths: [838, 845]
[2026-02-01 14:15:18,597 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.58GB
[2026-02-01 14:15:18,736 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:15:19,252 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:15:19,252 - INFO - alignment_training_loop.py:302] - [BATCH 45] Task: Salad.cmu
[2026-02-01 14:15:19,377 - INFO - alignment_training_loop.py:319] - [BATCH 45] After preprocessing - Num sequences: 2, Lengths: [272, 224]
[LAV DEBUG]   ERROR in SoftDTW: OutOfMemoryError: CUDA out of memory. Tried to allocate 2.13 GiB (GPU 0; 22.16 GiB total capacity; 18.13 GiB already allocated; 682.12 MiB free; 21.27 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Managem
[MEM Batch 41 START - Task Pizza.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 19.25GB | Reserved: 20.50GB | Peak: 19.26GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([593, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([458, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.25GB, Reserved: 20.50GB

[LAV DEBUG] Processing pair (0,1): N=593, M=458
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.857742
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=593) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 117214.203125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=458) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 69920.765625
[LAV DEBUG]   Pair loss = -90.8577 + 0.01 * (117214.2031 + 69920.7656) = 1780.4918
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.38GB

[LAV DEBUG] Processing pair (1,0): N=458, M=593
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -90.857742
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=458) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 69920.765625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=593) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 117214.203125
[LAV DEBUG]   Pair loss = -90.8577 + 0.01 * (69920.7656 + 117214.2031) = 1780.4918
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.51GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3560.9836
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 19.51GB | Reserved: 20.71GB | Peak: 19.64GB
[MEM Before backward] Allocated: 19.51GB | Reserved: 20.71GB | Peak: 19.64GB
[MEM After backward] Allocated: 16.18GB | Reserved: 21.10GB | Peak: 19.90GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 21.10GB | Peak: 19.90GB
[MEM Batch 42 START - Task TurkeySandwich.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 19.36GB | Reserved: 20.60GB | Peak: 19.38GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([582, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([506, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.36GB, Reserved: 20.60GB

[LAV DEBUG] Processing pair (0,1): N=582, M=506
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.970535
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=582) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 112904.898438
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=506) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 85344.312500
[LAV DEBUG]   Pair loss = -94.9705 + 0.01 * (112904.8984 + 85344.3125) = 1887.5216
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.50GB

[LAV DEBUG] Processing pair (1,0): N=506, M=582
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.970535
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=506) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 85344.312500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=582) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 112904.898438
[LAV DEBUG]   Pair loss = -94.9705 + 0.01 * (85344.3125 + 112904.8984) = 1887.5216
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.65GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3775.0432
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 19.65GB | Reserved: 20.88GB | Peak: 19.79GB
[MEM Before backward] Allocated: 19.65GB | Reserved: 20.88GB | Peak: 19.79GB
[MEM After backward] Allocated: 16.18GB | Reserved: 21.30GB | Peak: 20.07GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 21.30GB | Peak: 20.07GB
[MEM Batch 43 START - Task Brownie.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.94GB | Reserved: 19.75GB | Peak: 17.94GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([403, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.94GB, Reserved: 19.75GB

[LAV DEBUG] Processing pair (0,1): N=224, M=403
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.095524
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.470703
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=403) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 54136.359375
[LAV DEBUG]   Pair loss = -51.0955 + 0.01 * (16726.4707 + 54136.3594) = 657.5328
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 17.98GB

[LAV DEBUG] Processing pair (1,0): N=403, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -51.095524
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=403) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 54136.359375
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.470703
[LAV DEBUG]   Pair loss = -51.0955 + 0.01 * (54136.3594 + 16726.4707) = 657.5328
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 18.02GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1315.0656
[LAV DEBUG] Total time: 0.27s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 18.02GB | Reserved: 19.75GB | Peak: 18.07GB
[MEM Before backward] Allocated: 18.02GB | Reserved: 19.75GB | Peak: 18.07GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.75GB | Peak: 18.17GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.75GB | Peak: 18.17GB
[MEM Batch 44 START - Task meccano] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 45 START - Task Salad.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.53GB | Reserved: 19.61GB | Peak: 17.54GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([272, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([224, 128]), dtype=torch.float32, device=cuda:0
[2026-02-01 14:15:24,837 - INFO - alignment_training_loop.py:376] - [BATCH 45] Loss value: 742.0180
[2026-02-01 14:15:28,418 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:15:28,769 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:15:28,769 - INFO - alignment_training_loop.py:302] - [BATCH 46] Task: Eggs.cmu
[2026-02-01 14:15:28,905 - INFO - alignment_training_loop.py:319] - [BATCH 46] After preprocessing - Num sequences: 2, Lengths: [237, 282]
[2026-02-01 14:15:34,641 - INFO - alignment_training_loop.py:376] - [BATCH 46] Loss value: 814.7469
[2026-02-01 14:15:38,379 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:15:38,714 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:15:38,714 - INFO - alignment_training_loop.py:302] - [BATCH 47] Task: PastaSalad.egtea
[2026-02-01 14:15:39,604 - INFO - alignment_training_loop.py:319] - [BATCH 47] After preprocessing - Num sequences: 2, Lengths: [2192, 1728]
[2026-02-01 14:15:51,964 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: PastaSalad.egtea, Lengths: [2192, 1728]
[2026-02-01 14:15:52,926 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.35GB
[2026-02-01 14:15:53,154 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:15:53,693 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:15:53,693 - INFO - alignment_training_loop.py:302] - [BATCH 48] Task: GreekSalad.egtea
[2026-02-01 14:15:54,055 - INFO - alignment_training_loop.py:319] - [BATCH 48] After preprocessing - Num sequences: 2, Lengths: [850, 658]
[2026-02-01 14:16:09,860 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [850, 658]
[2026-02-01 14:16:10,216 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.63GB
[2026-02-01 14:16:10,345 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:16:10,857 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:16:10,857 - INFO - alignment_training_loop.py:302] - [BATCH 49] Task: Sandwich.cmu
[2026-02-01 14:16:10,944 - INFO - alignment_training_loop.py:319] - [BATCH 49] After preprocessing - Num sequences: 2, Lengths: [189, 160]
[2026-02-01 14:16:14,793 - INFO - alignment_training_loop.py:376] - [BATCH 49] Loss value: 348.6642
[2026-02-01 14:16:17,299 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:16:17,630 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:16:17,630 - INFO - alignment_training_loop.py:302] - [BATCH 50] Task: ContinentalBreakfast.egtea
[2026-02-01 14:16:18,003 - INFO - alignment_training_loop.py:319] - [BATCH 50] After preprocessing - Num sequences: 2, Lengths: [474, 1167]
[2026-02-01 14:16:33,352 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [474, 1167]
[2026-02-01 14:16:34,261 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.62GB
[2026-02-01 14:16:34,406 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:16:34,910 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:16:34,911 - INFO - alignment_training_loop.py:302] - [BATCH 51] Task: Salad.cmu
[2026-02-01 14:16:35,129 - INFO - alignment_training_loop.py:319] - [BATCH 51] After preprocessing - Num sequences: 2, Lengths: [346, 523]
[LAV DEBUG] Initial GPU Memory - Allocated: 17.53GB, Reserved: 19.61GB

[LAV DEBUG] Processing pair (0,1): N=272, M=224
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.878975
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=272) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 24662.294922
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=224) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16726.501953
[LAV DEBUG]   Pair loss = -42.8790 + 0.01 * (24662.2949 + 16726.5020) = 371.0090
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.56GB

[LAV DEBUG] Processing pair (1,0): N=224, M=272
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -42.878975
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=224) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16726.501953
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=272) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 24662.294922
[LAV DEBUG]   Pair loss = -42.8790 + 0.01 * (16726.5020 + 24662.2949) = 371.0090
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.59GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 742.0180
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 17.59GB | Reserved: 19.61GB | Peak: 17.62GB
[MEM Before backward] Allocated: 17.59GB | Reserved: 19.61GB | Peak: 17.62GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.62GB | Peak: 17.78GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.62GB | Peak: 17.78GB
[MEM Batch 46 START - Task Eggs.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.60GB | Reserved: 19.63GB | Peak: 17.61GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([237, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([282, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.60GB, Reserved: 19.63GB

[LAV DEBUG] Processing pair (0,1): N=237, M=282
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.956692
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=237) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 18724.136719
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=282) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 26508.876953
[LAV DEBUG]   Pair loss = -44.9567 + 0.01 * (18724.1367 + 26508.8770) = 407.3734
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 17.63GB

[LAV DEBUG] Processing pair (1,0): N=282, M=237
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -44.956692
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=282) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 26508.876953
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=237) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 18724.136719
[LAV DEBUG]   Pair loss = -44.9567 + 0.01 * (26508.8770 + 18724.1367) = 407.3734
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.67GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 814.7469
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 17.67GB | Reserved: 19.63GB | Peak: 17.70GB
[MEM Before backward] Allocated: 17.67GB | Reserved: 19.63GB | Peak: 17.70GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.64GB | Peak: 17.85GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.64GB | Peak: 17.85GB
[MEM Batch 47 START - Task PastaSalad.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 48 START - Task GreekSalad.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 49 START - Task Sandwich.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.08GB | Reserved: 19.46GB | Peak: 17.08GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([189, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([160, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.08GB, Reserved: 19.46GB

[LAV DEBUG] Processing pair (0,1): N=189, M=160
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.098886
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=189) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11908.335938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=160) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 8534.762695
[LAV DEBUG]   Pair loss = -30.0989 + 0.01 * (11908.3359 + 8534.7627) = 174.3321
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.09GB

[LAV DEBUG] Processing pair (1,0): N=160, M=189
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -30.098886
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=160) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 8534.762695
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=189) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11908.335938
[LAV DEBUG]   Pair loss = -30.0989 + 0.01 * (8534.7627 + 11908.3359) = 174.3321
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.11GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 348.6642
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 17.11GB | Reserved: 19.46GB | Peak: 17.12GB
[MEM Before backward] Allocated: 17.11GB | Reserved: 19.46GB | Peak: 17.12GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.46GB | Peak: 17.34GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.46GB | Peak: 17.34GB
[MEM Batch 50 START - Task ContinentalBreakfast.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 51 START - Task Salad.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 18.68GB | Reserved: 19.99GB | Peak: 18.70GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([346, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([523, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.68GB, Reserved: 19.99GB

[LAV DEBUG] Processing pair (0,1): N=346, M=523
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -73.493416
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=346) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 39905.964844
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=523) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 91175.593750
[LAV DEBUG]   Pair loss = -73.4934 + 0.01 * (39905.9648 + 91175.5938) = 1237.3221
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 18.77GB
[2026-02-01 14:16:44,653 - INFO - alignment_training_loop.py:376] - [BATCH 51] Loss value: 2474.6443
[2026-02-01 14:16:50,928 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:16:51,283 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:16:51,283 - INFO - alignment_training_loop.py:302] - [BATCH 52] Task: Brownie.cmu
[2026-02-01 14:16:51,521 - INFO - alignment_training_loop.py:319] - [BATCH 52] After preprocessing - Num sequences: 2, Lengths: [689, 313]
[2026-02-01 14:17:02,442 - INFO - alignment_training_loop.py:376] - [BATCH 52] Loss value: 3662.6021
[2026-02-01 14:17:09,715 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:17:10,047 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:17:10,048 - INFO - alignment_training_loop.py:302] - [BATCH 53] Task: Sandwich.cmu
[2026-02-01 14:17:10,135 - INFO - alignment_training_loop.py:319] - [BATCH 53] After preprocessing - Num sequences: 2, Lengths: [145, 188]
[2026-02-01 14:17:13,919 - INFO - alignment_training_loop.py:376] - [BATCH 53] Loss value: 318.9152
[2026-02-01 14:17:16,329 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:17:16,682 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:17:16,682 - INFO - alignment_training_loop.py:302] - [BATCH 54] Task: Sandwich.cmu
[2026-02-01 14:17:16,797 - INFO - alignment_training_loop.py:319] - [BATCH 54] After preprocessing - Num sequences: 2, Lengths: [168, 256]
[2026-02-01 14:17:21,513 - INFO - alignment_training_loop.py:376] - [BATCH 54] Loss value: 553.9786
[2026-02-01 14:17:24,589 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:17:24,923 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:17:24,923 - INFO - alignment_training_loop.py:302] - [BATCH 55] Task: Salad.cmu

[LAV DEBUG] Processing pair (1,0): N=523, M=346
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -73.493416
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=523) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 91175.593750
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=346) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 39905.964844
[LAV DEBUG]   Pair loss = -73.4934 + 0.01 * (91175.5938 + 39905.9648) = 1237.3221
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 18.86GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 2474.6443
[LAV DEBUG] Total time: 0.28s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 18.86GB | Reserved: 20.08GB | Peak: 18.95GB
[MEM Before backward] Allocated: 18.86GB | Reserved: 20.08GB | Peak: 18.95GB
[MEM After backward] Allocated: 16.18GB | Reserved: 20.45GB | Peak: 19.12GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 20.45GB | Peak: 19.12GB
[MEM Batch 52 START - Task Brownie.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 19.09GB | Reserved: 20.29GB | Peak: 19.11GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([689, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([313, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.09GB, Reserved: 20.29GB

[LAV DEBUG] Processing pair (0,1): N=689, M=313
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -77.651093
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=689) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 158238.078125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=313) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 32657.142578
[LAV DEBUG]   Pair loss = -77.6511 + 0.01 * (158238.0781 + 32657.1426) = 1831.3010
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.20GB

[LAV DEBUG] Processing pair (1,0): N=313, M=689
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -77.651093
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=313) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 32657.142578
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=689) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 158238.078125
[LAV DEBUG]   Pair loss = -77.6511 + 0.01 * (32657.1426 + 158238.0781) = 1831.3010
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.30GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3662.6021
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 19.30GB | Reserved: 20.50GB | Peak: 19.41GB
[MEM Before backward] Allocated: 19.30GB | Reserved: 20.50GB | Peak: 19.41GB
[MEM After backward] Allocated: 16.18GB | Reserved: 21.03GB | Peak: 19.61GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 21.03GB | Peak: 19.61GB
[MEM Batch 53 START - Task Sandwich.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.03GB | Reserved: 19.44GB | Peak: 17.03GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([145, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([188, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.03GB, Reserved: 19.44GB

[LAV DEBUG] Processing pair (0,1): N=145, M=188
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.467422
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=145) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 7009.799805
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=188) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 11782.703125
[LAV DEBUG]   Pair loss = -28.4674 + 0.01 * (7009.7998 + 11782.7031) = 159.4576
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.04GB

[LAV DEBUG] Processing pair (1,0): N=188, M=145
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -28.467422
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=188) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 11782.703125
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=145) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 7009.799805
[LAV DEBUG]   Pair loss = -28.4674 + 0.01 * (11782.7031 + 7009.7998) = 159.4576
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.06GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 318.9152
[LAV DEBUG] Total time: 0.24s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 17.06GB | Reserved: 19.44GB | Peak: 17.07GB
[MEM Before backward] Allocated: 17.06GB | Reserved: 19.44GB | Peak: 17.07GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.45GB | Peak: 17.29GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.45GB | Peak: 17.29GB
[MEM Batch 54 START - Task Sandwich.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.31GB | Reserved: 19.54GB | Peak: 17.32GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([168, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([256, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.31GB, Reserved: 19.54GB

[LAV DEBUG] Processing pair (0,1): N=168, M=256
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.570179
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=168) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 9409.436523
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=256) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 21846.515625
[LAV DEBUG]   Pair loss = -35.5702 + 0.01 * (9409.4365 + 21846.5156) = 276.9893
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.33GB

[LAV DEBUG] Processing pair (1,0): N=256, M=168
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -35.570179
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=256) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 21846.515625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=168) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 9409.436523
[LAV DEBUG]   Pair loss = -35.5702 + 0.01 * (21846.5156 + 9409.4365) = 276.9893
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.35GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 553.9786
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 17.35GB | Reserved: 19.54GB | Peak: 17.37GB
[MEM Before backward] Allocated: 17.35GB | Reserved: 19.54GB | Peak: 17.37GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.54GB | Peak: 17.56GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.54GB | Peak: 17.56GB
[2026-02-01 14:17:25,082 - INFO - alignment_training_loop.py:319] - [BATCH 55] After preprocessing - Num sequences: 2, Lengths: [305, 300]
[2026-02-01 14:17:31,796 - INFO - alignment_training_loop.py:376] - [BATCH 55] Loss value: 1114.5996
[2026-02-01 14:17:36,164 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:17:36,497 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:17:36,497 - INFO - alignment_training_loop.py:302] - [BATCH 56] Task: Cheeseburger.egtea
[2026-02-01 14:17:36,765 - INFO - alignment_training_loop.py:319] - [BATCH 56] After preprocessing - Num sequences: 2, Lengths: [670, 447]
[2026-02-01 14:17:48,953 - INFO - alignment_training_loop.py:376] - [BATCH 56] Loss value: 4135.2217
[2026-02-01 14:17:57,123 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:17:57,455 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:17:57,455 - INFO - alignment_training_loop.py:302] - [BATCH 57] Task: Eggs.cmu
[2026-02-01 14:17:57,605 - INFO - alignment_training_loop.py:319] - [BATCH 57] After preprocessing - Num sequences: 2, Lengths: [349, 246]
[2026-02-01 14:18:04,147 - INFO - alignment_training_loop.py:376] - [BATCH 57] Loss value: 1114.1715
[2026-02-01 14:18:08,461 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:18:08,798 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:18:08,798 - INFO - alignment_training_loop.py:302] - [BATCH 58] Task: Pizza.cmu
[2026-02-01 14:18:09,055 - INFO - alignment_training_loop.py:319] - [BATCH 58] After preprocessing - Num sequences: 2, Lengths: [531, 575]
[MEM Batch 55 START - Task Salad.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.87GB | Reserved: 19.73GB | Peak: 17.88GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([305, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([300, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.87GB, Reserved: 19.73GB

[LAV DEBUG] Processing pair (0,1): N=305, M=300
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.802677
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=305) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 31009.267578
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=300) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 30000.982422
[LAV DEBUG]   Pair loss = -52.8027 + 0.01 * (31009.2676 + 30000.9824) = 557.2998
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.91GB

[LAV DEBUG] Processing pair (1,0): N=300, M=305
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -52.802677
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=300) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 30000.982422
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=305) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 31009.267578
[LAV DEBUG]   Pair loss = -52.8027 + 0.01 * (30000.9824 + 31009.2676) = 557.2998
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.96GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1114.5996
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.12s
============================================================

[MEM After loss computation] Allocated: 17.96GB | Reserved: 19.73GB | Peak: 18.00GB
[MEM Before backward] Allocated: 17.96GB | Reserved: 19.73GB | Peak: 18.00GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.73GB | Peak: 18.11GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.73GB | Peak: 18.11GB
[MEM Batch 56 START - Task Cheeseburger.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 19.45GB | Reserved: 20.68GB | Peak: 19.46GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([670, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([447, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.45GB, Reserved: 20.68GB

[LAV DEBUG] Processing pair (0,1): N=670, M=447
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.738586
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=670) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 149631.750000
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=447) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 66603.187500
[LAV DEBUG]   Pair loss = -94.7386 + 0.01 * (149631.7500 + 66603.1875) = 2067.6108
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.59GB

[LAV DEBUG] Processing pair (1,0): N=447, M=670
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -94.738586
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=447) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 66603.187500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=670) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 149631.750000
[LAV DEBUG]   Pair loss = -94.7386 + 0.01 * (66603.1875 + 149631.7500) = 2067.6108
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.74GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 4135.2217
[LAV DEBUG] Total time: 0.30s
[LAV DEBUG] Avg time per pair: 0.15s
============================================================

[MEM After loss computation] Allocated: 19.74GB | Reserved: 20.96GB | Peak: 19.88GB
[MEM Before backward] Allocated: 19.74GB | Reserved: 20.96GB | Peak: 19.88GB
[MEM After backward] Allocated: 16.18GB | Reserved: 21.40GB | Peak: 20.16GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 21.40GB | Peak: 20.16GB
[MEM Batch 57 START - Task Eggs.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.84GB | Reserved: 19.72GB | Peak: 17.85GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([349, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([246, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.84GB, Reserved: 19.72GB

[LAV DEBUG] Processing pair (0,1): N=349, M=246
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.658184
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=349) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 40601.132812
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=246) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 20173.265625
[LAV DEBUG]   Pair loss = -50.6582 + 0.01 * (40601.1328 + 20173.2656) = 557.0858
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.88GB

[LAV DEBUG] Processing pair (1,0): N=246, M=349
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -50.658184
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=246) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 20173.265625
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=349) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 40601.132812
[LAV DEBUG]   Pair loss = -50.6582 + 0.01 * (20173.2656 + 40601.1328) = 557.0858
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.92GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1114.1715
[LAV DEBUG] Total time: 0.25s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 17.92GB | Reserved: 19.72GB | Peak: 17.96GB
[MEM Before backward] Allocated: 17.92GB | Reserved: 19.72GB | Peak: 17.96GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.72GB | Peak: 18.08GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.72GB | Peak: 18.08GB
[MEM Batch 58 START - Task Pizza.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 19.42GB | Reserved: 20.63GB | Peak: 19.43GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([531, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([575, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 19.42GB, Reserved: 20.63GB

[LAV DEBUG] Processing pair (0,1): N=531, M=575
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.808258
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=531) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 93986.710938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=575) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 110207.726562
[LAV DEBUG]   Pair loss = -96.8083 + 0.01 * (93986.7109 + 110207.7266) = 1945.1361
[2026-02-01 14:18:21,151 - INFO - alignment_training_loop.py:376] - [BATCH 58] Loss value: 3890.2722
[2026-02-01 14:18:29,172 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:18:29,500 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:18:29,500 - INFO - alignment_training_loop.py:302] - [BATCH 59] Task: Brownie.cmu
[2026-02-01 14:18:29,723 - INFO - alignment_training_loop.py:319] - [BATCH 59] After preprocessing - Num sequences: 2, Lengths: [621, 297]
[2026-02-01 14:18:39,807 - INFO - alignment_training_loop.py:376] - [BATCH 59] Loss value: 3014.6375
[2026-02-01 14:18:46,416 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:18:46,747 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:18:46,747 - INFO - alignment_training_loop.py:302] - [BATCH 60] Task: Eggs.cmu
[2026-02-01 14:18:46,901 - INFO - alignment_training_loop.py:319] - [BATCH 60] After preprocessing - Num sequences: 2, Lengths: [222, 378]
[2026-02-01 14:18:53,483 - INFO - alignment_training_loop.py:376] - [BATCH 60] Loss value: 1182.2126
[2026-02-01 14:18:57,821 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:18:58,155 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:18:58,155 - INFO - alignment_training_loop.py:302] - [BATCH 61] Task: tent
[2026-02-01 14:18:58,563 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:18:58,918 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:18:58,918 - INFO - alignment_training_loop.py:302] - [BATCH 62] Task: ContinentalBreakfast.egtea
[2026-02-01 14:18:59,364 - INFO - alignment_training_loop.py:319] - [BATCH 62] After preprocessing - Num sequences: 2, Lengths: [1343, 543]
[2026-02-01 14:19:13,607 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [1343, 543]
[2026-02-01 14:19:13,950 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.45GB
[2026-02-01 14:19:14,097 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:19:14,592 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:19:14,592 - INFO - alignment_training_loop.py:302] - [BATCH 63] Task: Eggs.cmu
[2026-02-01 14:19:14,721 - INFO - alignment_training_loop.py:319] - [BATCH 63] After preprocessing - Num sequences: 2, Lengths: [292, 202]
[LAV DEBUG]   Pair (0,1) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.57GB

[LAV DEBUG] Processing pair (1,0): N=575, M=531
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -96.808258
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=575) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 110207.726562
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=531) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 93986.710938
[LAV DEBUG]   Pair loss = -96.8083 + 0.01 * (110207.7266 + 93986.7109) = 1945.1361
[LAV DEBUG]   Pair (1,0) completed in 0.03s
[LAV DEBUG]   GPU Memory after pair: 19.72GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3890.2722
[LAV DEBUG] Total time: 0.32s
[LAV DEBUG] Avg time per pair: 0.16s
============================================================

[MEM After loss computation] Allocated: 19.72GB | Reserved: 20.92GB | Peak: 19.86GB
[MEM Before backward] Allocated: 19.72GB | Reserved: 20.92GB | Peak: 19.86GB
[MEM After backward] Allocated: 16.18GB | Reserved: 21.36GB | Peak: 20.15GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 21.36GB | Peak: 20.15GB
[MEM Batch 59 START - Task Brownie.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 18.83GB | Reserved: 20.04GB | Peak: 18.85GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([621, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([297, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 18.83GB, Reserved: 20.04GB

[LAV DEBUG] Processing pair (0,1): N=621, M=297
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.182045
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=621) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 128546.039062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=297) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 29404.039062
[LAV DEBUG]   Pair loss = -72.1820 + 0.01 * (128546.0391 + 29404.0391) = 1507.3187
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 18.92GB

[LAV DEBUG] Processing pair (1,0): N=297, M=621
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -72.182045
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=297) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 29404.039062
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=621) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 128546.039062
[LAV DEBUG]   Pair loss = -72.1820 + 0.01 * (29404.0391 + 128546.0391) = 1507.3187
[LAV DEBUG]   Pair (1,0) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 19.01GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 3014.6375
[LAV DEBUG] Total time: 0.29s
[LAV DEBUG] Avg time per pair: 0.14s
============================================================

[MEM After loss computation] Allocated: 19.01GB | Reserved: 20.22GB | Peak: 19.10GB
[MEM Before backward] Allocated: 19.01GB | Reserved: 20.22GB | Peak: 19.10GB
[MEM After backward] Allocated: 16.18GB | Reserved: 20.70GB | Peak: 19.27GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 20.70GB | Peak: 19.27GB
[MEM Batch 60 START - Task Eggs.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.85GB | Reserved: 19.72GB | Peak: 17.86GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([222, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([378, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.85GB, Reserved: 19.72GB

[LAV DEBUG] Processing pair (0,1): N=222, M=378
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.473854
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=222) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 16429.335938
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=378) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 47628.687500
[LAV DEBUG]   Pair loss = -49.4739 + 0.01 * (16429.3359 + 47628.6875) = 591.1063
[LAV DEBUG]   Pair (0,1) completed in 0.02s
[LAV DEBUG]   GPU Memory after pair: 17.89GB

[LAV DEBUG] Processing pair (1,0): N=378, M=222
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -49.473854
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=378) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 47628.687500
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=222) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 16429.335938
[LAV DEBUG]   Pair loss = -49.4739 + 0.01 * (47628.6875 + 16429.3359) = 591.1063
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.93GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 1182.2126
[LAV DEBUG] Total time: 0.26s
[LAV DEBUG] Avg time per pair: 0.13s
============================================================

[MEM After loss computation] Allocated: 17.93GB | Reserved: 19.72GB | Peak: 17.97GB
[MEM Before backward] Allocated: 17.93GB | Reserved: 19.72GB | Peak: 17.97GB
[MEM After backward] Allocated: 16.18GB | Reserved: 19.72GB | Peak: 18.09GB
[MEM After optimizer step] Allocated: 16.00GB | Reserved: 19.72GB | Peak: 18.09GB
[MEM Batch 61 START - Task tent] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 62 START - Task ContinentalBreakfast.egtea] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM Batch 63 START - Task Eggs.cmu] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After preprocess] Allocated: 16.00GB | Reserved: 19.13GB | Peak: 16.00GB
[MEM After forward pass] Allocated: 17.52GB | Reserved: 19.61GB | Peak: 17.53GB

============================================================
[LAV DEBUG] === LAV_loss called ===
[LAV DEBUG] Number of sequences: 2
[LAV DEBUG] min_temp=0.1, cr_coefficient=0.01
[LAV DEBUG]   Seq 0: shape=torch.Size([292, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG]   Seq 1: shape=torch.Size([202, 128]), dtype=torch.float32, device=cuda:0
[LAV DEBUG] Initial GPU Memory - Allocated: 17.52GB, Reserved: 19.61GB

[LAV DEBUG] Processing pair (0,1): N=292, M=202
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.866623
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=292) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 28422.423828
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=202) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 13602.741211
[LAV DEBUG]   Pair loss = -41.8666 + 0.01 * (28422.4238 + 13602.7412) = 378.3850
[LAV DEBUG]   Pair (0,1) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.55GB

[LAV DEBUG] Processing pair (1,0): N=202, M=292
[LAV DEBUG]   Step 1: Computing SoftDTW...
[LAV DEBUG]   SoftDTW result: -41.866623
[LAV DEBUG]   Step 2: Computing IntraContrast for v1 (N=202) [no_grad]...
[LAV DEBUG]   IntraContrast v1 result: 13602.741211
[LAV DEBUG]   Step 3: Computing IntraContrast for v2 (M=292) [no_grad]...
[LAV DEBUG]   IntraContrast v2 result: 28422.423828
[LAV DEBUG]   Pair loss = -41.8666 + 0.01 * (13602.7412 + 28422.4238) = 378.3850
[LAV DEBUG]   Pair (1,0) completed in 0.01s
[LAV DEBUG]   GPU Memory after pair: 17.58GB

[LAV DEBUG] === LAV_loss complete ===
[LAV DEBUG] Total pairs processed: 2
[LAV DEBUG] Final loss: 756.7700
[LAV DEBUG] Total time: 0.25s
[2026-02-01 14:19:20,058 - INFO - alignment_training_loop.py:376] - [BATCH 63] Loss value: 756.7700
[2026-02-01 14:19:23,603 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 16.00GB at batch start, forcing cleanup
[2026-02-01 14:19:23,940 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 16.00GB
[2026-02-01 14:19:23,940 - INFO - alignment_training_loop.py:302] - [BATCH 64] Task: pc_assembly
[2026-02-01 14:19:24,221 - INFO - alignment_training_loop.py:319] - [BATCH 64] After preprocessing - Num sequences: 2, Lengths: [555, 656]
[2026-02-01 14:19:37,432 - INFO - alignment_training_loop.py:376] - [BATCH 64] Loss value: 4711.2075
[2026-02-01 14:19:37,494 - ERROR - alignment_training_loop.py:387] - [OOM in BACKWARD] Task: pc_assembly, Loss value: 4711.2075
[2026-02-01 14:19:37,834 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:37,834 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:38,159 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:38,160 - INFO - alignment_training_loop.py:302] - [BATCH 65] Task: pc_assembly
[2026-02-01 14:19:38,409 - INFO - alignment_training_loop.py:319] - [BATCH 65] After preprocessing - Num sequences: 2, Lengths: [536, 555]
[2026-02-01 14:19:38,513 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: pc_assembly, Lengths: [536, 555]
[2026-02-01 14:19:38,849 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.49GB
[2026-02-01 14:19:38,911 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:39,250 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:39,250 - INFO - alignment_training_loop.py:302] - [BATCH 66] Task: Salad.cmu
[2026-02-01 14:19:39,389 - INFO - alignment_training_loop.py:319] - [BATCH 66] After preprocessing - Num sequences: 2, Lengths: [279, 253]
[2026-02-01 14:19:40,461 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [279, 253]
[2026-02-01 14:19:41,332 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.67GB
[2026-02-01 14:19:41,372 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:41,728 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:41,728 - INFO - alignment_training_loop.py:302] - [BATCH 67] Task: Pizza.egtea
[2026-02-01 14:19:42,190 - INFO - alignment_training_loop.py:319] - [BATCH 67] After preprocessing - Num sequences: 2, Lengths: [1236, 747]
[2026-02-01 14:19:42,206 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Pizza.egtea, Lengths: [1236, 747]
[2026-02-01 14:19:42,546 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:42,648 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:42,986 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:42,986 - INFO - alignment_training_loop.py:302] - [BATCH 68] Task: ContinentalBreakfast.egtea
[2026-02-01 14:19:43,216 - INFO - alignment_training_loop.py:319] - [BATCH 68] After preprocessing - Num sequences: 2, Lengths: [469, 491]
[2026-02-01 14:19:43,309 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: ContinentalBreakfast.egtea, Lengths: [469, 491]
[2026-02-01 14:19:43,642 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.44GB
[2026-02-01 14:19:43,697 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:44,034 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:44,034 - INFO - alignment_training_loop.py:302] - [BATCH 69] Task: Eggs.cmu
[2026-02-01 14:19:44,171 - INFO - alignment_training_loop.py:319] - [BATCH 69] After preprocessing - Num sequences: 2, Lengths: [355, 181]
[2026-02-01 14:19:44,548 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [355, 181]
[2026-02-01 14:19:45,408 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.55GB
[2026-02-01 14:19:45,445 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:45,801 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:45,801 - INFO - alignment_training_loop.py:302] - [BATCH 70] Task: meccano
[2026-02-01 14:19:46,432 - INFO - alignment_training_loop.py:319] - [BATCH 70] After preprocessing - Num sequences: 2, Lengths: [1341, 1438]
[2026-02-01 14:19:46,452 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: meccano, Lengths: [1341, 1438]
[2026-02-01 14:19:46,792 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:46,931 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:47,265 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:47,265 - INFO - alignment_training_loop.py:302] - [BATCH 71] Task: TurkeySandwich.egtea
[2026-02-01 14:19:47,444 - INFO - alignment_training_loop.py:319] - [BATCH 71] After preprocessing - Num sequences: 2, Lengths: [383, 327]
[2026-02-01 14:19:47,556 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: TurkeySandwich.egtea, Lengths: [383, 327]
[2026-02-01 14:19:48,257 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.47GB
[2026-02-01 14:19:48,302 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:48,649 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:48,649 - INFO - alignment_training_loop.py:302] - [BATCH 72] Task: Brownie.cmu
[2026-02-01 14:19:48,871 - INFO - alignment_training_loop.py:319] - [BATCH 72] After preprocessing - Num sequences: 2, Lengths: [491, 418]
[2026-02-01 14:19:48,968 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [491, 418]
[2026-02-01 14:19:49,304 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.46GB
[2026-02-01 14:19:49,357 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:49,690 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:49,690 - INFO - alignment_training_loop.py:302] - [BATCH 73] Task: Eggs.cmu
[2026-02-01 14:19:49,838 - INFO - alignment_training_loop.py:319] - [BATCH 73] After preprocessing - Num sequences: 2, Lengths: [368, 229]
[2026-02-01 14:19:50,013 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [368, 229]
[2026-02-01 14:19:50,878 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.52GB
[2026-02-01 14:19:50,918 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:51,269 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:51,269 - INFO - alignment_training_loop.py:302] - [BATCH 74] Task: pc_disassembly
[2026-02-01 14:19:51,435 - INFO - alignment_training_loop.py:319] - [BATCH 74] After preprocessing - Num sequences: 2, Lengths: [317, 340]
[2026-02-01 14:19:52,293 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: pc_disassembly, Lengths: [317, 340]
[2026-02-01 14:19:53,157 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.65GB
[2026-02-01 14:19:53,204 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:53,562 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:53,562 - INFO - alignment_training_loop.py:302] - [BATCH 75] Task: GreekSalad.egtea
[2026-02-01 14:19:53,784 - INFO - alignment_training_loop.py:319] - [BATCH 75] After preprocessing - Num sequences: 2, Lengths: [467, 484]
[2026-02-01 14:19:53,877 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: GreekSalad.egtea, Lengths: [467, 484]
[2026-02-01 14:19:54,218 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.44GB
[2026-02-01 14:19:54,272 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:54,608 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:54,609 - INFO - alignment_training_loop.py:302] - [BATCH 76] Task: BaconAndEggs.egtea
[2026-02-01 14:19:55,160 - INFO - alignment_training_loop.py:319] - [BATCH 76] After preprocessing - Num sequences: 2, Lengths: [718, 1727]
[2026-02-01 14:19:55,298 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [718, 1727]
[2026-02-01 14:19:55,641 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.63GB
[2026-02-01 14:19:55,765 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:56,114 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:56,114 - INFO - alignment_training_loop.py:302] - [BATCH 77] Task: pc_assembly
[2026-02-01 14:19:56,417 - INFO - alignment_training_loop.py:319] - [BATCH 77] After preprocessing - Num sequences: 2, Lengths: [513, 757]
[2026-02-01 14:19:56,518 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: pc_assembly, Lengths: [513, 757]
[2026-02-01 14:19:56,857 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.48GB
[2026-02-01 14:19:56,927 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:57,271 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:57,271 - INFO - alignment_training_loop.py:302] - [BATCH 78] Task: Brownie.cmu
[2026-02-01 14:19:57,441 - INFO - alignment_training_loop.py:319] - [BATCH 78] After preprocessing - Num sequences: 2, Lengths: [373, 330]
[2026-02-01 14:19:57,561 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [373, 330]
[2026-02-01 14:19:58,420 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.50GB
[2026-02-01 14:19:58,466 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:19:58,828 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:19:58,828 - INFO - alignment_training_loop.py:302] - [BATCH 79] Task: BaconAndEggs.egtea
[2026-02-01 14:19:59,533 - INFO - alignment_training_loop.py:319] - [BATCH 79] After preprocessing - Num sequences: 2, Lengths: [776, 2332]
[2026-02-01 14:19:59,678 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [776, 2332]
[2026-02-01 14:20:00,021 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.67GB
[2026-02-01 14:20:00,172 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:00,507 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:00,507 - INFO - alignment_training_loop.py:302] - [BATCH 80] Task: Pizza.cmu
[2026-02-01 14:20:00,714 - INFO - alignment_training_loop.py:319] - [BATCH 80] After preprocessing - Num sequences: 2, Lengths: [471, 381]
[2026-02-01 14:20:00,806 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Pizza.cmu, Lengths: [471, 381]
[2026-02-01 14:20:01,140 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.44GB
[2026-02-01 14:20:01,189 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:01,540 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:01,541 - INFO - alignment_training_loop.py:302] - [BATCH 81] Task: Salad.cmu
[2026-02-01 14:20:01,676 - INFO - alignment_training_loop.py:319] - [BATCH 81] After preprocessing - Num sequences: 2, Lengths: [223, 306]
[2026-02-01 14:20:02,904 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Salad.cmu, Lengths: [223, 306]
[2026-02-01 14:20:03,747 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.66GB
[2026-02-01 14:20:03,788 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:04,142 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:04,142 - INFO - alignment_training_loop.py:302] - [BATCH 82] Task: Sandwich.cmu
[2026-02-01 14:20:04,241 - INFO - alignment_training_loop.py:319] - [BATCH 82] After preprocessing - Num sequences: 2, Lengths: [127, 224]
[2026-02-01 14:20:05,500 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Sandwich.cmu, Lengths: [127, 224]
[2026-02-01 14:20:05,836 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.64GB
[2026-02-01 14:20:05,865 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:06,218 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:06,218 - INFO - alignment_training_loop.py:302] - [BATCH 83] Task: Brownie.cmu
[2026-02-01 14:20:06,417 - INFO - alignment_training_loop.py:319] - [BATCH 83] After preprocessing - Num sequences: 2, Lengths: [294, 528]
[2026-02-01 14:20:07,493 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [294, 528]
[2026-02-01 14:20:08,355 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.67GB
[2026-02-01 14:20:08,408 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:08,773 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:08,774 - INFO - alignment_training_loop.py:302] - [BATCH 84] Task: meccano
[2026-02-01 14:20:09,517 - INFO - alignment_training_loop.py:319] - [BATCH 84] After preprocessing - Num sequences: 2, Lengths: [1833, 1410]
[2026-02-01 14:20:09,533 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: meccano, Lengths: [1833, 1410]
[2026-02-01 14:20:09,878 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:10,035 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:10,375 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:10,376 - INFO - alignment_training_loop.py:302] - [BATCH 85] Task: Cheeseburger.egtea
[2026-02-01 14:20:10,842 - INFO - alignment_training_loop.py:319] - [BATCH 85] After preprocessing - Num sequences: 2, Lengths: [1138, 844]
[2026-02-01 14:20:10,857 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Cheeseburger.egtea, Lengths: [1138, 844]
[2026-02-01 14:20:11,207 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:11,309 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:11,648 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:11,648 - INFO - alignment_training_loop.py:302] - [BATCH 86] Task: Eggs.cmu
[2026-02-01 14:20:11,842 - INFO - alignment_training_loop.py:319] - [BATCH 86] After preprocessing - Num sequences: 2, Lengths: [466, 347]
[2026-02-01 14:20:11,934 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Eggs.cmu, Lengths: [466, 347]
[2026-02-01 14:20:12,278 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.44GB
[2026-02-01 14:20:12,325 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:12,663 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:12,663 - INFO - alignment_training_loop.py:302] - [BATCH 87] Task: BaconAndEggs.egtea
[2026-02-01 14:20:13,058 - INFO - alignment_training_loop.py:319] - [BATCH 87] After preprocessing - Num sequences: 2, Lengths: [826, 856]
[2026-02-01 14:20:13,074 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: BaconAndEggs.egtea, Lengths: [826, 856]
[2026-02-01 14:20:13,418 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:13,506 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
[2026-02-01 14:20:13,844 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.09GB
[2026-02-01 14:20:13,844 - INFO - alignment_training_loop.py:302] - [BATCH 88] Task: Brownie.cmu
[2026-02-01 14:20:14,029 - INFO - alignment_training_loop.py:319] - [BATCH 88] After preprocessing - Num sequences: 2, Lengths: [431, 329]
[2026-02-01 14:20:14,116 - ERROR - alignment_training_loop.py:328] - [OOM in FORWARD] Task: Brownie.cmu, Lengths: [431, 329]
[2026-02-01 14:20:14,471 - INFO - alignment_training_loop.py:210] - [AGGRESSIVE CLEANUP] Memory after: 20.41GB
[2026-02-01 14:20:14,516 - WARNING - alignment_training_loop.py:297] - [HIGH MEMORY] 20.09GB at batch start, forcing cleanup
