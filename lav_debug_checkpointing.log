[2026-01-28 15:14:40,380 - DEBUG - multitask_train.py:123] - 10 in train set for BaconAndEggs.egtea
[2026-01-28 15:14:40,381 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,413 - DEBUG - multitask_train.py:123] - 20 in train set for Sandwich.cmu
[2026-01-28 15:14:40,413 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,443 - DEBUG - multitask_train.py:123] - 8 in train set for tent
[2026-01-28 15:14:40,443 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,464 - DEBUG - multitask_train.py:123] - 12 in train set for PastaSalad.egtea
[2026-01-28 15:14:40,464 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,485 - DEBUG - multitask_train.py:123] - 6 in train set for pc_disassembly
[2026-01-28 15:14:40,485 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,503 - DEBUG - multitask_train.py:123] - 11 in train set for meccano
[2026-01-28 15:14:40,503 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,514 - DEBUG - multitask_train.py:123] - 6 in train set for Cheeseburger.egtea
[2026-01-28 15:14:40,514 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,547 - DEBUG - multitask_train.py:123] - 22 in train set for Salad.cmu
[2026-01-28 15:14:40,547 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,557 - DEBUG - multitask_train.py:123] - 6 in train set for GreekSalad.egtea
[2026-01-28 15:14:40,557 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,590 - DEBUG - multitask_train.py:123] - 21 in train set for Eggs.cmu
[2026-01-28 15:14:40,590 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,603 - DEBUG - multitask_train.py:123] - 8 in train set for ContinentalBreakfast.egtea
[2026-01-28 15:14:40,603 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,616 - DEBUG - multitask_train.py:123] - 8 in train set for TurkeySandwich.egtea
[2026-01-28 15:14:40,616 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,632 - DEBUG - multitask_train.py:123] - 9 in train set for pc_assembly
[2026-01-28 15:14:40,632 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,665 - DEBUG - multitask_train.py:123] - 22 in train set for Brownie.cmu
[2026-01-28 15:14:40,665 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,673 - DEBUG - multitask_train.py:123] - 4 in train set for Pizza.egtea
[2026-01-28 15:14:40,673 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:40,705 - DEBUG - multitask_train.py:123] - 21 in train set for Pizza.cmu
[2026-01-28 15:14:40,705 - DEBUG - multitask_train.py:124] - Dataloaders successfully obtained.
[2026-01-28 15:14:41,980 - INFO - alignment_training_loop.py:210] - MultiProngAttDropoutModel(
  (base_model): Resnet50Encoder(
    (conv_embedding): Sequential(
      (0): Conv3d(1024, 1024, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (1): ReLU()
      (2): Conv3d(1024, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=same)
      (3): ReLU()
    )
    (linear_embedding): Sequential(
      (0): Linear(in_features=512, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=512, bias=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=128, bias=True)
      (5): ReLU()
    )
  )
  (head_models): ModuleList(
    (0-15): 16 x HeadModel(
      (fc_layers): Sequential(
        (0): Linear(in_features=128, out_features=512, bias=True)
        (1): ReLU()
        (2): Linear(in_features=512, out_features=128, bias=True)
        (3): ReLU()
        (4): Linear(in_features=128, out_features=256, bias=True)
        (5): ReLU()
        (6): Linear(in_features=256, out_features=128, bias=True)
      )
    )
  )
  (attention_layer): Sequential(
    (0): Linear(in_features=2048, out_features=512, bias=True)
    (1): Tanh()
    (2): Linear(in_features=512, out_features=1024, bias=True)
    (3): Tanh()
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): Tanh()
    (6): Linear(in_features=512, out_features=512, bias=True)
    (7): Tanh()
    (8): Linear(in_features=512, out_features=16, bias=True)
    (9): Softmax(dim=1)
  )
)
[2026-01-28 15:14:43,866 - INFO - alignment_training_loop.py:268] - [BATCH 0] Task: Salad.cmu
[2026-01-28 15:14:44,028 - INFO - alignment_training_loop.py:285] - [BATCH 0] After preprocessing - Num sequences: 2, Lengths: [396, 279]
[2026-01-28 15:14:49,041 - INFO - alignment_training_loop.py:322] - [BATCH 0] Loss value: 204301440.0000
[2026-01-28 15:14:54,701 - INFO - alignment_training_loop.py:268] - [BATCH 1] Task: PastaSalad.egtea
[2026-01-28 15:14:55,109 - INFO - alignment_training_loop.py:285] - [BATCH 1] After preprocessing - Num sequences: 2, Lengths: [1401, 543]
[2026-01-28 15:15:03,980 - INFO - alignment_training_loop.py:322] - [BATCH 1] Loss value: 26255267840.0000
[2026-01-28 15:15:17,133 - INFO - alignment_training_loop.py:268] - [BATCH 2] Task: Sandwich.cmu
[2026-01-28 15:15:17,232 - INFO - alignment_training_loop.py:285] - [BATCH 2] After preprocessing - Num sequences: 2, Lengths: [214, 175]
[2026-01-28 15:15:19,042 - INFO - alignment_training_loop.py:322] - [BATCH 2] Loss value: 20228232.0000
[2026-01-28 15:15:21,677 - INFO - alignment_training_loop.py:268] - [BATCH 3] Task: Sandwich.cmu
[2026-01-28 15:15:21,753 - INFO - alignment_training_loop.py:285] - [BATCH 3] After preprocessing - Num sequences: 2, Lengths: [133, 156]
[2026-01-28 15:15:23,089 - INFO - alignment_training_loop.py:322] - [BATCH 3] Loss value: 6032310.0000
[2026-01-28 15:15:25,056 - INFO - alignment_training_loop.py:268] - [BATCH 4] Task: Sandwich.cmu
[2026-01-28 15:15:25,148 - INFO - alignment_training_loop.py:285] - [BATCH 4] After preprocessing - Num sequences: 2, Lengths: [199, 160]
[2026-01-28 15:15:26,792 - INFO - alignment_training_loop.py:322] - [BATCH 4] Loss value: 14815874.0000
[2026-01-28 15:15:29,222 - INFO - alignment_training_loop.py:268] - [BATCH 5] Task: Pizza.cmu
[2026-01-28 15:15:29,424 - INFO - alignment_training_loop.py:285] - [BATCH 5] After preprocessing - Num sequences: 2, Lengths: [507, 346]
[2026-01-28 15:15:33,375 - INFO - alignment_training_loop.py:322] - [BATCH 5] Loss value: 535602464.0000
[2026-01-28 15:15:39,123 - INFO - alignment_training_loop.py:268] - [BATCH 6] Task: PastaSalad.egtea
[2026-01-28 15:15:39,921 - INFO - alignment_training_loop.py:285] - [BATCH 6] After preprocessing - Num sequences: 2, Lengths: [1438, 2196]
[2026-01-28 15:15:57,101 - INFO - alignment_training_loop.py:322] - [BATCH 6] Loss value: 183359782912.0000
[2026-01-28 15:16:22,552 - INFO - alignment_training_loop.py:268] - [BATCH 7] Task: Brownie.cmu
[2026-01-28 15:16:22,748 - INFO - alignment_training_loop.py:285] - [BATCH 7] After preprocessing - Num sequences: 2, Lengths: [297, 523]
[2026-01-28 15:16:26,691 - INFO - alignment_training_loop.py:322] - [BATCH 7] Loss value: 550024128.0000
[2026-01-28 15:16:32,236 - INFO - alignment_training_loop.py:268] - [BATCH 8] Task: BaconAndEggs.egtea
[2026-01-28 15:16:32,574 - INFO - alignment_training_loop.py:285] - [BATCH 8] After preprocessing - Num sequences: 2, Lengths: [776, 718]
[2026-01-28 15:16:39,739 - INFO - alignment_training_loop.py:322] - [BATCH 8] Loss value: 4183506176.0000
[2026-01-28 15:16:49,968 - INFO - alignment_training_loop.py:268] - [BATCH 9] Task: Salad.cmu
[2026-01-28 15:16:50,155 - INFO - alignment_training_loop.py:285] - [BATCH 9] After preprocessing - Num sequences: 2, Lengths: [423, 379]
[2026-01-28 15:16:53,998 - INFO - alignment_training_loop.py:322] - [BATCH 9] Loss value: 350446016.0000
[2026-01-28 15:16:59,490 - INFO - alignment_training_loop.py:268] - [BATCH 10] Task: Cheeseburger.egtea
[2026-01-28 15:16:59,860 - INFO - alignment_training_loop.py:285] - [BATCH 10] After preprocessing - Num sequences: 2, Lengths: [470, 1138]
[2026-01-28 15:17:07,557 - INFO - alignment_training_loop.py:322] - [BATCH 10] Loss value: 11485287424.0000
[2026-01-28 15:17:18,628 - INFO - alignment_training_loop.py:268] - [BATCH 11] Task: Pizza.cmu
[2026-01-28 15:17:18,855 - INFO - alignment_training_loop.py:285] - [BATCH 11] After preprocessing - Num sequences: 2, Lengths: [596, 439]
[2026-01-28 15:17:23,861 - INFO - alignment_training_loop.py:322] - [BATCH 11] Loss value: 1086563584.0000
CUDA_VISIBLE_DEVICES: 1
Available GPUs: 1
Current device: 0
Single GPU mode - using device: cuda:0
WARNING: Skipping 02.tent.120617.gopro - all actions removed (video too short)
WARNING: Skipping 05.tent.061417.gopro - all actions removed (video too short)
WARNING: Skipping 07.tent.160617.gopro - all actions removed (video too short)
WARNING: Skipping 09.tent.170717.gopro - all actions removed (video too short)
WARNING: Skipping 11.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 12.tent.190717.gopro - all actions removed (video too short)
WARNING: Skipping 13.tent.200717.gopro - all actions removed (video too short)
WARNING: Skipping 14.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping 16.tent.160817.gopro - all actions removed (video too short)
WARNING: Skipping 17.tent.140917.gopro - all actions removed (video too short)
WARNING: Skipping 19.tent.150917.gopro - all actions removed (video too short)
WARNING: Skipping 20.tent.190917.gopro - all actions removed (video too short)
WARNING: Skipping 22.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 23.tent.200917.gopro - all actions removed (video too short)
WARNING: Skipping 29.tent.081119.gopro - all actions removed (video too short)
WARNING: Skipping Head_10 - all actions removed (video too short)
WARNING: Skipping Head_12 - all actions removed (video too short)
WARNING: Skipping Head_15 - all actions removed (video too short)
WARNING: Skipping Head_17 - all actions removed (video too short)
WARNING: Skipping Head_6 - all actions removed (video too short)
WARNING: Skipping Head_8 - all actions removed (video too short)
[MEM Batch 0 START - Task Salad.cmu] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After preprocess] Allocated: 0.18GB | Reserved: 0.19GB | Peak: 0.18GB
[MEM After forward pass] Allocated: 2.27GB | Reserved: 2.54GB | Peak: 2.33GB
[MEM After loss computation] Allocated: 2.27GB | Reserved: 2.44GB | Peak: 2.38GB
[MEM Before backward] Allocated: 2.27GB | Reserved: 2.44GB | Peak: 2.38GB
[MEM After backward] Allocated: 0.38GB | Reserved: 2.92GB | Peak: 2.51GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 2.92GB | Peak: 2.51GB
[MEM Batch 1 START - Task PastaSalad.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 2.51GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 2.51GB
[MEM After forward pass] Allocated: 6.74GB | Reserved: 7.22GB | Peak: 6.77GB
[MEM After loss computation] Allocated: 6.74GB | Reserved: 7.22GB | Peak: 7.47GB
[MEM Before backward] Allocated: 6.74GB | Reserved: 7.22GB | Peak: 7.47GB
[MEM After backward] Allocated: 0.74GB | Reserved: 8.72GB | Peak: 8.20GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 8.72GB | Peak: 8.20GB
[MEM Batch 2 START - Task Sandwich.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After forward pass] Allocated: 1.94GB | Reserved: 2.16GB | Peak: 8.20GB
[MEM After loss computation] Allocated: 1.94GB | Reserved: 2.05GB | Peak: 8.20GB
[MEM Before backward] Allocated: 1.94GB | Reserved: 2.05GB | Peak: 8.20GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.41GB | Peak: 8.20GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 2.41GB | Peak: 8.20GB
[MEM Batch 3 START - Task Sandwich.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After forward pass] Allocated: 1.64GB | Reserved: 1.81GB | Peak: 8.20GB
[MEM After loss computation] Allocated: 1.64GB | Reserved: 1.70GB | Peak: 8.20GB
[MEM Before backward] Allocated: 1.64GB | Reserved: 1.70GB | Peak: 8.20GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.06GB | Peak: 8.20GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 2.06GB | Peak: 8.20GB
[MEM Batch 4 START - Task Sandwich.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After forward pass] Allocated: 1.85GB | Reserved: 2.09GB | Peak: 8.20GB
[MEM After loss computation] Allocated: 1.85GB | Reserved: 1.98GB | Peak: 8.20GB
[MEM Before backward] Allocated: 1.85GB | Reserved: 1.98GB | Peak: 8.20GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.25GB | Peak: 8.20GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 2.25GB | Peak: 8.20GB
[MEM Batch 5 START - Task Pizza.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After forward pass] Allocated: 3.37GB | Reserved: 3.68GB | Peak: 8.20GB
[MEM After loss computation] Allocated: 3.37GB | Reserved: 3.57GB | Peak: 8.20GB
[MEM Before backward] Allocated: 3.37GB | Reserved: 3.57GB | Peak: 8.20GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.12GB | Peak: 8.20GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.12GB | Peak: 8.20GB
[MEM Batch 6 START - Task PastaSalad.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 8.20GB
[MEM After forward pass] Allocated: 11.96GB | Reserved: 12.84GB | Peak: 12.01GB
[MEM After loss computation] Allocated: 11.96GB | Reserved: 12.81GB | Peak: 14.97GB
[MEM Before backward] Allocated: 11.96GB | Reserved: 12.81GB | Peak: 14.97GB
[MEM After backward] Allocated: 0.74GB | Reserved: 19.04GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 19.04GB | Peak: 17.99GB
[MEM Batch 7 START - Task Brownie.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.27GB | Reserved: 3.57GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.27GB | Reserved: 3.46GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.27GB | Reserved: 3.46GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.97GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 3.97GB | Peak: 17.99GB
[MEM Batch 8 START - Task BaconAndEggs.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 5.35GB | Reserved: 5.78GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 5.35GB | Reserved: 5.78GB | Peak: 17.99GB
[MEM Before backward] Allocated: 5.35GB | Reserved: 5.78GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.86GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 6.86GB | Peak: 17.99GB
[MEM Batch 9 START - Task Salad.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.22GB | Reserved: 3.54GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.22GB | Reserved: 3.43GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.22GB | Reserved: 3.43GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.96GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 3.96GB | Peak: 17.99GB
[MEM Batch 10 START - Task Cheeseburger.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 5.70GB | Reserved: 6.19GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 5.70GB | Reserved: 6.08GB | Peak: 17.99GB
[MEM Before backward] Allocated: 5.70GB | Reserved: 6.08GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.14GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 7.14GB | Peak: 17.99GB
[MEM Batch 11 START - Task Pizza.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.94GB | Reserved: 4.33GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.94GB | Reserved: 4.22GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.94GB | Reserved: 4.22GB | Peak: 17.99GB[2026-01-28 15:17:30,976 - INFO - alignment_training_loop.py:268] - [BATCH 12] Task: Salad.cmu
[2026-01-28 15:17:31,096 - INFO - alignment_training_loop.py:285] - [BATCH 12] After preprocessing - Num sequences: 2, Lengths: [173, 329]
[2026-01-28 15:17:33,525 - INFO - alignment_training_loop.py:322] - [BATCH 12] Loss value: 83886440.0000
[2026-01-28 15:17:36,993 - INFO - alignment_training_loop.py:268] - [BATCH 13] Task: Pizza.cmu
[2026-01-28 15:17:37,186 - INFO - alignment_training_loop.py:285] - [BATCH 13] After preprocessing - Num sequences: 2, Lengths: [351, 471]
[2026-01-28 15:17:41,167 - INFO - alignment_training_loop.py:322] - [BATCH 13] Loss value: 428146912.0000
[2026-01-28 15:17:46,850 - INFO - alignment_training_loop.py:268] - [BATCH 14] Task: pc_assembly
[2026-01-28 15:17:47,090 - INFO - alignment_training_loop.py:285] - [BATCH 14] After preprocessing - Num sequences: 2, Lengths: [536, 555]
[2026-01-28 15:17:52,389 - INFO - alignment_training_loop.py:322] - [BATCH 14] Loss value: 1179250432.0000
[2026-01-28 15:17:59,939 - INFO - alignment_training_loop.py:268] - [BATCH 15] Task: Pizza.cmu
[2026-01-28 15:18:00,305 - INFO - alignment_training_loop.py:285] - [BATCH 15] After preprocessing - Num sequences: 2, Lengths: [756, 839]
[2026-01-28 15:18:08,133 - INFO - alignment_training_loop.py:322] - [BATCH 15] Loss value: 5462484480.0000
[2026-01-28 15:18:19,524 - INFO - alignment_training_loop.py:268] - [BATCH 16] Task: Eggs.cmu
[2026-01-28 15:18:19,678 - INFO - alignment_training_loop.py:285] - [BATCH 16] After preprocessing - Num sequences: 2, Lengths: [202, 428]
[2026-01-28 15:18:22,825 - INFO - alignment_training_loop.py:322] - [BATCH 16] Loss value: 233921584.0000
[2026-01-28 15:18:27,306 - INFO - alignment_training_loop.py:268] - [BATCH 17] Task: TurkeySandwich.egtea
[2026-01-28 15:18:27,531 - INFO - alignment_training_loop.py:285] - [BATCH 17] After preprocessing - Num sequences: 2, Lengths: [502, 506]
[2026-01-28 15:18:32,612 - INFO - alignment_training_loop.py:322] - [BATCH 17] Loss value: 856741760.0000
[2026-01-28 15:18:39,858 - INFO - alignment_training_loop.py:268] - [BATCH 18] Task: Brownie.cmu
[2026-01-28 15:18:39,997 - INFO - alignment_training_loop.py:285] - [BATCH 18] After preprocessing - Num sequences: 2, Lengths: [224, 369]
[2026-01-28 15:18:43,017 - INFO - alignment_training_loop.py:322] - [BATCH 18] Loss value: 139716144.0000
[2026-01-28 15:18:47,312 - INFO - alignment_training_loop.py:268] - [BATCH 19] Task: tent
[2026-01-28 15:18:47,321 - INFO - alignment_training_loop.py:268] - [BATCH 20] Task: Sandwich.cmu
[2026-01-28 15:18:47,391 - INFO - alignment_training_loop.py:285] - [BATCH 20] After preprocessing - Num sequences: 2, Lengths: [127, 141]
[2026-01-28 15:18:48,775 - INFO - alignment_training_loop.py:322] - [BATCH 20] Loss value: 4347311.5000
[2026-01-28 15:18:50,698 - INFO - alignment_training_loop.py:268] - [BATCH 21] Task: Pizza.cmu
[2026-01-28 15:18:50,911 - INFO - alignment_training_loop.py:285] - [BATCH 21] After preprocessing - Num sequences: 2, Lengths: [381, 529]
[2026-01-28 15:18:55,519 - INFO - alignment_training_loop.py:322] - [BATCH 21] Loss value: 658599808.0000
[2026-01-28 15:19:02,071 - INFO - alignment_training_loop.py:268] - [BATCH 22] Task: Salad.cmu
[2026-01-28 15:19:02,233 - INFO - alignment_training_loop.py:285] - [BATCH 22] After preprocessing - Num sequences: 2, Lengths: [430, 273]
[2026-01-28 15:19:05,816 - INFO - alignment_training_loop.py:322] - [BATCH 22] Loss value: 263192416.0000
[2026-01-28 15:19:10,888 - INFO - alignment_training_loop.py:268] - [BATCH 23] Task: TurkeySandwich.egtea
[2026-01-28 15:19:11,211 - INFO - alignment_training_loop.py:285] - [BATCH 23] After preprocessing - Num sequences: 2, Lengths: [327, 1109]
[2026-01-28 15:19:18,541 - INFO - alignment_training_loop.py:322] - [BATCH 23] Loss value: 10084639744.0000
[2026-01-28 15:19:29,005 - INFO - alignment_training_loop.py:268] - [BATCH 24] Task: PastaSalad.egtea
[2026-01-28 15:19:29,952 - INFO - alignment_training_loop.py:285] - [BATCH 24] After preprocessing - Num sequences: 2, Lengths: [2492, 1728]
[2026-01-28 15:19:52,105 - INFO - alignment_training_loop.py:322] - [BATCH 24] Loss value: 313916981248.0000
[2026-01-28 15:19:52,976 - ERROR - alignment_training_loop.py:333] - [OOM in BACKWARD] Task: PastaSalad.egtea, Loss value: 313916981248.0000
[2026-01-28 15:19:53,097 - INFO - alignment_training_loop.py:268] - [BATCH 25] Task: PastaSalad.egtea
[2026-01-28 15:19:53,667 - INFO - alignment_training_loop.py:285] - [BATCH 25] After preprocessing - Num sequences: 2, Lengths: [989, 1497]

[MEM After backward] Allocated: 0.74GB | Reserved: 4.73GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.73GB | Peak: 17.99GB
[MEM Batch 12 START - Task Salad.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 2.29GB | Reserved: 2.56GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 2.29GB | Reserved: 2.45GB | Peak: 17.99GB
[MEM Before backward] Allocated: 2.29GB | Reserved: 2.45GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 2.78GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 2.78GB | Peak: 17.99GB
[MEM Batch 13 START - Task Pizza.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.28GB | Reserved: 3.60GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.28GB | Reserved: 3.49GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.28GB | Reserved: 3.49GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.03GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.03GB | Peak: 17.99GB
[MEM Batch 14 START - Task pc_assembly] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 4.11GB | Reserved: 4.46GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 4.11GB | Reserved: 4.35GB | Peak: 17.99GB
[MEM Before backward] Allocated: 4.11GB | Reserved: 4.35GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.94GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.94GB | Peak: 17.99GB
[MEM Batch 15 START - Task Pizza.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 5.66GB | Reserved: 6.14GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 5.66GB | Reserved: 6.04GB | Peak: 17.99GB
[MEM Before backward] Allocated: 5.66GB | Reserved: 6.04GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 7.27GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 7.27GB | Peak: 17.99GB
[MEM Batch 16 START - Task Eggs.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 2.69GB | Reserved: 2.99GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 2.69GB | Reserved: 2.88GB | Peak: 17.99GB
[MEM Before backward] Allocated: 2.69GB | Reserved: 2.88GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.29GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 3.29GB | Peak: 17.99GB
[MEM Batch 17 START - Task TurkeySandwich.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.85GB | Reserved: 4.17GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.85GB | Reserved: 4.17GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.85GB | Reserved: 4.17GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.67GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.67GB | Peak: 17.99GB
[MEM Batch 18 START - Task Brownie.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 2.57GB | Reserved: 2.79GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 2.57GB | Reserved: 2.79GB | Peak: 17.99GB
[MEM Before backward] Allocated: 2.57GB | Reserved: 2.79GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.09GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 3.09GB | Peak: 17.99GB
[MEM Batch 19 START - Task tent] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM Batch 20 START - Task Sandwich.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 1.57GB | Reserved: 1.76GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 1.57GB | Reserved: 1.65GB | Peak: 17.99GB
[MEM Before backward] Allocated: 1.57GB | Reserved: 1.65GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 1.97GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 1.97GB | Peak: 17.99GB
[MEM Batch 21 START - Task Pizza.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 3.55GB | Reserved: 3.91GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 3.55GB | Reserved: 3.80GB | Peak: 17.99GB
[MEM Before backward] Allocated: 3.55GB | Reserved: 3.80GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 4.40GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 4.40GB | Peak: 17.99GB
[MEM Batch 22 START - Task Salad.cmu] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 2.91GB | Reserved: 3.19GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 2.91GB | Reserved: 3.08GB | Peak: 17.99GB
[MEM Before backward] Allocated: 2.91GB | Reserved: 3.08GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 3.53GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 3.53GB | Peak: 17.99GB
[MEM Batch 23 START - Task TurkeySandwich.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 5.17GB | Reserved: 5.54GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 5.17GB | Reserved: 5.54GB | Peak: 17.99GB
[MEM Before backward] Allocated: 5.17GB | Reserved: 5.54GB | Peak: 17.99GB
[MEM After backward] Allocated: 0.74GB | Reserved: 6.23GB | Peak: 17.99GB
[MEM After optimizer step] Allocated: 0.74GB | Reserved: 6.23GB | Peak: 17.99GB
[MEM Batch 24 START - Task PastaSalad.egtea] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After preprocess] Allocated: 0.74GB | Reserved: 0.93GB | Peak: 17.99GB
[MEM After forward pass] Allocated: 13.76GB | Reserved: 14.78GB | Peak: 17.99GB
[MEM After loss computation] Allocated: 13.76GB | Reserved: 14.74GB | Peak: 17.99GB
[MEM Before backward] Allocated: 13.76GB | Reserved: 14.74GB | Peak: 17.99GB
[MEM Batch 25 START - Task PastaSalad.egtea] Allocated: 15.82GB | Reserved: 16.80GB | Peak: 19.94GB
[MEM After preprocess] Allocated: 15.82GB | Reserved: 16.80GB | Peak: 19.94GB
Traceback (most recent call last):
  File "multitask_train.py", line 150, in <module>
    alignment_training_loop(
  File "/vision/anishn/GTCC_CVPR2024/models/alignment_training_loop.py", line 287, in alignment_training_loop
    output_dict = model(inputs)
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_multiprong.py", line 180, in forward
    general_features = self.base_model(videos)['outputs']
  File "/vision/anishn/envs/vidal/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vision/anishn/GTCC_CVPR2024/models/model_singleprong.py", line 65, in forward
    base_output = torch.cat((zero_arrays, base_output), dim=0)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.12 GiB (GPU 0; 22.16 GiB total capacity; 19.91 GiB already allocated; 848.12 MiB free; 21.10 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
